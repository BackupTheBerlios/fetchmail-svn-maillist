From svn at mknod.org  Tue Aug  4 11:27:11 2009
From: svn at mknod.org (svn at mknod.org)
Date: Tue,  4 Aug 2009 04:27:11 -0500
Subject: [fetchmail-svn] r5389 - in branches/BRANCH_6-3: . po
Message-ID: <20090804092711.38BE021F140@mknod.org>

Author: m-a
Date: 2009-08-04 04:27:10 -0500 (Tue, 04 Aug 2009)
New Revision: 5389

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/po/de.po
   branches/BRANCH_6-3/socket.c
Log:
Abort verification if Subject CommonName/AltName contains NUL.

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-07-16 19:50:12 UTC (rev 5388)
+++ branches/BRANCH_6-3/NEWS	2009-08-04 09:27:10 UTC (rev 5389)
@@ -51,6 +51,11 @@
 
 fetchmail 6.3.11 (released XXXX-XX-XX - i. e. not yet):
 
+# SECURITY BUGFIXES
+* Fetchmail checks the Subject CommonName and Subject AltName X.509 certificate
+  fields for embedded NUL characters and aborts certificate verification to
+  counter recent SSL certificate verification attacks. Untested.
+
 # BUGFIXES
 * Remove the spurious message "message delimiter found while scanning headers".
   RFC-5322 syntax states that the delimiter is part of the body, and the body is

Modified: branches/BRANCH_6-3/po/de.po
===================================================================
--- branches/BRANCH_6-3/po/de.po	2009-07-16 19:50:12 UTC (rev 5388)
+++ branches/BRANCH_6-3/po/de.po	2009-08-04 09:27:10 UTC (rev 5389)
@@ -8,7 +8,7 @@
 msgstr ""
 "Project-Id-Version: fetchmail 6.3.10-beta1\n"
 "Report-Msgid-Bugs-To: fetchmail-devel at lists.berlios.de\n"
-"POT-Creation-Date: 2009-07-02 21:34+0200\n"
+"POT-Creation-Date: 2009-08-04 11:24+0200\n"
 "PO-Revision-Date: 2009-05-26 00:53+0200\n"
 "Last-Translator: Matthias Andree <matthias.andree at gmx.de>\n"
 "Language-Team: Deutsch <de at li.org>\n"
@@ -2935,79 +2935,93 @@
 msgid "Bad certificate: Subject CommonName too long!\n"
 msgstr "Ung?ltiges Zertifikat: Server-CommonName zu lang!\n"
 
-#: socket.c:678
+#: socket.c:638
+msgid "Bad certificate: Subject CommonName contains NUL, aborting!\n"
+msgstr "Ung?ltiges Zertifikat: Subject-CommonName enth?lt NUL, breche ab!\n"
+
+#: socket.c:661
+msgid "Bad certificate: Subject Alternative Name contains NUL, aborting!\n"
+msgstr ""
+"Ung?ltiges Zertifikat: Subject-Alternative-Name enth?lt NUL, breche ab!\n"
+
+#: socket.c:666
 #, c-format
+msgid "Subject Alternative Name: %s\n"
+msgstr "\"Subject Alternative Name\": %s\n"
+
+#: socket.c:691
+#, c-format
 msgid "Server CommonName mismatch: %s != %s\n"
 msgstr "Server-CommonName stimmt nicht ?berein: %s != %s\n"
 
-#: socket.c:684
+#: socket.c:697
 msgid "Server name not set, could not verify certificate!\n"
 msgstr "Server-Name nicht gesetzt, konnte Zertifikat nicht verifizieren!\n"
 
-#: socket.c:689
+#: socket.c:702
 msgid "Unknown Server CommonName\n"
 msgstr "Unbekannter Server-CommonName\n"
 
-#: socket.c:691
+#: socket.c:704
 msgid "Server name not specified in certificate!\n"
 msgstr "Server-Name nicht in Zertifikat spezifiziert!\n"
 
-#: socket.c:703
+#: socket.c:716
 msgid "EVP_md5() failed!\n"
 msgstr "EVP_md5() fehlgeschlagen!\n"
 
-#: socket.c:707
+#: socket.c:720
 msgid "Out of memory!\n"
 msgstr "Kein Speicher mehr frei!\n"
 
-#: socket.c:715
+#: socket.c:728
 msgid "Digest text buffer too small!\n"
 msgstr "Textpuffer f?r Digest zu klein!\n"
 
-#: socket.c:721
+#: socket.c:734
 #, c-format
 msgid "%s key fingerprint: %s\n"
 msgstr "%s-Schl?ssel-Fingerabdruck: %s\n"
 
-#: socket.c:725
+#: socket.c:738
 #, c-format
 msgid "%s fingerprints match.\n"
 msgstr "%s-Fingerabdr?cke stimmen ?berein.\n"
 
-#: socket.c:727
+#: socket.c:740
 #, c-format
 msgid "%s fingerprints do not match!\n"
 msgstr "%s-Fingerabdr?cke stimmen nicht ?berein!\n"
 
-#: socket.c:736
+#: socket.c:749
 #, c-format
 msgid "Server certificate verification error: %s\n"
 msgstr "Fehler bei Server-Zertifikat-?berpr?fung: %s\n"
 
-#: socket.c:742
+#: socket.c:755
 #, c-format
 msgid "unknown issuer (first %d characters): %s\n"
 msgstr "unbekannter Herausgeber (erste %d Zeichen): %s\n"
 
-#: socket.c:829
+#: socket.c:842
 msgid "File descriptor out of range for SSL"
 msgstr "Datei-Deskriptor au?erhalb des Bereichs f?r SSL"
 
-#: socket.c:845
+#: socket.c:858
 #, c-format
 msgid "Invalid SSL protocol '%s' specified, using default (SSLv23).\n"
 msgstr ""
 "Ung?ltiges SSL-Protokoll ?%s? angegeben, benutze Voreinstellung (SSLv23).\n"
 
-#: socket.c:921
+#: socket.c:934
 msgid "Certificate/fingerprint verification was somehow skipped!\n"
 msgstr "Zertifikat-/Fingerabdruck-?berpr?fung wurde irgendwie ?bersprungen!\n"
 
-#: socket.c:999
+#: socket.c:1012
 msgid "Cygwin socket read retry\n"
 msgstr "Cygwin-Socket-Lese-Wiederholung\n"
 
-#: socket.c:1002
+#: socket.c:1015
 msgid "Cygwin socket read retry failed!\n"
 msgstr "Cygwin-Socket-Lese-Wiederholung fehlgeschlagen!\n"
 
@@ -3054,50 +3068,46 @@
 msgid "found Received address `%s'\n"
 msgstr "?Received?-Adresse ?%s? gefunden\n"
 
-#: transact.c:566
-msgid "message delimiter found while scanning headers\n"
-msgstr "Nachrichtentrenner gefunden beim Scannen der Kopfzeilen\n"
-
-#: transact.c:597
+#: transact.c:592
 msgid "incorrect header line found while scanning headers\n"
 msgstr "inkorrekte Kopfzeile gefunden beim Scannen der Kopfzeilen\n"
 
-#: transact.c:599
+#: transact.c:594
 #, c-format
 msgid "line: %s"
 msgstr "Zeile: %s"
 
-#: transact.c:1138
+#: transact.c:1133
 #, c-format
 msgid "no local matches, forwarding to %s\n"
 msgstr "keine lokalen ?bereinstimmungen, Weiterleitung an %s\n"
 
-#: transact.c:1153
+#: transact.c:1148
 msgid "forwarding and deletion suppressed due to DNS errors\n"
 msgstr "Weiterleiten und L?schen wegen DNS-Fehlern unterdr?ckt\n"
 
-#: transact.c:1263
+#: transact.c:1258
 msgid "writing RFC822 msgblk.headers\n"
 msgstr "schreibe RFC822 msgblk.headers\n"
 
-#: transact.c:1282
+#: transact.c:1277
 msgid "no recipient addresses matched declared local names"
 msgstr "keine Empf?ngeradresse stimmt mit deklarierten lokalen Namen ?berein"
 
-#: transact.c:1289
+#: transact.c:1284
 #, c-format
 msgid "recipient address %s didn't match any local name"
 msgstr "Empf?ngeradresse %s stimmt mit keinem lokalen Namen ?berein"
 
-#: transact.c:1298
+#: transact.c:1293
 msgid "message has embedded NULs"
 msgstr "Nachricht hat eingebettete NUL-Zeichen"
 
-#: transact.c:1306
+#: transact.c:1301
 msgid "SMTP listener rejected local recipient addresses: "
 msgstr "SMTP-Server lehnte Adressen mit lokalem Empf?nger ab: "
 
-#: transact.c:1445
+#: transact.c:1440
 msgid "error writing message text\n"
 msgstr "Fehler beim Schreiben des Nachrichtentextes\n"
 
@@ -3172,3 +3182,6 @@
 #: xmalloc.c:47
 msgid "realloc failed\n"
 msgstr "realloc fehlgeschlagen\n"
+
+#~ msgid "message delimiter found while scanning headers\n"
+#~ msgstr "Nachrichtentrenner gefunden beim Scannen der Kopfzeilen\n"

Modified: branches/BRANCH_6-3/socket.c
===================================================================
--- branches/BRANCH_6-3/socket.c	2009-07-16 19:50:12 UTC (rev 5388)
+++ branches/BRANCH_6-3/socket.c	2009-08-04 09:27:10 UTC (rev 5389)
@@ -608,7 +608,7 @@
 
 	if (depth == 0 && !_depth0ck) {
 		_depth0ck = 1;
-		
+
 		if (outlevel >= O_VERBOSE) {
 			if ((i = X509_NAME_get_text_by_NID(issuer, NID_organizationName, buf, sizeof(buf))) != -1) {
 				report(stdout, GT_("Issuer Organization: %s\n"), buf);
@@ -632,6 +632,12 @@
 				report(stderr, GT_("Bad certificate: Subject CommonName too long!\n"));
 				return (0);
 			}
+			if ((size_t)i > strlen(buf)) {
+				/* Name contains embedded NUL characters, so we complain. This is likely
+				 * a certificate spoofing attack. */
+				report(stderr, GT_("Bad certificate: Subject CommonName contains NUL, aborting!\n"));
+				return 0;
+			}
 			if (_ssl_server_cname != NULL) {
 				char *p1 = buf;
 				char *p2 = _ssl_server_cname;
@@ -643,14 +649,21 @@
 				 * first find a match among alternative names */
 				gens = (STACK_OF(GENERAL_NAME) *)X509_get_ext_d2i(x509_cert, NID_subject_alt_name, NULL, NULL);
 				if (gens) {
-					int i, r;
-					for (i = 0, r = sk_GENERAL_NAME_num(gens); i < r; ++i) {
-						const GENERAL_NAME *gn = sk_GENERAL_NAME_value(gens, i);
+					int j, r;
+					for (j = 0, r = sk_GENERAL_NAME_num(gens); j < r; ++j) {
+						const GENERAL_NAME *gn = sk_GENERAL_NAME_value(gens, j);
 						if (gn->type == GEN_DNS) {
 							char *p1 = (char *)gn->d.ia5->data;
 							char *p2 = _ssl_server_cname;
+							/* Name contains embedded NUL characters, so we complain. This
+							 * is likely a certificate spoofing attack. */
+							if ((size_t)gn->d.ia5->length != strlen(p1)) {
+								report(stderr, GT_("Bad certificate: Subject Alternative Name contains NUL, aborting!\n"));
+								sk_GENERAL_NAME_free(gens);
+								return 0;
+							}
 							if (outlevel >= O_VERBOSE)
-								report(stderr, "Subject Alternative Name: %s\n", p1);
+								report(stdout, GT_("Subject Alternative Name: %s\n"), p1);
 							if (*p1 == '*') {
 								++p1;
 								n = strlen(p2) - strlen(p1);
@@ -669,9 +682,9 @@
 					n = strlen(p2) - strlen(p1);
 					if (n >= 0)
 						p2 += n;
-				}	
+				}
 				if (0 == strcasecmp(p1, p2)) {
-				  matched = 1;
+					matched = 1;
 				}
 				if (!matched) {
 					report(stderr,



From svn at mknod.org  Wed Aug  5 18:27:47 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 11:27:47 -0500
Subject: [fetchmail-svn] r5390 - branches/BRANCH_6-3
Message-ID: <20090805162747.6386721F140@mknod.org>

Author: m-a
Date: 2009-08-05 11:27:47 -0500 (Wed, 05 Aug 2009)
New Revision: 5390

Added:
   branches/BRANCH_6-3/sdump.c
   branches/BRANCH_6-3/sdump.h
   branches/BRANCH_6-3/xmalloc.h
Modified:
   branches/BRANCH_6-3/Makefile.am
   branches/BRANCH_6-3/fetchmail.h
Log:
Add sdump(), split xmalloc.h out of fetchmail.h

Modified: branches/BRANCH_6-3/Makefile.am
===================================================================
--- branches/BRANCH_6-3/Makefile.am	2009-08-04 09:27:10 UTC (rev 5389)
+++ branches/BRANCH_6-3/Makefile.am	2009-08-05 16:27:47 UTC (rev 5390)
@@ -37,7 +37,8 @@
 			servport.c ntlm.h smbbyteorder.h smbdes.h smbmd4.h \
 			smbencrypt.h smbdes.c smbencrypt.c smbmd4.c smbutil.c \
 			libesmtp/gethostbyname.h libesmtp/gethostbyname.c \
-			smbtypes.h fm_getaddrinfo.c tls.c rfc822valid.c
+			smbtypes.h fm_getaddrinfo.c tls.c rfc822valid.c \
+			xmalloc.h sdump.h sdump.c
 libfm_a_LIBADD=		$(EXTRAOBJ)
 libfm_a_DEPENDENCIES=	$(EXTRAOBJ)
 LDADD	=		libfm.a @LIBINTL@ $(LIBOBJS)

Modified: branches/BRANCH_6-3/fetchmail.h
===================================================================
--- branches/BRANCH_6-3/fetchmail.h	2009-08-04 09:27:10 UTC (rev 5389)
+++ branches/BRANCH_6-3/fetchmail.h	2009-08-05 16:27:47 UTC (rev 5390)
@@ -623,16 +623,7 @@
 void interface_note_activity(struct hostdata *);
 int interface_approve(struct hostdata *, flag domonitor);
 
-/* xmalloc.c */
-#if defined(HAVE_VOIDPOINTER)
-#define XMALLOCTYPE void
-#else
-#define XMALLOCTYPE char
-#endif
-XMALLOCTYPE *xmalloc(size_t);
-XMALLOCTYPE *xrealloc(/*@null@*/ XMALLOCTYPE *, size_t);
-#define xfree(p) { if (p) { free(p); } (p) = 0; }
-char *xstrdup(const char *);
+#include "xmalloc.h"
 
 /* protocol driver and methods */
 int doPOP2 (struct query *); 

Added: branches/BRANCH_6-3/sdump.c
===================================================================
--- branches/BRANCH_6-3/sdump.c	                        (rev 0)
+++ branches/BRANCH_6-3/sdump.c	2009-08-05 16:27:47 UTC (rev 5390)
@@ -0,0 +1,37 @@
+/* sdump.c -- library to allocate a printable version of a string */
+/** \file sdump.c
+ * \author Matthias Andree
+ * \date 2009
+ */
+
+#include <ctype.h>  /* for isprint() */
+#include <stdio.h>  /* for sprintf() */
+#include <stdlib.h> /* for size_t */
+#include "xmalloc.h" /* for xmalloc() */
+
+#include "sdump.h"   /* for prototype */
+
+/** sdump converts a byte string \a in of size \a len into a printable
+ * string and returns a pointer to the memory region.
+ * \returns a pointer to a xmalloc()ed string that the caller must
+ * free() after use. This function causes program abort on failure. */
+char *sdump(const char *in, size_t len)
+{
+    size_t outlen = 0, i;
+    char *out, *oi;
+
+    for (i = 0; i < len; i++) {
+	outlen += isprint((unsigned char)in[i]) ? 1 : 4;
+    }
+
+    oi = out = (char *)xmalloc(outlen + 1);
+    for (i = 0; i < len; i++) {
+	if (isprint((unsigned char)in[i])) {
+	    *(oi++) = in[i];
+	} else {
+	    oi += sprintf(oi, "\\x%02X", in[i]);
+	}
+    }
+    *oi = '\0';
+    return out;
+}

Added: branches/BRANCH_6-3/sdump.h
===================================================================
--- branches/BRANCH_6-3/sdump.h	                        (rev 0)
+++ branches/BRANCH_6-3/sdump.h	2009-08-05 16:27:47 UTC (rev 5390)
@@ -0,0 +1,8 @@
+#ifndef SDUMP_H
+#define SDUMP_H
+
+#include <stdlib.h>
+
+char *sdump(const char *in, size_t len);
+
+#endif

Added: branches/BRANCH_6-3/xmalloc.h
===================================================================
--- branches/BRANCH_6-3/xmalloc.h	                        (rev 0)
+++ branches/BRANCH_6-3/xmalloc.h	2009-08-05 16:27:47 UTC (rev 5390)
@@ -0,0 +1,19 @@
+/* xmalloc.h -- split out of fetchmail.h */
+
+#ifndef XMALLOC_H
+#define XMALLOC_H
+
+#include "config.h"
+
+/* xmalloc.c */
+#if defined(HAVE_VOIDPOINTER)
+#define XMALLOCTYPE void
+#else
+#define XMALLOCTYPE char
+#endif
+XMALLOCTYPE *xmalloc(size_t);
+XMALLOCTYPE *xrealloc(/*@null@*/ XMALLOCTYPE *, size_t);
+#define xfree(p) { if (p) { free(p); } (p) = 0; }
+char *xstrdup(const char *);
+
+#endif



From svn at mknod.org  Wed Aug  5 18:50:49 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 11:50:49 -0500
Subject: [fetchmail-svn] r5391 - branches/BRANCH_6-3
Message-ID: <20090805165049.E2C1D21F140@mknod.org>

Author: m-a
Date: 2009-08-05 11:50:48 -0500 (Wed, 05 Aug 2009)
New Revision: 5391

Modified:
   branches/BRANCH_6-3/sdump.c
Log:
Extend documentation, add license.

Modified: branches/BRANCH_6-3/sdump.c
===================================================================
--- branches/BRANCH_6-3/sdump.c	2009-08-05 16:27:47 UTC (rev 5390)
+++ branches/BRANCH_6-3/sdump.c	2009-08-05 16:50:48 UTC (rev 5391)
@@ -1,7 +1,12 @@
-/* sdump.c -- library to allocate a printable version of a string */
+/* sdump.c -- library to allocate and format a printable version of a
+ * string with embedded NUL */
+
 /** \file sdump.c
  * \author Matthias Andree
  * \date 2009
+ *
+ * This file is available under the GNU Lesser General Public License
+ * v2.1 or any later version of the GNU LGPL.
  */
 
 #include <ctype.h>  /* for isprint() */
@@ -14,7 +19,9 @@
 /** sdump converts a byte string \a in of size \a len into a printable
  * string and returns a pointer to the memory region.
  * \returns a pointer to a xmalloc()ed string that the caller must
- * free() after use. This function causes program abort on failure. */
+ * free() after use. This function causes program abort on failure
+ * through xmalloc. xmalloc is a function that calls malloc() and aborts
+ * the program if malloc() returned NULL i. e. failure. */
 char *sdump(const char *in, size_t len)
 {
     size_t outlen = 0, i;



From svn at mknod.org  Wed Aug  5 19:32:32 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 12:32:32 -0500
Subject: [fetchmail-svn] r5392 - branches/BRANCH_6-3
Message-ID: <20090805173232.17F9E21F140@mknod.org>

Author: m-a
Date: 2009-08-05 12:32:31 -0500 (Wed, 05 Aug 2009)
New Revision: 5392

Added:
   branches/BRANCH_6-3/fetchmail-SA-2009-01.txt
Modified:
   branches/BRANCH_6-3/Makefile.am
Log:
Add fetchmail-SA-2009-01.txt and hook it to the tarball.

Note that the subjectAltName part of the patch is untested.

Modified: branches/BRANCH_6-3/Makefile.am
===================================================================
--- branches/BRANCH_6-3/Makefile.am	2009-08-05 16:50:48 UTC (rev 5391)
+++ branches/BRANCH_6-3/Makefile.am	2009-08-05 17:32:31 UTC (rev 5392)
@@ -128,6 +128,7 @@
 		fetchmail-features.html README.SSL README.NTLM \
 		README.packaging README.SSL-SERVER \
 		fetchmail-FAQ.book fetchmail-FAQ.pdf fetchmail-FAQ.html \
+		fetchmail-SA-2009-01.txt \
 		fetchmail-SA-2008-01.txt \
 		fetchmail-SA-2007-02.txt \
 		fetchmail-SA-2007-01.txt \

Added: branches/BRANCH_6-3/fetchmail-SA-2009-01.txt
===================================================================
--- branches/BRANCH_6-3/fetchmail-SA-2009-01.txt	                        (rev 0)
+++ branches/BRANCH_6-3/fetchmail-SA-2009-01.txt	2009-08-05 17:32:31 UTC (rev 5392)
@@ -0,0 +1,161 @@
+fetchmail-SA-2009-01: Improper SSL certificate subject verification
+
+Topics:		Improper SSL certificate subject verification
+
+Author:		Matthias Andree
+Version:	1.0
+Announced:	2009-08-XX
+Type:		Allows undetected Man-in-the-middle attacks against SSL/TLS.
+Impact:		Credential disclose to eavesdroppers.
+Danger:		low
+CVSS V2 vector: (AV:N/AC:M/Au:N/C:P/I:N/A:N/E:H/RL:OF/RC:C)
+
+Credits:	
+CVE Name:	CVE-2009-xxxx
+URL:		http://www.fetchmail.info/fetchmail-SA-2009-01.txt
+Project URL:	http://www.fetchmail.info/
+
+Affects:	fetchmail release before and excluding 6.3.11
+
+Not affected:	fetchmail release 6.3.11 and newer
+
+Corrected:	2009-08-04 fetchmail SVN (rev 5389)
+
+References:	"Null Prefix Attacks Against SSL/TLS Certificates",
+		Moxie Marlinspike, 2009-07-29, Defcon 17, Blackhat 09.
+
+		CVE-2009-2408, Mozilla Firefox <3.5 and NSS <3.12.3
+		improper handling of '\0' characters in domain names in
+		the Subject CN field of X.509 certificates.
+
+
+0. Release history
+==================
+
+2009-08-05 0.1	first draft (visible in SVN)
+
+
+1. Background
+=============
+
+fetchmail is a software package to retrieve mail from remote POP2, POP3,
+IMAP, ETRN or ODMR servers and forward it to local SMTP, LMTP servers or
+message delivery agents. It supports SSL and TLS security layers through
+the OpenSSL library, if enabled at compile time and if also enabled at
+run time.
+
+
+2. Problem description and Impact
+=================================
+
+Moxie Marlinspike demonstrated in July 2009 that some CAs would sign
+certificates that contain embedded NUL characters in the Common Name or
+subjectAltName fields of ITU-T X.509 certificates. Applications what
+would treat such strings in X.509 as NUL-terminated C strings (rather
+than strings that contain an explicit length field) would only
+check the part up to and excluding the NUL character, so that
+certificate names such as www.good.example\0www.bad.example.com would be
+mistaken as a certificate name for www.good.example. The CA however
+would usually sign example.com and not care about the subdomain.
+
+
+3. Solution
+===========
+
+There are two alternatives, either of them by itself is sufficient:
+
+a. Apply the patch found in section B of this announcement to
+   fetchmail 6.3.10, recompile and reinstall it.
+
+b. Install fetchmail 6.3.11 or newer after it will have become available.
+   The fetchmail source code is always available from
+   <http://developer.berlios.de/project/showfiles.php?group_id=1824>.
+
+
+4. Workaround
+=============
+
+Obtain the server fingerprints through a separate secure channel and
+configure them with the sslfingerprint option, and enable the sslcertck
+option.
+
+
+A. Copyright, License and Warranty
+==================================
+
+(C) Copyright 2009 by Matthias Andree, <matthias.andree at gmx.de>.
+Some rights reserved.
+
+This work is licensed under the Creative Commons
+Attribution-Noncommercial-No Derivative Works 3.0 Germany License.
+To view a copy of this license, visit
+http://creativecommons.org/licenses/by-nc-nd/3.0/de/ or send a letter to
+
+Creative Commons
+171 Second Street
+Suite 300
+SAN FRANCISCO, CALIFORNIA 94105
+USA
+
+
+THIS WORK IS PROVIDED FREE OF CHARGE AND WITHOUT ANY WARRANTIES.
+Use the information herein at your own risk.
+
+
+B. Patch to remedy the problem
+==============================
+
+Note that when taking this from a GnuPG clearsigned file, the lines 
+starting with a "-" character are prefixed by another "- " (dash + 
+blank) combination. Either feed this file through GnuPG to strip them, 
+or strip them manually.
+
+Whitespace differences can usually be ignored by invoking "patch -l",
+so try this if the patch does not apply.
+
+
+Index: socket.c
+===================================================================
+--- ./socket.c~
++++ ./socket.c
+@@ -632,6 +632,12 @@
+ 				report(stderr, GT_("Bad certificate: Subject CommonName too long!\n"));
+ 				return (0);
+ 			}
++			if ((size_t)i > strlen(buf)) {
++				/* Name contains embedded NUL characters, so we complain. This is likely
++				 * a certificate spoofing attack. */
++				report(stderr, GT_("Bad certificate: Subject CommonName contains NUL, aborting!\n"));
++				return 0;
++			}
+ 			if (_ssl_server_cname != NULL) {
+ 				char *p1 = buf;
+ 				char *p2 = _ssl_server_cname;
+@@ -643,14 +649,21 @@
+ 				 * first find a match among alternative names */
+ 				gens = (STACK_OF(GENERAL_NAME) *)X509_get_ext_d2i(x509_cert, NID_subject_alt_name, NULL, NULL);
+ 				if (gens) {
+-					int i, r;
+-					for (i = 0, r = sk_GENERAL_NAME_num(gens); i < r; ++i) {
+-						const GENERAL_NAME *gn = sk_GENERAL_NAME_value(gens, i);
++					int j, r;
++					for (j = 0, r = sk_GENERAL_NAME_num(gens); j < r; ++j) {
++						const GENERAL_NAME *gn = sk_GENERAL_NAME_value(gens, j);
+ 						if (gn->type == GEN_DNS) {
+ 							char *p1 = (char *)gn->d.ia5->data;
+ 							char *p2 = _ssl_server_cname;
++							/* Name contains embedded NUL characters, so we complain. This
++							 * is likely a certificate spoofing attack. */
++							if ((size_t)gn->d.ia5->length != strlen(p1)) {
++								report(stderr, GT_("Bad certificate: Subject Alternative Name contains NUL, aborting!\n"));
++								sk_GENERAL_NAME_free(gens);
++								return 0;
++							}
+ 							if (outlevel >= O_VERBOSE)
+-								report(stderr, "Subject Alternative Name: %s\n", p1);
++								report(stdout, GT_("Subject Alternative Name: %s\n"), p1);
+ 							if (*p1 == '*') {
+ 								++p1;
+ 								n = strlen(p2) - strlen(p1);
+
+END OF fetchmail-SA-2009-01.txt



From svn at mknod.org  Thu Aug  6 00:55:43 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 17:55:43 -0500
Subject: [fetchmail-svn] r5393 - branches/BRANCH_6-3
Message-ID: <20090805225543.E88BF21F140@mknod.org>

Author: m-a
Date: 2009-08-05 17:55:43 -0500 (Wed, 05 Aug 2009)
New Revision: 5393

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/socket.c
Log:
Use sdump to display non-printing characters in certificate subject names.

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-05 17:32:31 UTC (rev 5392)
+++ branches/BRANCH_6-3/NEWS	2009-08-05 22:55:43 UTC (rev 5393)
@@ -60,6 +60,9 @@
 * Remove the spurious message "message delimiter found while scanning headers".
   RFC-5322 syntax states that the delimiter is part of the body, and the body is
   optional.
+* Convert all non-printable characters in certificate Subject/Issuer
+  Common Name or Subject Alternative Name fields to ANSI-C hex escapes (\xnn,
+  where nn are hex digits).
 
 # TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
 * [zh_CN] Chinese/Simplified (Ji ZhengYu)

Modified: branches/BRANCH_6-3/socket.c
===================================================================
--- branches/BRANCH_6-3/socket.c	2009-08-05 17:32:31 UTC (rev 5392)
+++ branches/BRANCH_6-3/socket.c	2009-08-05 22:55:43 UTC (rev 5393)
@@ -52,6 +52,7 @@
 #include "fetchmail.h"
 #include "getaddrinfo.h"
 #include "i18n.h"
+#include "sdump.h"
 
 /* Defines to allow BeOS and Cygwin to play nice... */
 #ifdef __BEOS__
@@ -598,6 +599,7 @@
 	const EVP_MD *digest_tp;
 	unsigned int dsz, esz;
 	X509_NAME *subj, *issuer;
+	char *tt;
 
 	x509_cert = X509_STORE_CTX_get_current_cert(ctx);
 	err = X509_STORE_CTX_get_error(ctx);
@@ -611,13 +613,15 @@
 
 		if (outlevel >= O_VERBOSE) {
 			if ((i = X509_NAME_get_text_by_NID(issuer, NID_organizationName, buf, sizeof(buf))) != -1) {
-				report(stdout, GT_("Issuer Organization: %s\n"), buf);
+				report(stdout, GT_("Issuer Organization: %s\n"), (tt = sdump(buf, i)));
+				xfree(tt);
 				if ((size_t)i >= sizeof(buf) - 1)
 					report(stdout, GT_("Warning: Issuer Organization Name too long (possibly truncated).\n"));
 			} else
 				report(stdout, GT_("Unknown Organization\n"));
 			if ((i = X509_NAME_get_text_by_NID(issuer, NID_commonName, buf, sizeof(buf))) != -1) {
-				report(stdout, GT_("Issuer CommonName: %s\n"), buf);
+				report(stdout, GT_("Issuer CommonName: %s\n"), (tt = sdump(buf, i)));
+				xfree(tt);
 				if ((size_t)i >= sizeof(buf) - 1)
 					report(stdout, GT_("Warning: Issuer CommonName too long (possibly truncated).\n"));
 			} else
@@ -625,7 +629,8 @@
 		}
 		if ((i = X509_NAME_get_text_by_NID(subj, NID_commonName, buf, sizeof(buf))) != -1) {
 			if (outlevel >= O_VERBOSE)
-				report(stdout, GT_("Server CommonName: %s\n"), buf);
+				report(stdout, GT_("Server CommonName: %s\n"), (tt = sdump(buf, i)));
+			xfree(tt);
 			if ((size_t)i >= sizeof(buf) - 1) {
 				/* Possible truncation. In this case, this is a DNS name, so this
 				 * is really bad. We do not tolerate this even in the non-strict case. */
@@ -662,8 +667,10 @@
 								sk_GENERAL_NAME_free(gens);
 								return 0;
 							}
-							if (outlevel >= O_VERBOSE)
-								report(stdout, GT_("Subject Alternative Name: %s\n"), p1);
+							if (outlevel >= O_VERBOSE) {
+								report(stdout, GT_("Subject Alternative Name: %s\n"), (tt = sdump(p1, (size_t)gn->d.ia5->length)));
+								xfree(tt);
+							}
 							if (*p1 == '*') {
 								++p1;
 								n = strlen(p2) - strlen(p1);
@@ -689,7 +696,8 @@
 				if (!matched) {
 					report(stderr,
 					    GT_("Server CommonName mismatch: %s != %s\n"),
-					    buf, _ssl_server_cname );
+					    (tt = sdump(buf, i)), _ssl_server_cname );
+					xfree(tt);
 					if (ok_return && strict)
 						return (0);
 				}



From svn at mknod.org  Thu Aug  6 00:59:59 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 17:59:59 -0500
Subject: [fetchmail-svn] r5394 - branches/BRANCH_6-3
Message-ID: <20090805225959.1A96821F140@mknod.org>

Author: m-a
Date: 2009-08-05 17:59:58 -0500 (Wed, 05 Aug 2009)
New Revision: 5394

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/fetchmail-SA-2009-01.txt
Log:
Add CVE information, clear unrelated part from patch.

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-05 22:55:43 UTC (rev 5393)
+++ branches/BRANCH_6-3/NEWS	2009-08-05 22:59:58 UTC (rev 5394)
@@ -49,12 +49,21 @@
 
 --------------------------------------------------------------------------------
 
-fetchmail 6.3.11 (released XXXX-XX-XX - i. e. not yet):
+fetchmail 6.3.11 (released 2009-08-06):
 
 # SECURITY BUGFIXES
-* Fetchmail checks the Subject CommonName and Subject AltName X.509 certificate
-  fields for embedded NUL characters and aborts certificate verification to
-  counter recent SSL certificate verification attacks. Untested.
+* CVE-2009-2666: SSL NUL prefix impersonation attack through NULs in a
+  part of a X.509 certificate's CommonName and subjectAltName fields. These
+  fields use opaque strings with a separate length field, so that the NUL
+  character isn't a special character inside the certificate. Fetchmail, being
+  written in the C language, used to treat these strings as C strings
+  nonetheless, so that the domain comparison would end at the first embedded NUL
+  character, rather than at the real end of the string.
+    Fetchmail will now abort certificate verification as failed if NULs are
+  encountered inside either of these fields regardless of their position, and
+  drop the connection even if --sslcertck is not used, because NUL is not a
+  valid character in legitimate DNS names.
+  See fetchmail-SA-2009-01.txt for details, including a minimal patch.
 
 # BUGFIXES
 * Remove the spurious message "message delimiter found while scanning headers".

Modified: branches/BRANCH_6-3/fetchmail-SA-2009-01.txt
===================================================================
--- branches/BRANCH_6-3/fetchmail-SA-2009-01.txt	2009-08-05 22:55:43 UTC (rev 5393)
+++ branches/BRANCH_6-3/fetchmail-SA-2009-01.txt	2009-08-05 22:59:58 UTC (rev 5394)
@@ -4,18 +4,17 @@
 
 Author:		Matthias Andree
 Version:	1.0
-Announced:	2009-08-XX
+Announced:	2009-08-06
 Type:		Allows undetected Man-in-the-middle attacks against SSL/TLS.
 Impact:		Credential disclose to eavesdroppers.
-Danger:		low
-CVSS V2 vector: (AV:N/AC:M/Au:N/C:P/I:N/A:N/E:H/RL:OF/RC:C)
+Danger:		medium
+CVSSv2 vectors:	(AV:N/AC:M/Au:N/C:P/I:N/A:N) (E:H/RL:OF/RC:C)
 
-Credits:	
-CVE Name:	CVE-2009-xxxx
+CVE Name:	CVE-2009-2666
 URL:		http://www.fetchmail.info/fetchmail-SA-2009-01.txt
 Project URL:	http://www.fetchmail.info/
 
-Affects:	fetchmail release before and excluding 6.3.11
+Affects:	fetchmail releases up to and including 6.3.10
 
 Not affected:	fetchmail release 6.3.11 and newer
 
@@ -33,6 +32,7 @@
 ==================
 
 2009-08-05 0.1	first draft (visible in SVN)
+2009-08-06 1.0	first release
 
 
 1. Background
@@ -131,7 +131,7 @@
  			if (_ssl_server_cname != NULL) {
  				char *p1 = buf;
  				char *p2 = _ssl_server_cname;
-@@ -643,14 +649,21 @@
+@@ -643,11 +649,18 @@
  				 * first find a match among alternative names */
  				gens = (STACK_OF(GENERAL_NAME) *)X509_get_ext_d2i(x509_cert, NID_subject_alt_name, NULL, NULL);
  				if (gens) {
@@ -152,10 +152,6 @@
 +								return 0;
 +							}
  							if (outlevel >= O_VERBOSE)
--								report(stderr, "Subject Alternative Name: %s\n", p1);
-+								report(stdout, GT_("Subject Alternative Name: %s\n"), p1);
- 							if (*p1 == '*') {
- 								++p1;
- 								n = strlen(p2) - strlen(p1);
+ 								report(stderr, "Subject Alternative Name: %s\n", p1);
 
 END OF fetchmail-SA-2009-01.txt



From svn at mknod.org  Thu Aug  6 01:05:54 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 18:05:54 -0500
Subject: [fetchmail-svn] r5395 - branches/BRANCH_6-3
Message-ID: <20090805230554.D5FD221F140@mknod.org>

Author: m-a
Date: 2009-08-05 18:05:54 -0500 (Wed, 05 Aug 2009)
New Revision: 5395

Modified:
   branches/BRANCH_6-3/fetchmail-SA-2009-01.txt
Log:
Revise section 2 for readability, mention recommended settings.

Modified: branches/BRANCH_6-3/fetchmail-SA-2009-01.txt
===================================================================
--- branches/BRANCH_6-3/fetchmail-SA-2009-01.txt	2009-08-05 22:59:58 UTC (rev 5394)
+++ branches/BRANCH_6-3/fetchmail-SA-2009-01.txt	2009-08-05 23:05:54 UTC (rev 5395)
@@ -50,15 +50,28 @@
 
 Moxie Marlinspike demonstrated in July 2009 that some CAs would sign
 certificates that contain embedded NUL characters in the Common Name or
-subjectAltName fields of ITU-T X.509 certificates. Applications what
-would treat such strings in X.509 as NUL-terminated C strings (rather
-than strings that contain an explicit length field) would only
-check the part up to and excluding the NUL character, so that
+subjectAltName fields of ITU-T X.509 certificates.
+
+Applications that would treat such X.509 strings as NUL-terminated C
+strings (rather than strings that contain an explicit length field)
+would only check the part up to and excluding the NUL character, so that
 certificate names such as www.good.example\0www.bad.example.com would be
-mistaken as a certificate name for www.good.example. The CA however
-would usually sign example.com and not care about the subdomain.
+mistaken as a certificate name for www.good.example.  fetchmail also had
+this design and implementation flaw.
 
+Note that fetchmail should always be forced to use strict certificate
+validation through either of these option combinations:
 
+    --sslcertck --ssl --sslproto ssl3    (for service on SSL-wrapped ports)
+or
+    --sslcertck --sslproto tls1          (for STARTTLS-based services)
+
+(These are for the command line, in the rcfile, you will need to omit
+the respective leading --).
+
+The default is relaxed checking for compatibility with historic versions.
+
+
 3. Solution
 ===========
 



From svn at mknod.org  Thu Aug  6 01:18:44 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 18:18:44 -0500
Subject: [fetchmail-svn] r5396 - branches/BRANCH_6-3
Message-ID: <20090805231844.2B10E21F140@mknod.org>

Author: m-a
Date: 2009-08-05 18:18:44 -0500 (Wed, 05 Aug 2009)
New Revision: 5396

Modified:
   branches/BRANCH_6-3/socket.c
Log:
Report Subject Alternative Name before checking for NULs.

Modified: branches/BRANCH_6-3/socket.c
===================================================================
--- branches/BRANCH_6-3/socket.c	2009-08-05 23:05:54 UTC (rev 5395)
+++ branches/BRANCH_6-3/socket.c	2009-08-05 23:18:44 UTC (rev 5396)
@@ -660,6 +660,10 @@
 						if (gn->type == GEN_DNS) {
 							char *p1 = (char *)gn->d.ia5->data;
 							char *p2 = _ssl_server_cname;
+							if (outlevel >= O_VERBOSE) {
+								report(stdout, GT_("Subject Alternative Name: %s\n"), (tt = sdump(p1, (size_t)gn->d.ia5->length)));
+								xfree(tt);
+							}
 							/* Name contains embedded NUL characters, so we complain. This
 							 * is likely a certificate spoofing attack. */
 							if ((size_t)gn->d.ia5->length != strlen(p1)) {
@@ -667,10 +671,6 @@
 								sk_GENERAL_NAME_free(gens);
 								return 0;
 							}
-							if (outlevel >= O_VERBOSE) {
-								report(stdout, GT_("Subject Alternative Name: %s\n"), (tt = sdump(p1, (size_t)gn->d.ia5->length)));
-								xfree(tt);
-							}
 							if (*p1 == '*') {
 								++p1;
 								n = strlen(p2) - strlen(p1);



From svn at mknod.org  Thu Aug  6 01:43:28 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 18:43:28 -0500
Subject: [fetchmail-svn] r5398 - branches/BRANCH_6-3
Message-ID: <20090805234328.C159521F140@mknod.org>

Author: m-a
Date: 2009-08-05 18:43:28 -0500 (Wed, 05 Aug 2009)
New Revision: 5398

Modified:
   branches/BRANCH_6-3/fetchmail-SA-2009-01.txt
Log:
Clearsign fetchmail-SA-2009-01.txt.

Modified: branches/BRANCH_6-3/fetchmail-SA-2009-01.txt
===================================================================
--- branches/BRANCH_6-3/fetchmail-SA-2009-01.txt	2009-08-05 23:33:14 UTC (rev 5397)
+++ branches/BRANCH_6-3/fetchmail-SA-2009-01.txt	2009-08-05 23:43:28 UTC (rev 5398)
@@ -1,3 +1,6 @@
+-----BEGIN PGP SIGNED MESSAGE-----
+Hash: SHA1
+
 fetchmail-SA-2009-01: Improper SSL certificate subject verification
 
 Topics:		Improper SSL certificate subject verification
@@ -129,7 +132,7 @@
 
 Index: socket.c
 ===================================================================
---- ./socket.c~
+- --- ./socket.c~
 +++ ./socket.c
 @@ -632,6 +632,12 @@
  				report(stderr, GT_("Bad certificate: Subject CommonName too long!\n"));
@@ -148,9 +151,9 @@
  				 * first find a match among alternative names */
  				gens = (STACK_OF(GENERAL_NAME) *)X509_get_ext_d2i(x509_cert, NID_subject_alt_name, NULL, NULL);
  				if (gens) {
--					int i, r;
--					for (i = 0, r = sk_GENERAL_NAME_num(gens); i < r; ++i) {
--						const GENERAL_NAME *gn = sk_GENERAL_NAME_value(gens, i);
+- -					int i, r;
+- -					for (i = 0, r = sk_GENERAL_NAME_num(gens); i < r; ++i) {
+- -						const GENERAL_NAME *gn = sk_GENERAL_NAME_value(gens, i);
 +					int j, r;
 +					for (j = 0, r = sk_GENERAL_NAME_num(gens); j < r; ++j) {
 +						const GENERAL_NAME *gn = sk_GENERAL_NAME_value(gens, j);
@@ -168,3 +171,10 @@
  								report(stderr, "Subject Alternative Name: %s\n", p1);
 
 END OF fetchmail-SA-2009-01.txt
+-----BEGIN PGP SIGNATURE-----
+Version: GnuPG v2.0.9 (GNU/Linux)
+
+iEYEARECAAYFAkp6GP8ACgkQvmGDOQUufZVuQwCgsD/kO/+KHC0/gopx/uiQr9V7
+mXAAnjH6G5DfcxAjCzjmt9DKZHGsqoNv
+=6zGh
+-----END PGP SIGNATURE-----



From svn at mknod.org  Thu Aug  6 02:09:25 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 19:09:25 -0500
Subject: [fetchmail-svn] r5399 - branches/BRANCH_6-3
Message-ID: <20090806000925.9C45321F140@mknod.org>

Author: m-a
Date: 2009-08-05 19:09:25 -0500 (Wed, 05 Aug 2009)
New Revision: 5399

Modified:
   branches/BRANCH_6-3/configure.ac
Log:
Add a reference to fetchmail.man version ID.

Modified: branches/BRANCH_6-3/configure.ac
===================================================================
--- branches/BRANCH_6-3/configure.ac	2009-08-05 23:43:28 UTC (rev 5398)
+++ branches/BRANCH_6-3/configure.ac	2009-08-06 00:09:25 UTC (rev 5399)
@@ -8,6 +8,7 @@
 dnl Process this file with autoconf to produce a configure script.
 dnl
 
+dnl XXX - if bumping version here, check fetchmail.man, too!
 AC_INIT([fetchmail],[6.3.11],[fetchmail-users at lists.berlios.de])
 AC_CONFIG_SRCDIR([fetchmail.h])
 AC_CONFIG_HEADERS([config.h])



From svn at mknod.org  Thu Aug  6 02:10:19 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 19:10:19 -0500
Subject: [fetchmail-svn] r5400 - tags
Message-ID: <20090806001019.9692F21F140@mknod.org>

Author: m-a
Date: 2009-08-05 19:10:19 -0500 (Wed, 05 Aug 2009)
New Revision: 5400

Added:
   tags/RELEASE_6-3-11/
Log:
tagging fetchmail 6.3.11.



From svn at mknod.org  Thu Aug  6 02:18:41 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 19:18:41 -0500
Subject: [fetchmail-svn] r5401 - branches/BRANCH_6-3/dist-tools
Message-ID: <20090806001841.8A05A21F140@mknod.org>

Author: m-a
Date: 2009-08-05 19:18:41 -0500 (Wed, 05 Aug 2009)
New Revision: 5401

Modified:
   branches/BRANCH_6-3/dist-tools/send-security-announce.sh
Log:
Update.

Modified: branches/BRANCH_6-3/dist-tools/send-security-announce.sh
===================================================================
--- branches/BRANCH_6-3/dist-tools/send-security-announce.sh	2009-08-06 00:10:19 UTC (rev 5400)
+++ branches/BRANCH_6-3/dist-tools/send-security-announce.sh	2009-08-06 00:18:41 UTC (rev 5401)
@@ -1,16 +1,15 @@
 test "$SEND_ANNOUNCEMENTS" = doit || { echo "read the source, luke! -> $0" ; cat "$0" ; exit 1 ; }
 
-ANN=fetchmail-SA-2008-02
-FILE=$HOME/mywork/fetchmail/BRANCH_6-3/$ANN.txt
+ANN=fetchmail-SA-2009-01
+FILE=$HOME/VCS-mine/fetchmail.svn/BRANCH_6-3/$ANN.txt
 test -r $FILE || { echo "Cannot find $FILE." ; exit 1 ; }
 CVE=$(sed -n '/^CVE Name:/ { s/^.*:[ 	]*//p;q; }' $FILE)
 SUBJECT="fetchmail security announcement $ANN ($CVE)"
+MAILER=mail
 
-nail -r ma+nomail at dt.e-technik.uni-dortmund.de -s "$SUBJECT" <$FILE \
-    vulnwatch at vulnwatch.org
-
-nail -r ma+bt at dt.e-technik.uni-dortmund.de -s "$SUBJECT" <$FILE \
+$MAILER -r ma+bt at dt.e-technik.uni-dortmund.de -s "$SUBJECT" <$FILE \
     bugtraq at securityfocus.com
 
-nail -r matthias.andree at gmx.de -s "$SUBJECT" <$FILE \
-    vendor-sec at lst.de fetchmail-announce at lists.berlios.de
+$MAILER -r matthias.andree at gmx.de -s "$SUBJECT" <$FILE \
+    vendor-sec at lst.de \
+    fetchmail-announce at lists.berlios.de



From svn at mknod.org  Thu Aug  6 02:18:47 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 19:18:47 -0500
Subject: [fetchmail-svn] r5402 - branches/BRANCH_6-3
Message-ID: <20090806001847.C2C7A21F140@mknod.org>

Author: m-a
Date: 2009-08-05 19:18:47 -0500 (Wed, 05 Aug 2009)
New Revision: 5402

Modified:
   branches/BRANCH_6-3/fetchmail.man
Log:
Bump version.

Modified: branches/BRANCH_6-3/fetchmail.man
===================================================================
--- branches/BRANCH_6-3/fetchmail.man	2009-08-06 00:18:41 UTC (rev 5401)
+++ branches/BRANCH_6-3/fetchmail.man	2009-08-06 00:18:47 UTC (rev 5402)
@@ -10,7 +10,7 @@
 .\" Load www macros to process .URL requests, this requires groff:
 .mso www.tmac
 .\"
-.TH fetchmail 1 "fetchmail 6.3.10" "fetchmail" "fetchmail reference manual"
+.TH fetchmail 1 "fetchmail 6.3.11" "fetchmail" "fetchmail reference manual"
 
 .SH NAME
 fetchmail \- fetch mail from a POP, IMAP, ETRN, or ODMR-capable server



From svn at mknod.org  Thu Aug  6 02:18:53 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 19:18:53 -0500
Subject: [fetchmail-svn] r5403 - branches/BRANCH_6-3
Message-ID: <20090806001853.157B821F140@mknod.org>

Author: m-a
Date: 2009-08-05 19:18:53 -0500 (Wed, 05 Aug 2009)
New Revision: 5403

Modified:
   branches/BRANCH_6-3/RELEASEVERSIONS
Log:
Add 6.3.11.

Modified: branches/BRANCH_6-3/RELEASEVERSIONS
===================================================================
--- branches/BRANCH_6-3/RELEASEVERSIONS	2009-08-06 00:18:47 UTC (rev 5402)
+++ branches/BRANCH_6-3/RELEASEVERSIONS	2009-08-06 00:18:53 UTC (rev 5403)
@@ -1,6 +1,7 @@
 SVN release - fetchmail release    - release manager
 ====================================================
               SORT_BY (release)
+r5398       - 6.3.11   (2009-08-06) - MA
 r5373       - 6.3.10   (2009-07-02) - MA
 r5248       - 6.3.9    (2008-11-16) - MA
 r5093       - 6.3.8    (2007-04-06) - MA



From svn at mknod.org  Thu Aug  6 02:20:11 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 19:20:11 -0500
Subject: [fetchmail-svn] r5404 - branches/BRANCH_6-3/website
Message-ID: <20090806002011.D39B821F140@mknod.org>

Author: m-a
Date: 2009-08-05 19:20:11 -0500 (Wed, 05 Aug 2009)
New Revision: 5404

Added:
   branches/BRANCH_6-3/website/fetchmail-SA-2009-01.txt
Modified:
   branches/BRANCH_6-3/website/index.html
Log:
Update website for 6.3.11 release.

Added: branches/BRANCH_6-3/website/fetchmail-SA-2009-01.txt
===================================================================
--- branches/BRANCH_6-3/website/fetchmail-SA-2009-01.txt	                        (rev 0)
+++ branches/BRANCH_6-3/website/fetchmail-SA-2009-01.txt	2009-08-06 00:20:11 UTC (rev 5404)
@@ -0,0 +1 @@
+link ../fetchmail-SA-2009-01.txt
\ No newline at end of file


Property changes on: branches/BRANCH_6-3/website/fetchmail-SA-2009-01.txt
___________________________________________________________________
Added: svn:special
   + *

Modified: branches/BRANCH_6-3/website/index.html
===================================================================
--- branches/BRANCH_6-3/website/index.html	2009-08-06 00:18:53 UTC (rev 5403)
+++ branches/BRANCH_6-3/website/index.html	2009-08-06 00:20:11 UTC (rev 5404)
@@ -45,8 +45,9 @@
     <p>On 2009-08-06, <a
 	href="http://developer.berlios.de/project/showfiles.php?group_id=1824">fetchmail-6.3.11
 	has been released (this is the download link),</a> fixing
-    various bugs. It is a recommended security update for all users. <a
-	href="http://developer.berlios.de/project/shownotes.php?group_id=1824&amp;release_id=16448">Click
+    the security bug in the SSL/TLS certificate verification
+    CVE-2009-2666. It is a recommended security update for all users. <a
+	href="http://developer.berlios.de/project/shownotes.php?group_id=1824&amp;release_id=16574">Click
 	here to see the change details.</a>
     </p>
 </div>



From svn at mknod.org  Thu Aug  6 02:21:26 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed,  5 Aug 2009 19:21:26 -0500
Subject: [fetchmail-svn] r5405 - branches/BRANCH_6-3/website
Message-ID: <20090806002126.0FBC321F140@mknod.org>

Author: m-a
Date: 2009-08-05 19:21:25 -0500 (Wed, 05 Aug 2009)
New Revision: 5405

Modified:
   branches/BRANCH_6-3/website/index.html
Log:
Remove one version reference to avoid inconsistencies.

Modified: branches/BRANCH_6-3/website/index.html
===================================================================
--- branches/BRANCH_6-3/website/index.html	2009-08-06 00:20:11 UTC (rev 5404)
+++ branches/BRANCH_6-3/website/index.html	2009-08-06 00:21:25 UTC (rev 5405)
@@ -73,7 +73,7 @@
 
 <p style="font-size:100%"><strong>Please <a
 	href="http://developer.berlios.de/project/showfiles.php?group_id=1824">update
-	to fetchmail version 6.3.10</a>.</strong></p>
+	to the newest fetchmail version</a>.</strong></p>
 
 </div>
 



From svn at mknod.org  Thu Aug  6 11:15:43 2009
From: svn at mknod.org (svn at mknod.org)
Date: Thu,  6 Aug 2009 04:15:43 -0500
Subject: [fetchmail-svn] r5406 - in branches/BRANCH_6-3: . po
Message-ID: <20090806091543.3ACE621F3F1@mknod.org>

Author: m-a
Date: 2009-08-06 04:15:42 -0500 (Thu, 06 Aug 2009)
New Revision: 5406

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/po/cs.po
Log:
Update Czech translation for 6.3.11, courtesy of Petr Pisar.

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-06 00:21:25 UTC (rev 5405)
+++ branches/BRANCH_6-3/NEWS	2009-08-06 09:15:42 UTC (rev 5406)
@@ -49,6 +49,12 @@
 
 --------------------------------------------------------------------------------
 
+fetchmail 6.3.12 (released XXXX-XX-XX - not yet):
+
+# TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
+* [cs]    Czech (Petr Pisar)
+
+
 fetchmail 6.3.11 (released 2009-08-06):
 
 # SECURITY BUGFIXES

Modified: branches/BRANCH_6-3/po/cs.po
===================================================================
--- branches/BRANCH_6-3/po/cs.po	2009-08-06 00:21:25 UTC (rev 5405)
+++ branches/BRANCH_6-3/po/cs.po	2009-08-06 09:15:42 UTC (rev 5406)
@@ -5,12 +5,16 @@
 # Ji?? Pavlovsk? <pavlovsk at ff.cuni.cz>, 1999 - 2001.
 # Miloslav Trmac <mitr at volny.cz>, 2005.
 # Petr Pisar <petr.pisar at atlas.cz>, 2008, 2009.
+#
+# Subject Common Name ? obecn? jm?no (CN) subjektu
+# Subject Alternative Name ? alternatvivn? jm?no subjektu (? otherName)
+#
 msgid ""
 msgstr ""
-"Project-Id-Version: fetchmail 6.3.10-pre1\n"
+"Project-Id-Version: fetchmail 6.3.11\n"
 "Report-Msgid-Bugs-To: fetchmail-devel at lists.berlios.de\n"
 "POT-Creation-Date: 2009-08-06 01:21+0200\n"
-"PO-Revision-Date: 2009-05-26 10:58+0200\n"
+"PO-Revision-Date: 2009-08-06 11:09+0200\n"
 "Last-Translator: Petr Pisar <petr.pisar at atlas.cz>\n"
 "Language-Team: Czech <translation-team-cs at lists.sourceforge.net>\n"
 "MIME-Version: 1.0\n"
@@ -60,6 +64,7 @@
 msgid "krb5_sendauth: %s [server says '%*s'] \n"
 msgstr "krb5_sendauth: %s [server ??k? '%*s'] \n"
 
+# XXX: This is e-mail header as literal. Dont't touch "Subject: " header name.
 #: driver.c:335
 msgid "Subject: Fetchmail oversized-messages warning"
 msgstr "Subject: Varov?n? fetchmail o p??li? velk?ch zpr?v?ch"
@@ -135,11 +140,8 @@
 
 #: driver.c:751
 #, c-format
-msgid ""
-"message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
-msgstr ""
-"zpr?va %s@%s:%d nem? o?ek?vanou velikost (%d ve skute?nosti != %d "
-"o?ek?v?no)\n"
+msgid "message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
+msgstr "zpr?va %s@%s:%d nem? o?ek?vanou velikost (%d ve skute?nosti != %d o?ek?v?no)\n"
 
 #: driver.c:783
 msgid " retained\n"
@@ -156,14 +158,10 @@
 #: driver.c:828
 #, c-format
 msgid "fetchlimit %d reached; %d message left on server %s account %s\n"
-msgid_plural ""
-"fetchlimit %d reached; %d messages left on server %s account %s\n"
-msgstr[0] ""
-"limit stahov?n? %d dosa?en; %d zpr?va ponech?na na serveru %s ??et %s\n"
-msgstr[1] ""
-"limit stahov?n? %d dosa?en; %d zpr?vy ponech?ny na serveru %s ??et %s\n"
-msgstr[2] ""
-"limit stahov?n? %d dosa?en; %d zpr?v ponech?no na serveru %s ??et %s\n"
+msgid_plural "fetchlimit %d reached; %d messages left on server %s account %s\n"
+msgstr[0] "limit stahov?n? %d dosa?en; %d zpr?va ponech?na na serveru %s ??et %s\n"
+msgstr[1] "limit stahov?n? %d dosa?en; %d zpr?vy ponech?ny na serveru %s ??et %s\n"
+msgstr[2] "limit stahov?n? %d dosa?en; %d zpr?v ponech?no na serveru %s ??et %s\n"
 
 #: driver.c:885
 #, c-format
@@ -196,11 +194,8 @@
 
 #: driver.c:916
 #, c-format
-msgid ""
-"Fetchmail saw more than %d timeouts while attempting to get mail from %s@%"
-"s.\n"
-msgstr ""
-"Fetchmailu vypr?el ?as v?ce ne? %d-kr?t p?i pokusu st?hnout po?tu z %s@%s.\n"
+msgid "Fetchmail saw more than %d timeouts while attempting to get mail from %s@%s.\n"
+msgstr "Fetchmailu vypr?el ?as v?ce ne? %d-kr?t p?i pokusu st?hnout po?tu z %s@%s.\n"
 
 #: driver.c:920
 msgid ""
@@ -357,6 +352,7 @@
 msgid "Authorization OK on %s@%s\n"
 msgstr "?sp??n? autorizace na %s@%s\n"
 
+# XXX: This is e-mail header as literal. Dont't touch "Subject: " header name.
 #: driver.c:1275
 #, c-format
 msgid "Subject: fetchmail authentication OK on %s@%s"
@@ -536,8 +532,7 @@
 msgid ""
 "%s: The NULLMAILER_FLAGS environment variable is set.\n"
 "This is dangerous as it can make nullmailer-inject or nullmailer's\n"
-"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: "
-"headers.\n"
+"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: headers.\n"
 "Try \"env NULLMAILER_FLAGS= %s YOUR ARGUMENTS HERE\"\n"
 "%s: Abort.\n"
 msgstr ""
@@ -565,15 +560,12 @@
 
 #: env.c:170
 msgid "Cannot find my own host in hosts database to qualify it!\n"
-msgstr ""
-"Nemohu nal?zt sv? vlastn? jm?no v?datab?zi jmen stroj?, abych jej mohl "
-"doplnit na cel? jm?no!\n"
+msgstr "Nemohu nal?zt sv? vlastn? jm?no v?datab?zi jmen stroj?, abych jej mohl doplnit na cel? jm?no!\n"
 
 #: env.c:174
 msgid ""
 "Trying to continue with unqualified hostname.\n"
-"DO NOT report broken Received: headers, HELO/EHLO lines or similar "
-"problems!\n"
+"DO NOT report broken Received: headers, HELO/EHLO lines or similar problems!\n"
 "DO repair your /etc/hosts, DNS, NIS or LDAP instead.\n"
 msgstr ""
 "Zkus?m pokra?ovat s?nekvalifikovan?m jm?nem stroje.\n"
@@ -647,14 +639,12 @@
 #: fetchmail.c:137
 msgid ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham Wilson\n"
 "Copyright (C) 2005 - 2006 Sunil Shetye\n"
 "Copyright (C) 2005 - 2009 Matthias Andree\n"
 msgstr ""
 "Copyright ? 2002, 2003 Eric S.?Raymond\n"
-"Copyright ? 2004 Matthias Andree, Eric S.?Raymond, Robert M.?Funk, Graham "
-"Wilson\n"
+"Copyright ? 2004 Matthias Andree, Eric S.?Raymond, Robert M.?Funk, Graham Wilson\n"
 "Copyright ? 2005?2006 Sunil Shetye\n"
 "Copyright ? 2005?2009 Matthias Andree\n"
 
@@ -664,8 +654,7 @@
 "are welcome to redistribute it under certain conditions. For details,\n"
 "please see the file COPYING in the source or documentation directory.\n"
 msgstr ""
-"Fetchmail ned?v? ABSOLUTN? ??DN? Z?RUKY. Toto je svobodn? programov? "
-"vybaven?\n"
+"Fetchmail ned?v? ABSOLUTN? ??DN? Z?RUKY. Toto je svobodn? programov? vybaven?\n"
 "a budeme r?di, kdy? jej budete za jist?ch podm?nek d?le ???it. Podrobnosti\n"
 "naleznete v?souboru COPYING v?adres??i se zdrojov?mi k?dy nebo dokumentac?.\n"
 
@@ -727,20 +716,13 @@
 msgstr "fetchmail: fetchmail %s v %d byl zabit.\n"
 
 #: fetchmail.c:480
-msgid ""
-"fetchmail: can't check mail while another fetchmail to same host is "
-"running.\n"
-msgstr ""
-"fetchmail: nemohu kontrolovat po?tu, kdy? b??? jin? fetchmail ke stejn?mu "
-"po??ta?i.\n"
+msgid "fetchmail: can't check mail while another fetchmail to same host is running.\n"
+msgstr "fetchmail: nemohu kontrolovat po?tu, kdy? b??? jin? fetchmail ke stejn?mu po??ta?i.\n"
 
 #: fetchmail.c:486
 #, c-format
-msgid ""
-"fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
-msgstr ""
-"fetchmail: nemohu stahovat ze zadan?ch server?, kdy? b??? jin? fetchmail v %"
-"d.\n"
+msgid "fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
+msgstr "fetchmail: nemohu stahovat ze zadan?ch server?, kdy? b??? jin? fetchmail v %d.\n"
 
 #: fetchmail.c:493
 #, c-format
@@ -748,8 +730,7 @@
 msgstr "fetchmail: v pop?ed? b??? jin? fetchmail v %d.\n"
 
 #: fetchmail.c:503
-msgid ""
-"fetchmail: can't accept options while a background fetchmail is running.\n"
+msgid "fetchmail: can't accept options while a background fetchmail is running.\n"
 msgstr "fetchmail: neakceptuji p?ep?na?e, kdy? na fetchmail b??? na pozad?.\n"
 
 #: fetchmail.c:509
@@ -788,9 +769,7 @@
 
 #: fetchmail.c:606
 msgid "fetchmail: Warning: syslog and logfile are set. Check both for logs!\n"
-msgstr ""
-"fetchmail: Varov?n?: syslog i?soubor s?protokolem jsou nastaveny. Z?znamy "
-"hledejte v?obou!\n"
+msgstr "fetchmail: Varov?n?: syslog i?soubor s?protokolem jsou nastaveny. Z?znamy hledejte v?obou!\n"
 
 #: fetchmail.c:625
 msgid "--check mode enabled, not fetching mail\n"
@@ -817,8 +796,7 @@
 #: fetchmail.c:714
 #, c-format
 msgid "poll of %s skipped (failed authentication or too many timeouts)\n"
-msgstr ""
-"stahov?n? z %s p?esko?eno (chyba autentizace nebo mnohokr?t vypr?el ?as)\n"
+msgstr "stahov?n? z %s p?esko?eno (chyba autentizace nebo mnohokr?t vypr?el ?as)\n"
 
 #: fetchmail.c:726
 #, c-format
@@ -926,9 +904,7 @@
 
 #: fetchmail.c:1102
 msgid "fetchmail: Error: multiple \"defaults\" records in config file.\n"
-msgstr ""
-"fetchmail: Chyba: z?znam ?defaults? je v konfigura?n?m souboru zm?n?n "
-"v?cekr?t.\n"
+msgstr "fetchmail: Chyba: z?znam ?defaults? je v konfigura?n?m souboru zm?n?n v?cekr?t.\n"
 
 #: fetchmail.c:1224
 msgid "SSL support is not compiled in.\n"
@@ -948,11 +924,8 @@
 
 #: fetchmail.c:1273
 #, c-format
-msgid ""
-"fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
-msgstr ""
-"fetchmail: varov?n?: nen? dostupn? DNS pro kontrolu v?b?ru spole?n?ch "
-"schr?nek z %s\n"
+msgid "fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
+msgstr "fetchmail: varov?n?: nen? dostupn? DNS pro kontrolu v?b?ru spole?n?ch schr?nek z %s\n"
 
 #: fetchmail.c:1284
 #, c-format
@@ -961,23 +934,17 @@
 
 #: fetchmail.c:1285
 msgid "warning: Do not ask for support if all mail goes to postmaster!\n"
-msgstr ""
-"varov?n?: Ne??dejte podporu, pokud v?echna po?ta p?jde k postmasterovi!\n"
+msgstr "varov?n?: Ne??dejte podporu, pokud v?echna po?ta p?jde k postmasterovi!\n"
 
 #: fetchmail.c:1302
 #, c-format
-msgid ""
-"fetchmail: %s configuration invalid, specify positive port number for "
-"service or port\n"
-msgstr ""
-"fetchmail: chybn? konfigurace %s, zadejte kladn? ??slo portu pro slu?bu nebo "
-"port\n"
+msgid "fetchmail: %s configuration invalid, specify positive port number for service or port\n"
+msgstr "fetchmail: chybn? konfigurace %s, zadejte kladn? ??slo portu pro slu?bu nebo port\n"
 
 #: fetchmail.c:1309
 #, c-format
 msgid "fetchmail: %s configuration invalid, RPOP requires a privileged port\n"
-msgstr ""
-"fetchmail: Nastaven? %s nen? platn?, PROP vy?aduje privilegovan? port\n"
+msgstr "fetchmail: Nastaven? %s nen? platn?, PROP vy?aduje privilegovan? port\n"
 
 #: fetchmail.c:1327
 #, c-format
@@ -986,8 +953,7 @@
 
 #: fetchmail.c:1341
 msgid "Both fetchall and keep on in daemon or idle mode is a mistake!\n"
-msgstr ""
-"Jak fetchall, tak i?keep jsou v?d?monu zapnuty nebo re?im idle je chyba!\n"
+msgstr "Jak fetchall, tak i?keep jsou v?d?monu zapnuty nebo re?im idle je chyba!\n"
 
 #: fetchmail.c:1366
 #, c-format
@@ -1058,9 +1024,7 @@
 #: fetchmail.c:1548
 #, c-format
 msgid "Fetchmail will forward misaddressed multidrop messages to %s.\n"
-msgstr ""
-"Fetchmail bude p?epos?lat ?patn? adresovan? zpr?vy ze spole?n?ch schr?nek na "
-"%s.\n"
+msgstr "Fetchmail bude p?epos?lat ?patn? adresovan? zpr?vy ze spole?n?ch schr?nek na %s.\n"
 
 #: fetchmail.c:1552
 msgid "Fetchmail will direct error mail to the postmaster.\n"
@@ -1072,13 +1036,11 @@
 
 #: fetchmail.c:1557
 msgid "Fetchmail will treat permanent errors as permanent (drop messsages).\n"
-msgstr ""
-"Fetchmail bude pova?ovat trval? chyby za trval? (zpr?vy bude zahazovat).\n"
+msgstr "Fetchmail bude pova?ovat trval? chyby za trval? (zpr?vy bude zahazovat).\n"
 
 #: fetchmail.c:1559
 msgid "Fetchmail will treat permanent errors as temporary (keep messages).\n"
-msgstr ""
-"Fetchmail bude pova?ovat trval? chyby za do?asn? (zpr?vy bude uchov?vat).\n"
+msgstr "Fetchmail bude pova?ovat trval? chyby za do?asn? (zpr?vy bude uchov?vat).\n"
 
 #: fetchmail.c:1566
 #, c-format
@@ -1105,13 +1067,11 @@
 
 #: fetchmail.c:1580
 msgid "  This host will not be queried when no host is specified.\n"
-msgstr ""
-"  Pokud nen? zad?n ??dn? po??ta?, nebude se stahovat z tohoto po??ta?e.\n"
+msgstr "  Pokud nen? zad?n ??dn? po??ta?, nebude se stahovat z tohoto po??ta?e.\n"
 
 #: fetchmail.c:1581
 msgid "  This host will be queried when no host is specified.\n"
-msgstr ""
-"  Pokud nen? zad?n ??dn? po??ta?, bude se stahovat z tohoto po??ta?e.\n"
+msgstr "  Pokud nen? zad?n ??dn? po??ta?, bude se stahovat z tohoto po??ta?e.\n"
 
 #: fetchmail.c:1585
 msgid "  Password will be prompted for.\n"
@@ -1221,7 +1181,7 @@
 #: fetchmail.c:1662
 #, c-format
 msgid "  SSL server CommonName: %s\n"
-msgstr "  CommonName SSL serveru: %s\n"
+msgstr "  Obecn? jm?no (CN) SSL serveru: %s\n"
 
 #: fetchmail.c:1664
 #, c-format
@@ -1263,40 +1223,27 @@
 
 #: fetchmail.c:1693
 msgid "  Old messages will be flushed before message retrieval (--flush on).\n"
-msgstr ""
-"  P?ed za??tkem stahov?n? budou star? zpr?vy smaz?ny (--flush zapnuto).\n"
+msgstr "  P?ed za??tkem stahov?n? budou star? zpr?vy smaz?ny (--flush zapnuto).\n"
 
 #: fetchmail.c:1694
-msgid ""
-"  Old messages will not be flushed before message retrieval (--flush off).\n"
-msgstr ""
-"  P?ed za??tkem stahov?n? nebudou star? zpr?vy smaz?ny (--flush vypnuto).\n"
+msgid "  Old messages will not be flushed before message retrieval (--flush off).\n"
+msgstr "  P?ed za??tkem stahov?n? nebudou star? zpr?vy smaz?ny (--flush vypnuto).\n"
 
 #: fetchmail.c:1696
-msgid ""
-"  Oversized messages will be flushed before message retrieval (--limitflush "
-"on).\n"
-msgstr ""
-"  P?ed za??tkem stahov?n? budou p??li? velk? zpr?vy smaz?ny (--limitflush "
-"zapnuto).\n"
+msgid "  Oversized messages will be flushed before message retrieval (--limitflush on).\n"
+msgstr "  P?ed za??tkem stahov?n? budou p??li? velk? zpr?vy smaz?ny (--limitflush zapnuto).\n"
 
 #: fetchmail.c:1697
-msgid ""
-"  Oversized messages will not be flushed before message retrieval (--"
-"limitflush off).\n"
-msgstr ""
-"  P?ed za??tkem stahov?n? nebudou p??li? velk? zpr?vy smaz?ny (--limitflush "
-"vypnuto).\n"
+msgid "  Oversized messages will not be flushed before message retrieval (--limitflush off).\n"
+msgstr "  P?ed za??tkem stahov?n? nebudou p??li? velk? zpr?vy smaz?ny (--limitflush vypnuto).\n"
 
 #: fetchmail.c:1699
 msgid "  Rewrite of server-local addresses is enabled (--norewrite off).\n"
-msgstr ""
-"  P?episov?n? adres m?stn?ch na serveru je povoleno (--norewrite vypnuto).\n"
+msgstr "  P?episov?n? adres m?stn?ch na serveru je povoleno (--norewrite vypnuto).\n"
 
 #: fetchmail.c:1700
 msgid "  Rewrite of server-local addresses is disabled (--norewrite on).\n"
-msgstr ""
-"  P?episov?n? adres m?stn?ch na serveru je zak?z?no (--norewrite zapnuto).\n"
+msgstr "  P?episov?n? adres m?stn?ch na serveru je zak?z?no (--norewrite zapnuto).\n"
 
 #: fetchmail.c:1702
 msgid "  Carriage-return stripping is enabled (stripcr on).\n"
@@ -1315,16 +1262,12 @@
 msgstr "  Vynucen? CR je zak?z?no (forcecr vypnuto).\n"
 
 #: fetchmail.c:1708
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
-msgstr ""
-"  Interpretace Content-Transfer-Encoding je zak?z?na (pass8bits zapnuto).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
+msgstr "  Interpretace Content-Transfer-Encoding je zak?z?na (pass8bits zapnuto).\n"
 
 #: fetchmail.c:1709
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
-msgstr ""
-"  Interpretace Content-Transfer-Encoding je povolena (pass8bits vypnuto).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
+msgstr "  Interpretace Content-Transfer-Encoding je povolena (pass8bits vypnuto).\n"
 
 #: fetchmail.c:1711
 msgid "  MIME decoding is enabled (mimedecode on).\n"
@@ -1456,8 +1399,7 @@
 #: fetchmail.c:1803
 #, c-format
 msgid "  Address to be put in RCPT TO lines shipped to SMTP will be %s\n"
-msgstr ""
-"  Adresa, kterou vkl?dat v ??dc?ch RCPT TO pos?lan?ch v SMTP, bude %s\n"
+msgstr "  Adresa, kterou vkl?dat v ??dc?ch RCPT TO pos?lan?ch v SMTP, bude %s\n"
 
 #: fetchmail.c:1812
 msgid "  Recognized listener spam block responses are:"
@@ -1514,17 +1456,12 @@
 msgstr "  Vyhled?v?n? DNS jmen pro adresy spole?n?ch schr?nek je zak?z?no.\n"
 
 #: fetchmail.c:1866
-msgid ""
-"  Server aliases will be compared with multidrop addresses by IP address.\n"
-msgstr ""
-"  P?ezd?vky serveru budou porovn?v?ny s adresami spole?n?ch schr?nek podle "
-"IP adres.\n"
+msgid "  Server aliases will be compared with multidrop addresses by IP address.\n"
+msgstr "  P?ezd?vky serveru budou porovn?v?ny s adresami spole?n?ch schr?nek podle IP adres.\n"
 
 #: fetchmail.c:1868
 msgid "  Server aliases will be compared with multidrop addresses by name.\n"
-msgstr ""
-"  P?ezd?vky serveru budou porovn?v?ny s adresami spole?n?ch schr?nek podle "
-"n?zvu.\n"
+msgstr "  P?ezd?vky serveru budou porovn?v?ny s adresami spole?n?ch schr?nek podle n?zvu.\n"
 
 #: fetchmail.c:1871
 msgid "  Envelope-address routing is disabled\n"
@@ -1578,8 +1515,7 @@
 #: fetchmail.c:1919
 #, c-format
 msgid "  Server connections will be made via plugin %s (--plugin %s).\n"
-msgstr ""
-"  P?ipojen? k serveru budou navazov?ny z?suvn?m modulem %s (--plugin %s).\n"
+msgstr "  P?ipojen? k serveru budou navazov?ny z?suvn?m modulem %s (--plugin %s).\n"
 
 #: fetchmail.c:1921
 msgid "  No plugin command specified.\n"
@@ -1588,9 +1524,7 @@
 #: fetchmail.c:1923
 #, c-format
 msgid "  Listener connections will be made via plugout %s (--plugout %s).\n"
-msgstr ""
-"  P?ipojen? k poslucha?i budou navazov?ny z?suvn?m modulem %s (--plugout %"
-"s).\n"
+msgstr "  P?ipojen? k poslucha?i budou navazov?ny z?suvn?m modulem %s (--plugout %s).\n"
 
 #: fetchmail.c:1925
 msgid "  No plugout command specified.\n"
@@ -1607,15 +1541,13 @@
 
 #: fetchmail.c:1947
 msgid "  Poll trace information will be added to the Received header.\n"
-msgstr ""
-"  Informace pro sledov?n? stahov?n? budou p?id?ny do hlavi?ky Received.\n"
+msgstr "  Informace pro sledov?n? stahov?n? budou p?id?ny do hlavi?ky Received.\n"
 
 #: fetchmail.c:1949
 msgid ""
 "  No poll trace information will be added to the Received header.\n"
 ".\n"
-msgstr ""
-"  Informace pro sledov?n? stahov?n? nebudou p?id?ny do hlavi?ky Received.\n"
+msgstr "  Informace pro sledov?n? stahov?n? nebudou p?id?ny do hlavi?ky Received.\n"
 
 #: fetchmail.c:1952
 #, c-format
@@ -1790,10 +1722,8 @@
 msgstr "%u je prvn? nep?e?ten?\n"
 
 #: imap.c:1002
-msgid ""
-"Warning: ignoring bogus data for message sizes returned by the server.\n"
-msgstr ""
-"Varov?n?: ignoruji chybn? informace o?velikostech zpr?v vr?cen? serverem.\n"
+msgid "Warning: ignoring bogus data for message sizes returned by the server.\n"
+msgstr "Varov?n?: ignoruji chybn? informace o?velikostech zpr?v vr?cen? serverem.\n"
 
 #: interface.c:256
 msgid "Unable to open kvm interface. Make sure fetchmail is SGID kmem."
@@ -2062,17 +1992,12 @@
 msgstr "  -L, --logfile     n?zev souboru se z?znamem\n"
 
 #: options.c:613
-msgid ""
-"      --syslog      use syslog(3) for most messages when running as a "
-"daemon\n"
-msgstr ""
-"      --syslog      pou??vat syslog(3) pro v?t?inu zpr?v p?i b?hu jako "
-"d?mon\n"
+msgid "      --syslog      use syslog(3) for most messages when running as a daemon\n"
+msgstr "      --syslog      pou??vat syslog(3) pro v?t?inu zpr?v p?i b?hu jako d?mon\n"
 
 #: options.c:614
 msgid "      --invisible   don't write Received & enable host spoofing\n"
-msgstr ""
-"      --invisible   nezapisovat Received a povolit podvr?en? po??ta?e\n"
+msgstr "      --invisible   nezapisovat Received a povolit podvr?en? po??ta?e\n"
 
 #: options.c:615
 msgid "  -f, --fetchmailrc specify alternate run control file\n"
@@ -2092,22 +2017,15 @@
 
 #: options.c:619
 msgid "      --nobounce    redirect bounces from user to postmaster.\n"
-msgstr ""
-"      --nobounce    p?esm?rovat vracen? zpr?vy od u?ivatele postmasterovi.\n"
+msgstr "      --nobounce    p?esm?rovat vracen? zpr?vy od u?ivatele postmasterovi.\n"
 
 #: options.c:620
-msgid ""
-"      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
-msgstr ""
-"      --nosoftbounce fetchmail bude mazat trvale nedoru?iteln? zpr?vy.\n"
+msgid "      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
+msgstr "      --nosoftbounce fetchmail bude mazat trvale nedoru?iteln? zpr?vy.\n"
 
 #: options.c:621
-msgid ""
-"      --softbounce  keep permanently undeliverable messages on server "
-"(default).\n"
-msgstr ""
-"      --softbounce  ponechat trvale nedoru?iteln? zpr?vy na serveru "
-"(implicitn?).\n"
+msgid "      --softbounce  keep permanently undeliverable messages on server (default).\n"
+msgstr "      --softbounce  ponechat trvale nedoru?iteln? zpr?vy na serveru (implicitn?).\n"
 
 #: options.c:623
 msgid "  -I, --interface   interface required specification\n"
@@ -2138,17 +2056,12 @@
 msgstr "      --sslcertpath cesta k certifik?t?m ssl\n"
 
 #: options.c:632
-msgid ""
-"      --sslcommonname  expect this CommonName from server (discouraged)\n"
-msgstr ""
-"      --sslcommonname  od serveru o?ek?vat tento CommonName (nedoporu?eno)\n"
+msgid "      --sslcommonname  expect this CommonName from server (discouraged)\n"
+msgstr "      --sslcommonname  od serveru o?ek?vat teto obecn? jm?no (CN) (nedoporu?eno)\n"
 
 #: options.c:633
-msgid ""
-"      --sslfingerprint fingerprint that must match that of the server's "
-"cert.\n"
-msgstr ""
-"      --sslfingerprint otisk, kter? mus? odpov?dat certifik?tu serveru.\n"
+msgid "      --sslfingerprint fingerprint that must match that of the server's cert.\n"
+msgstr "      --sslfingerprint otisk, kter? mus? odpov?dat certifik?tu serveru.\n"
 
 #: options.c:634
 msgid "      --sslproto    force ssl protocol (SSL2/SSL3/TLS1)\n"
@@ -2172,15 +2085,11 @@
 
 #: options.c:641
 msgid "      --port        TCP port to connect to (obsolete, use --service)\n"
-msgstr ""
-"      --port        TCP port, kam se p?ipojovat (zastaral?, pou?ijte --"
-"service)\n"
+msgstr "      --port        TCP port, kam se p?ipojovat (zastaral?, pou?ijte --service)\n"
 
 #: options.c:642
-msgid ""
-"  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
-msgstr ""
-"  -P, --service     TCP slu?ba, kam se p?ipojit (sm? b?t ??seln? TCP port)\n"
+msgid "  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
+msgstr "  -P, --service     TCP slu?ba, kam se p?ipojit (sm? b?t ??seln? TCP port)\n"
 
 #: options.c:643
 msgid "      --auth        authentication type (password/kerberos/ssh/otp)\n"
@@ -2196,8 +2105,7 @@
 
 #: options.c:646
 msgid "  -Q, --qvirtual    prefix to remove from local user id\n"
-msgstr ""
-"  -Q, --qvirtual    p?edpona, kterou odstranit z m?stn?ho id u?ivatel?\n"
+msgstr "  -Q, --qvirtual    p?edpona, kterou odstranit z m?stn?ho id u?ivatel?\n"
 
 #: options.c:647
 msgid "      --principal   mail service principal\n"
@@ -2205,9 +2113,7 @@
 
 #: options.c:648
 msgid "      --tracepolls  add poll-tracing information to Received header\n"
-msgstr ""
-"      --tracepolls  p?idat informace pro sledov?n? stahov?n? do hlavi?ky "
-"Received\n"
+msgstr "      --tracepolls  p?idat informace pro sledov?n? stahov?n? do hlavi?ky Received\n"
 
 #: options.c:650
 msgid "  -u, --username    specify users's login on server\n"
@@ -2283,8 +2189,7 @@
 
 #: options.c:669
 msgid "  -e, --expunge     set max deletions between expunges\n"
-msgstr ""
-"  -e, --expunge     nastavit maxim?ln? po?et odstra?ov?n? mezi ?i?t?n?mi\n"
+msgstr "  -e, --expunge     nastavit maxim?ln? po?et odstra?ov?n? mezi ?i?t?n?mi\n"
 
 #: options.c:670
 msgid "  -m, --mda         set MDA to use for forwarding\n"
@@ -2304,16 +2209,11 @@
 
 #: options.c:674
 msgid "      --showdots    show progress dots even in logfiles\n"
-msgstr ""
-"      --showdots    zobrazovat te?ky pr?b?hu i v souborech se z?znamy\n"
+msgstr "      --showdots    zobrazovat te?ky pr?b?hu i v souborech se z?znamy\n"
 
 #: pop3.c:355
-msgid ""
-"Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead "
-"of TOP.\n"
-msgstr ""
-"VAROV?N?: Nalezen ?Maillennium POP3/PROXY server?, pou?iji p??kaz RETR "
-"nam?sto TOP.\n"
+msgid "Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead of TOP.\n"
+msgstr "VAROV?N?: Nalezen ?Maillennium POP3/PROXY server?, pou?iji p??kaz RETR nam?sto TOP.\n"
 
 #: pop3.c:454
 msgid "TLS is mandatory for this session, but server refused CAPA command.\n"
@@ -2330,8 +2230,7 @@
 
 #: pop3.c:646
 msgid "We've run out of allowed authenticators and cannot continue.\n"
-msgstr ""
-"Vy?erpali jsme v?echny povolen? autentik?tory, a tak nem??eme pokra?ovat.\n"
+msgstr "Vy?erpali jsme v?echny povolen? autentik?tory, a tak nem??eme pokra?ovat.\n"
 
 #: pop3.c:660
 msgid "Required APOP timestamp not found in greeting\n"
@@ -2396,19 +2295,12 @@
 msgstr "SDPS nen? povoleno."
 
 #: rcfile_y.y:215
-msgid ""
-"fetchmail: interface option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: p?ep?na? interface je podporov?n jen v Linuxu (bez IPv6) a "
-"FreeBSD\n"
+msgid "fetchmail: interface option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: p?ep?na? interface je podporov?n jen v Linuxu (bez IPv6) a FreeBSD\n"
 
 #: rcfile_y.y:222
-msgid ""
-"fetchmail: monitor option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: p?ep?na? monitor je podporov?n jen v Linuxu (bez IPv6) a FreeBSD\n"
+msgid "fetchmail: monitor option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: p?ep?na? monitor je podporov?n jen v Linuxu (bez IPv6) a FreeBSD\n"
 
 #: rcfile_y.y:335
 msgid "SSL is not enabled"
@@ -2739,8 +2631,7 @@
 
 #: sink.c:1373
 #, c-format
-msgid ""
-"Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
+msgid "Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
 msgstr "Z?hada: MDA?pclose vr?til %d a errno %d/%s, nezle zpracovat v?%s:%d\n"
 
 #: sink.c:1395
@@ -2876,44 +2767,42 @@
 #: socket.c:623
 #, c-format
 msgid "Issuer CommonName: %s\n"
-msgstr "Jm?no vydavatele: %s\n"
+msgstr "Obecn? jm?no (CN) vydavatele: %s\n"
 
 #: socket.c:626
 msgid "Warning: Issuer CommonName too long (possibly truncated).\n"
-msgstr "Varov?n?: Jm?no vydavatele p??li? dlouh? (mo?n? zkr?ceno).\n"
+msgstr "Varov?n?: Obecn? jm?no (CN) vydavatele je p??li? dlouh? (mo?n? zkr?ceno).\n"
 
 #: socket.c:628
 msgid "Unknown Issuer CommonName\n"
-msgstr "Nezn?m? jm?no vydavatele\n"
+msgstr "Nezn?m? obecn? jm?no (CN) vydavatele\n"
 
 #: socket.c:632
 #, c-format
 msgid "Server CommonName: %s\n"
-msgstr "Jm?no serveru: %s\n"
+msgstr "Obecn? jm?no (CN) serveru: %s\n"
 
 #: socket.c:637
 msgid "Bad certificate: Subject CommonName too long!\n"
-msgstr "?patn? certifik?t: Jm?no p?edm?tu p??li? dlouh?!\n"
+msgstr "?patn? certifik?t: Obecn? jm?no (CN) subjektu je p??li? dlouh?!\n"
 
 #: socket.c:643
-#, fuzzy
 msgid "Bad certificate: Subject CommonName contains NUL, aborting!\n"
-msgstr "?patn? certifik?t: Jm?no p?edm?tu p??li? dlouh?!\n"
+msgstr "?patn? certifik?t: Obecn? jm?no subjektu obsahuje NUL, zru?uje se!\n"
 
 #: socket.c:664
 #, c-format
 msgid "Subject Alternative Name: %s\n"
-msgstr ""
+msgstr "Alternativn? jm?no subjektu: %s\n"
 
 #: socket.c:670
-#, fuzzy
 msgid "Bad certificate: Subject Alternative Name contains NUL, aborting!\n"
-msgstr "?patn? certifik?t: Jm?no p?edm?tu p??li? dlouh?!\n"
+msgstr "?patn? certifik?t: Alternativn? jm?no subjektu obsahuje NUL, zru?uje se!\n"
 
 #: socket.c:698
 #, c-format
 msgid "Server CommonName mismatch: %s != %s\n"
-msgstr "Jm?no serveru neodpov?d?: %s != %s\n"
+msgstr "Obecn? jm?no (CN) serveru neodpov?d?: %s != %s\n"
 
 #: socket.c:705
 msgid "Server name not set, could not verify certificate!\n"
@@ -2921,7 +2810,7 @@
 
 #: socket.c:710
 msgid "Unknown Server CommonName\n"
-msgstr "Nezn?m? jm?no serveru\n"
+msgstr "Nezn?m? obecn? jm?no (CN) serveru\n"
 
 #: socket.c:712
 msgid "Server name not specified in certificate!\n"
@@ -2969,7 +2858,7 @@
 msgstr "Deskriptor souboru mimo rozsah pro SSL"
 
 #: socket.c:866
-#, fuzzy, c-format
+#, c-format
 msgid "Invalid SSL protocol '%s' specified, using default (SSLv23).\n"
 msgstr "Zad?n neplatn? protokol SSL `%s', pou??v?m implicitn? (SSLv23).\n"
 
@@ -3122,8 +3011,7 @@
 #: uid.c:645
 #, c-format
 msgid "Error writing to fetchids file %s, old file left in place.\n"
-msgstr ""
-"Chyba p?i z?pisu do souboru fetchids %s, star? soubor ponech?n na m?st?.\n"
+msgstr "Chyba p?i z?pisu do souboru fetchids %s, star? soubor ponech?n na m?st?.\n"
 
 #: uid.c:649
 #, c-format



From svn at mknod.org  Thu Aug  6 13:35:50 2009
From: svn at mknod.org (svn at mknod.org)
Date: Thu,  6 Aug 2009 06:35:50 -0500
Subject: [fetchmail-svn] r5407 - in branches/BRANCH_6-3: . po
Message-ID: <20090806113550.18D7E21F3F1@mknod.org>

Author: m-a
Date: 2009-08-06 06:35:49 -0500 (Thu, 06 Aug 2009)
New Revision: 5407

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/po/ja.po
Log:
Update Japanese translation for 6.3.11, courtesy of Takeshi Hamasaki.

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-06 09:15:42 UTC (rev 5406)
+++ branches/BRANCH_6-3/NEWS	2009-08-06 11:35:49 UTC (rev 5407)
@@ -53,6 +53,7 @@
 
 # TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
 * [cs]    Czech (Petr Pisar)
+* [ja]    Japanese (Takeshi Hamasaki)
 
 
 fetchmail 6.3.11 (released 2009-08-06):

Modified: branches/BRANCH_6-3/po/ja.po
===================================================================
--- branches/BRANCH_6-3/po/ja.po	2009-08-06 09:15:42 UTC (rev 5406)
+++ branches/BRANCH_6-3/po/ja.po	2009-08-06 11:35:49 UTC (rev 5407)
@@ -7,10 +7,10 @@
 #
 msgid ""
 msgstr ""
-"Project-Id-Version: fetchmail 6.3.10-pre1\n"
+"Project-Id-Version: fetchmail 6.3.11\n"
 "Report-Msgid-Bugs-To: fetchmail-devel at lists.berlios.de\n"
 "POT-Creation-Date: 2009-08-06 01:21+0200\n"
-"PO-Revision-Date: 2009-05-26 20:20+0700\n"
+"PO-Revision-Date: 2009-08-06 16:55+0700\n"
 "Last-Translator: Takeshi Hamasaki <hmatrjp at users.sourceforge.jp>\n"
 "Language-Team: Japanese <translation-team-ja at lists.sourceforge.net>\n"
 "MIME-Version: 1.0\n"
@@ -67,31 +67,24 @@
 #: driver.c:339
 #, c-format
 msgid "The following oversized messages were deleted on server %s account %s:"
-msgstr ""
-"???????????????????????? %s ????? %s ?????"
-"??? :"
+msgstr "???????????????????????? %s ????? %s ???????? :"
 
 #: driver.c:343
 #, c-format
 msgid "The following oversized messages remain on server %s account %s:"
-msgstr ""
-"???????????????????????? %s ????? %s ?????"
-"?? :"
+msgstr "???????????????????????? %s ????? %s ??????? :"
 
 #: driver.c:362
 #, c-format
 msgid "  %d message  %d octets long deleted by fetchmail."
 msgid_plural "  %d messages %d octets long deleted by fetchmail."
-msgstr[0] ""
-"fetchmail ? %d ???????(%d bytes ????????)????????"
+msgstr[0] "fetchmail ? %d ???????(%d bytes ????????)????????"
 
 #: driver.c:367
 #, c-format
 msgid "  %d message  %d octets long skipped by fetchmail."
 msgid_plural "  %d messages %d octets long skipped by fetchmail."
-msgstr[0] ""
-"fetchmail ? %d ???????(%d ??? ????????)????????"
-"??"
+msgstr[0] "fetchmail ? %d ???????(%d ??? ????????)??????????"
 
 #: driver.c:511
 #, c-format
@@ -101,8 +94,7 @@
 #: driver.c:565
 #, c-format
 msgid "skipping message %s@%s:%d (%d octets)"
-msgstr ""
-"%s@%s ????? %d ???????? (%d ???) ???????????"
+msgstr "%s@%s ????? %d ???????? (%d ???) ???????????"
 
 #: driver.c:581
 msgid " (length -1)"
@@ -115,9 +107,7 @@
 #: driver.c:602
 #, c-format
 msgid "couldn't fetch headers, message %s@%s:%d (%d octets)\n"
-msgstr ""
-"%s@%s ????? %d ????????(%d ???) ??????????????"
-"??\n"
+msgstr "%s@%s ????? %d ????????(%d ???) ????????????????\n"
 
 #: driver.c:619
 #, c-format
@@ -141,11 +131,8 @@
 
 #: driver.c:751
 #, c-format
-msgid ""
-"message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
-msgstr ""
-"%s@%s ????? %d ?????????????????? (%d (??) != %d (?"
-"?)) \n"
+msgid "message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
+msgstr "%s@%s ????? %d ?????????????????? (%d (??) != %d (??)) \n"
 
 #: driver.c:783
 msgid " retained\n"
@@ -162,11 +149,8 @@
 #: driver.c:828
 #, c-format
 msgid "fetchlimit %d reached; %d message left on server %s account %s\n"
-msgid_plural ""
-"fetchlimit %d reached; %d messages left on server %s account %s\n"
-msgstr[0] ""
-"?????????? %d ???????; ?????? %d ????? %s ???"
-"??? %s ??????????\n"
+msgid_plural "fetchlimit %d reached; %d messages left on server %s account %s\n"
+msgstr[0] "?????????? %d ???????; ?????? %d ????? %s ?????? %s ??????????\n"
 
 #: driver.c:885
 #, c-format
@@ -186,8 +170,7 @@
 #: driver.c:898
 #, c-format
 msgid "timeout after %d seconds waiting for listener to respond.\n"
-msgstr ""
-"????????????? %d ????????????????????\n"
+msgstr "????????????? %d ????????????????????\n"
 
 #: driver.c:901
 #, c-format
@@ -200,12 +183,8 @@
 
 #: driver.c:916
 #, c-format
-msgid ""
-"Fetchmail saw more than %d timeouts while attempting to get mail from %s@%"
-"s.\n"
-msgstr ""
-"Fetchmail ???? %d ????%s@%s ????????????????????"
-"??????????????\n"
+msgid "Fetchmail saw more than %d timeouts while attempting to get mail from %s@%s.\n"
+msgstr "Fetchmail ???? %d ????%s@%s ??????????????????????????????????\n"
 
 #: driver.c:920
 msgid ""
@@ -231,9 +210,7 @@
 #: driver.c:949
 #, c-format
 msgid "pre-connection command failed with status %d\n"
-msgstr ""
-"????????????????????????? %d ?????????"
-"??\n"
+msgstr "????????????????????????? %d ???????????\n"
 
 #: driver.c:973
 #, c-format
@@ -340,10 +317,8 @@
 "is restored."
 msgstr ""
 "??????????\n"
-"??????????????????????????????????????"
-"??? login ???????????????????????????\n"
-"fetchmail ???????????????????? ????????????"
-"??\n"
+"????????????????????????????????????????? login ???????????????????????????\n"
+"fetchmail ???????????????????? ??????????????\n"
 "\n"
 "fetchmail ????????????????\n"
 "????????????????????????????????"
@@ -371,8 +346,7 @@
 #: driver.c:1279
 #, c-format
 msgid "Fetchmail was able to log into %s@%s.\n"
-msgstr ""
-"%s@%s ????????? fetchmail ?????????????????\n"
+msgstr "%s@%s ????????? fetchmail ?????????????????\n"
 
 #: driver.c:1283
 msgid "Service has been restored.\n"
@@ -381,14 +355,11 @@
 #: driver.c:1315
 #, c-format
 msgid "selecting or re-polling folder %s\n"
-msgstr ""
-"?????????????????????? %s ???????????\n"
+msgstr "?????????????????????? %s ???????????\n"
 
 #: driver.c:1317
 msgid "selecting or re-polling default folder\n"
-msgstr ""
-"?????????????????????????????????????"
-"??\n"
+msgstr "???????????????????????????????????????\n"
 
 #: driver.c:1329
 #, c-format
@@ -475,9 +446,7 @@
 #: driver.c:1567
 #, c-format
 msgid "%s error while fetching from %s@%s and delivering to SMTP host %s\n"
-msgstr ""
-"%s???????????%s@%s????????? SMTP ??? %s ???????"
-"???????\n"
+msgstr "%s???????????%s@%s????????? SMTP ??? %s ??????????????\n"
 
 #: driver.c:1569
 msgid "unknown"
@@ -541,24 +510,20 @@
 msgid ""
 "%s: The NULLMAILER_FLAGS environment variable is set.\n"
 "This is dangerous as it can make nullmailer-inject or nullmailer's\n"
-"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: "
-"headers.\n"
+"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: headers.\n"
 "Try \"env NULLMAILER_FLAGS= %s YOUR ARGUMENTS HERE\"\n"
 "%s: Abort.\n"
 msgstr ""
 "%s: NULLMAILER_FLAGS ??????????????\n"
 "nullmailer-inject ? nullmailer ? senmail wrapper ????\n"
-"???? From: ? Message-ID:?Return-Path: ????????????????"
-"???\n"
-"\"env NULLMAILER_FLAGS= %s (????????????????)\" ?????"
-"??\n"
+"???? From: ? Message-ID:?Return-Path: ???????????????????\n"
+"\"env NULLMAILER_FLAGS= %s (????????????????)\" ???????\n"
 "%s: ??????\n"
 
 #: env.c:83
 #, c-format
 msgid "%s: You don't exist.  Go away.\n"
-msgstr ""
-"%s: ?????????????????????????????????\n"
+msgstr "%s: ?????????????????????????????????\n"
 
 #: env.c:145
 #, c-format
@@ -577,13 +542,11 @@
 #: env.c:174
 msgid ""
 "Trying to continue with unqualified hostname.\n"
-"DO NOT report broken Received: headers, HELO/EHLO lines or similar "
-"problems!\n"
+"DO NOT report broken Received: headers, HELO/EHLO lines or similar problems!\n"
 "DO repair your /etc/hosts, DNS, NIS or LDAP instead.\n"
 msgstr ""
 "????????????????\n"
-"Received: ???, HELO/EHLO ????????????????????????"
-"??????????????\n"
+"Received: ???, HELO/EHLO ??????????????????????????????????????\n"
 "/etc/hosts, DNS, NIS ??? LDAP ?????????????\n"
 
 #: etrn.c:49 odmr.c:60
@@ -653,14 +616,12 @@
 #: fetchmail.c:137
 msgid ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham Wilson\n"
 "Copyright (C) 2005 - 2006 Sunil Shetye\n"
 "Copyright (C) 2005 - 2009 Matthias Andree\n"
 msgstr ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham Wilson\n"
 "Copyright (C) 2005 - 2006 Sunil Shetye\n"
 "Copyright (C) 2005 - 2009 Matthias Andree\n"
 
@@ -732,20 +693,13 @@
 msgstr "fetchmail: %s fetchmail (PID=%d) ????????\n"
 
 #: fetchmail.c:480
-msgid ""
-"fetchmail: can't check mail while another fetchmail to same host is "
-"running.\n"
-msgstr ""
-"fetchmail: ??????????? fetchmail ????????????????"
-"??????\n"
+msgid "fetchmail: can't check mail while another fetchmail to same host is running.\n"
+msgstr "fetchmail: ??????????? fetchmail ??????????????????????\n"
 
 #: fetchmail.c:486
 #, c-format
-msgid ""
-"fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
-msgstr ""
-"fetchmail: ?? fetchmail (PID=%d) ?????????????????????"
-"???\n"
+msgid "fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
+msgstr "fetchmail: ?? fetchmail (PID=%d) ????????????????????????\n"
 
 #: fetchmail.c:493
 #, c-format
@@ -753,23 +707,18 @@
 msgstr "fetchmail: ?? fetchmail (PID=%d) ???????????????\n"
 
 #: fetchmail.c:503
-msgid ""
-"fetchmail: can't accept options while a background fetchmail is running.\n"
-msgstr ""
-"fetchmail: ????????? fetchmail ??????????????????"
-"?????\n"
+msgid "fetchmail: can't accept options while a background fetchmail is running.\n"
+msgstr "fetchmail: ????????? fetchmail ???????????????????????\n"
 
 #: fetchmail.c:509
 #, c-format
 msgid "fetchmail: background fetchmail at %d awakened.\n"
-msgstr ""
-"fetchmail: ????????? fetchmail (PID=%d) ???????????\n"
+msgstr "fetchmail: ????????? fetchmail (PID=%d) ???????????\n"
 
 #: fetchmail.c:521
 #, c-format
 msgid "fetchmail: elder sibling at %d died mysteriously.\n"
-msgstr ""
-"fetchmail: ????????? fetchmail (PID=%d) ??????????\n"
+msgstr "fetchmail: ????????? fetchmail (PID=%d) ??????????\n"
 
 #: fetchmail.c:536
 #, c-format
@@ -797,9 +746,7 @@
 
 #: fetchmail.c:606
 msgid "fetchmail: Warning: syslog and logfile are set. Check both for logs!\n"
-msgstr ""
-"fetchmail: ?? : syslog ??????????????????????????"
-"????\n"
+msgstr "fetchmail: ?? : syslog ??????????????????????????????\n"
 
 #: fetchmail.c:625
 msgid "--check mode enabled, not fetching mail\n"
@@ -934,8 +881,7 @@
 
 #: fetchmail.c:1102
 msgid "fetchmail: Error: multiple \"defaults\" records in config file.\n"
-msgstr ""
-"fetchmail: ??? : ???????? \"defaults\" ???????????\n"
+msgstr "fetchmail: ??? : ???????? \"defaults\" ???????????\n"
 
 #: fetchmail.c:1224
 msgid "SSL support is not compiled in.\n"
@@ -943,69 +889,48 @@
 
 #: fetchmail.c:1231
 msgid "KERBEROS v4 support is configured, but not compiled in.\n"
-msgstr ""
-"KERBEROS v4 ???????????????????????????????"
-"??\n"
+msgstr "KERBEROS v4 ?????????????????????????????????\n"
 
 #: fetchmail.c:1237
 msgid "KERBEROS v5 support is configured, but not compiled in.\n"
-msgstr ""
-"KERBEROS v5 ???????????????????????????????"
-"??\n"
+msgstr "KERBEROS v5 ?????????????????????????????????\n"
 
 #: fetchmail.c:1243
 msgid "GSSAPI support is configured, but not compiled in.\n"
-msgstr ""
-"GSSAPI ?????????????????????????????????\n"
+msgstr "GSSAPI ?????????????????????????????????\n"
 
 #: fetchmail.c:1273
 #, c-format
-msgid ""
-"fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
-msgstr ""
-"fetchmail: ?? : %s ?? multidrop fetch ???????? DNS ???????"
-"???\n"
+msgid "fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
+msgstr "fetchmail: ?? : %s ?? multidrop fetch ???????? DNS ??????????\n"
 
 #: fetchmail.c:1284
 #, c-format
 msgid "warning: multidrop for %s requires envelope option!\n"
-msgstr ""
-"??: %s ??????????????????????????????!\n"
+msgstr "??: %s ??????????????????????????????!\n"
 
 #: fetchmail.c:1285
 msgid "warning: Do not ask for support if all mail goes to postmaster!\n"
-msgstr ""
-"??: ???????? postmaster ????????????????????"
-"?!\n"
+msgstr "??: ???????? postmaster ?????????????????????!\n"
 
 #: fetchmail.c:1302
 #, c-format
-msgid ""
-"fetchmail: %s configuration invalid, specify positive port number for "
-"service or port\n"
-msgstr ""
-"fetchmail: ??? %s ????????????????????????????"
-"?????\n"
+msgid "fetchmail: %s configuration invalid, specify positive port number for service or port\n"
+msgstr "fetchmail: ??? %s ?????????????????????????????????\n"
 
 #: fetchmail.c:1309
 #, c-format
 msgid "fetchmail: %s configuration invalid, RPOP requires a privileged port\n"
-msgstr ""
-"fetchmail: ??? %s ????????? RPOP ?? privileged port ?????"
-"????????\n"
+msgstr "fetchmail: ??? %s ????????? RPOP ?? privileged port ?????????????\n"
 
 #: fetchmail.c:1327
 #, c-format
 msgid "%s configuration invalid, LMTP can't use default SMTP port\n"
-msgstr ""
-"??? %s ?????????LMTP ??????? SMTP ??????????"
-"??\n"
+msgstr "??? %s ?????????LMTP ??????? SMTP ????????????\n"
 
 #: fetchmail.c:1341
 msgid "Both fetchall and keep on in daemon or idle mode is a mistake!\n"
-msgstr ""
-"fetchall ? keep ??????????????????????????????"
-"??\n"
+msgstr "fetchall ? keep ????????????????????????????????\n"
 
 #: fetchmail.c:1366
 #, c-format
@@ -1015,9 +940,7 @@
 #: fetchmail.c:1439
 #, c-format
 msgid "%s querying %s (protocol %s) at %s: poll started\n"
-msgstr ""
-"%s ? %s ?????? %s ???? %s ??????????????????"
-"??\n"
+msgstr "%s ? %s ?????? %s ???? %s ????????????????????\n"
 
 #: fetchmail.c:1464
 msgid "POP2 support is not configured.\n"
@@ -1046,8 +969,7 @@
 #: fetchmail.c:1517
 #, c-format
 msgid "%s querying %s (protocol %s) at %s: poll completed\n"
-msgstr ""
-"%s ? %s ?????? %s ???? %s ???????????????????\n"
+msgstr "%s ? %s ?????? %s ???? %s ???????????????????\n"
 
 #: fetchmail.c:1534
 #, c-format
@@ -1091,15 +1013,11 @@
 
 #: fetchmail.c:1557
 msgid "Fetchmail will treat permanent errors as permanent (drop messsages).\n"
-msgstr ""
-"Fetchmail ???????????????????????????????"
-"???\n"
+msgstr "Fetchmail ??????????????????????????????????\n"
 
 #: fetchmail.c:1559
 msgid "Fetchmail will treat permanent errors as temporary (keep messages).\n"
-msgstr ""
-"Fetchmail ???????????????????????????????"
-"???\n"
+msgstr "Fetchmail ??????????????????????????????????\n"
 
 #: fetchmail.c:1566
 #, c-format
@@ -1283,23 +1201,16 @@
 msgstr "  ???????????????????? (--flush on)\n"
 
 #: fetchmail.c:1694
-msgid ""
-"  Old messages will not be flushed before message retrieval (--flush off).\n"
+msgid "  Old messages will not be flushed before message retrieval (--flush off).\n"
 msgstr "  ????????????????????????? (--flush off)\n"
 
 #: fetchmail.c:1696
-msgid ""
-"  Oversized messages will be flushed before message retrieval (--limitflush "
-"on).\n"
+msgid "  Oversized messages will be flushed before message retrieval (--limitflush on).\n"
 msgstr "  ???????????????????????? (--limitflush on)\n"
 
 #: fetchmail.c:1697
-msgid ""
-"  Oversized messages will not be flushed before message retrieval (--"
-"limitflush off).\n"
-msgstr ""
-"  ????????????????????????????? (--limitflush "
-"off)\n"
+msgid "  Oversized messages will not be flushed before message retrieval (--limitflush off).\n"
+msgstr "  ????????????????????????????? (--limitflush off)\n"
 
 #: fetchmail.c:1699
 msgid "  Rewrite of server-local addresses is enabled (--norewrite off).\n"
@@ -1326,13 +1237,11 @@
 msgstr "  ?????????????? (forcecr off)\n"
 
 #: fetchmail.c:1708
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
 msgstr "  Content-Transfer-Encoding ?????????? (pass8bits on)\n"
 
 #: fetchmail.c:1709
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
 msgstr "  Content-Transfer-Encoding ????????? (pass8bits off)\n"
 
 #: fetchmail.c:1711
@@ -1379,30 +1288,25 @@
 #: fetchmail.c:1730
 #, c-format
 msgid "  Message size warning interval is %d seconds (--warnings %d).\n"
-msgstr ""
-"  ???????????????? %d ????????? (--warnings %d)\n"
+msgstr "  ???????????????? %d ????????? (--warnings %d)\n"
 
 #: fetchmail.c:1733
 msgid "  Size warnings on every poll (--warnings 0).\n"
-msgstr ""
-"  ???????????????????????????? (--warnings 0)\n"
+msgstr "  ???????????????????????????? (--warnings 0)\n"
 
 #: fetchmail.c:1736
 #, c-format
 msgid "  Received-message limit is %d (--fetchlimit %d).\n"
-msgstr ""
-"  ????????????????? %d ?????????(--fetchlimit %d)\n"
+msgstr "  ????????????????? %d ?????????(--fetchlimit %d)\n"
 
 #: fetchmail.c:1739
 msgid "  No received-message limit (--fetchlimit 0).\n"
-msgstr ""
-"  ???????????????????????????? (--fetchlimit 0)\n"
+msgstr "  ???????????????????????????? (--fetchlimit 0)\n"
 
 #: fetchmail.c:1741
 #, c-format
 msgid "  Fetch message size limit is %d (--fetchsizelimit %d).\n"
-msgstr ""
-"  ??????????????? %d ????????(--fetchsizelimit %d)\n"
+msgstr "  ??????????????? %d ????????(--fetchsizelimit %d)\n"
 
 #: fetchmail.c:1744
 msgid "  No fetch message size limit (--fetchsizelimit 0).\n"
@@ -1428,8 +1332,7 @@
 
 #: fetchmail.c:1757
 msgid "  No SMTP message batch limit (--batchlimit 0).\n"
-msgstr ""
-"  ???????????????????????????? (--batchlimit 0)\n"
+msgstr "  ???????????????????????????? (--batchlimit 0)\n"
 
 #: fetchmail.c:1761
 #, c-format
@@ -1526,8 +1429,7 @@
 msgstr "  multidrop ????????? DNS ??????\n"
 
 #: fetchmail.c:1866
-msgid ""
-"  Server aliases will be compared with multidrop addresses by IP address.\n"
+msgid "  Server aliases will be compared with multidrop addresses by IP address.\n"
 msgstr "  ??????? multidrop ????? IP ????????????\n"
 
 #: fetchmail.c:1868
@@ -1595,9 +1497,7 @@
 #: fetchmail.c:1923
 #, c-format
 msgid "  Listener connections will be made via plugout %s (--plugout %s).\n"
-msgstr ""
-"  ????????????????????\"%s\"???????(--plugout %"
-"s)\n"
+msgstr "  ????????????????????\"%s\"???????(--plugout %s)\n"
 
 #: fetchmail.c:1925
 msgid "  No plugout command specified.\n"
@@ -1731,8 +1631,7 @@
 
 #: imap.c:579
 msgid "Required OTP capability not compiled into fetchmail\n"
-msgstr ""
-"OTP ??????????fetchmail ? OTP ????????????????\n"
+msgstr "OTP ??????????fetchmail ? OTP ????????????????\n"
 
 #: imap.c:601 pop3.c:385
 msgid "Required NTLM capability not compiled into fetchmail\n"
@@ -1792,17 +1691,12 @@
 msgstr "%u ??????????????\n"
 
 #: imap.c:1002
-msgid ""
-"Warning: ignoring bogus data for message sizes returned by the server.\n"
-msgstr ""
-"??: ???????????????????????????????????"
-"???\n"
+msgid "Warning: ignoring bogus data for message sizes returned by the server.\n"
+msgstr "??: ??????????????????????????????????????\n"
 
 #: interface.c:256
 msgid "Unable to open kvm interface. Make sure fetchmail is SGID kmem."
-msgstr ""
-"kvm ??????????????????fetchmail ? SGID kmem ???????"
-"??????"
+msgstr "kvm ??????????????????fetchmail ? SGID kmem ?????????????"
 
 #: interface.c:396
 #, c-format
@@ -1885,8 +1779,7 @@
 #: kerberos.c:139
 #, c-format
 msgid "principal %s in ticket does not match -u %s\n"
-msgstr ""
-"Ticket ?????? %s ? -u ??????????? %s ????????\n"
+msgstr "Ticket ?????? %s ? -u ??????????? %s ????????\n"
 
 #: kerberos.c:147
 #, c-format
@@ -2041,8 +1934,7 @@
 
 #: options.c:606
 msgid "  -c, --check       check for messages without fetching\n"
-msgstr ""
-"  -c, --check       ?????????????(???????????)\n"
+msgstr "  -c, --check       ?????????????(???????????)\n"
 
 #: options.c:607
 msgid "  -s, --silent      work silently\n"
@@ -2069,9 +1961,7 @@
 msgstr "  -L, --logfile     ?????????????????\n"
 
 #: options.c:613
-msgid ""
-"      --syslog      use syslog(3) for most messages when running as a "
-"daemon\n"
+msgid "      --syslog      use syslog(3) for most messages when running as a daemon\n"
 msgstr ""
 "      --syslog      ??????????????? syslog(3) ????\n"
 "                    ???????????????\n"
@@ -2101,19 +1991,12 @@
 msgstr "      --nobounce    ??????? postmaster ???????????\n"
 
 #: options.c:620
-msgid ""
-"      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
-msgstr ""
-"      --nosoftbounce fetchmail ?????????????????????"
-"??\n"
+msgid "      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
+msgstr "      --nosoftbounce fetchmail ???????????????????????\n"
 
 #: options.c:621
-msgid ""
-"      --softbounce  keep permanently undeliverable messages on server "
-"(default).\n"
-msgstr ""
-"      --softbounce   ??????????????????????????(?"
-"????).\n"
+msgid "      --softbounce  keep permanently undeliverable messages on server (default).\n"
+msgstr "      --softbounce   ??????????????????????????(?????).\n"
 
 #: options.c:623
 msgid "  -I, --interface   interface required specification\n"
@@ -2144,22 +2027,16 @@
 msgstr "      --sslcertpath SSL ? client certificate ??????????\n"
 
 #: options.c:632
-msgid ""
-"      --sslcommonname  expect this CommonName from server (discouraged)\n"
-msgstr ""
-"      --sslcommonname  ???? CommonName ????????????(????"
-"????)\n"
+msgid "      --sslcommonname  expect this CommonName from server (discouraged)\n"
+msgstr "      --sslcommonname  ???? CommonName ????????????(????????)\n"
 
 #: options.c:633
-msgid ""
-"      --sslfingerprint fingerprint that must match that of the server's "
-"cert.\n"
+msgid "      --sslfingerprint fingerprint that must match that of the server's cert.\n"
 msgstr "      --sslfingerprint ?????????????? fingerprint\n"
 
 #: options.c:634
 msgid "      --sslproto    force ssl protocol (SSL2/SSL3/TLS1)\n"
-msgstr ""
-"      --sslproto    SSL ???????????????? (SSL2/SSL3/TLS1)\n"
+msgstr "      --sslproto    SSL ???????????????? (SSL2/SSL3/TLS1)\n"
 
 #: options.c:636
 msgid "      --plugin      specify external command to open connection\n"
@@ -2167,8 +2044,7 @@
 
 #: options.c:637
 msgid "      --plugout     specify external command to open smtp connection\n"
-msgstr ""
-"      --plugout     SMTP ???????????????????????\n"
+msgstr "      --plugout     SMTP ???????????????????????\n"
 
 #: options.c:639
 msgid "  -p, --protocol    specify retrieval protocol (see man page)\n"
@@ -2182,16 +2058,11 @@
 
 #: options.c:641
 msgid "      --port        TCP port to connect to (obsolete, use --service)\n"
-msgstr ""
-"      --port        ??????? TCP ????????? (????????"
-"??--service ????????)\n"
+msgstr "      --port        ??????? TCP ????????? (??????????--service ????????)\n"
 
 #: options.c:642
-msgid ""
-"  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
-msgstr ""
-"  -P, --service     ???? TCP ????? (??? TCP ??????????"
-"?????)\n"
+msgid "  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
+msgstr "  -P, --service     ???? TCP ????? (??? TCP ???????????????)\n"
 
 #: options.c:643
 msgid "      --auth        authentication type (password/kerberos/ssh/otp)\n"
@@ -2251,8 +2122,7 @@
 
 #: options.c:658
 msgid "  -w, --warnings    interval between warning mail notification\n"
-msgstr ""
-"  -w, --warnings    ??????????????????????????\n"
+msgstr "  -w, --warnings    ??????????????????????????\n"
 
 #: options.c:660
 msgid "  -S, --smtphost    set SMTP forwarding host\n"
@@ -2260,8 +2130,7 @@
 
 #: options.c:661
 msgid "      --fetchdomains fetch mail for specified domains\n"
-msgstr ""
-"      --fetchdomains ??????????????????????????\n"
+msgstr "      --fetchdomains ??????????????????????????\n"
 
 #: options.c:662
 msgid "  -D, --smtpaddress set SMTP delivery domain to use\n"
@@ -2269,9 +2138,7 @@
 
 #: options.c:663
 msgid "      --smtpname    set SMTP full name username at domain\n"
-msgstr ""
-"      --smtpname    SMTP ???????????? username at domain ?????"
-"?\n"
+msgstr "      --smtpname    SMTP ???????????? username at domain ??????\n"
 
 #: options.c:664
 msgid "  -Z, --antispam,   set antispam response values\n"
@@ -2279,19 +2146,15 @@
 
 #: options.c:665
 msgid "  -b, --batchlimit  set batch limit for SMTP connections\n"
-msgstr ""
-"  -b, --batchlimit  ??? SMTP ?????????????????????\n"
+msgstr "  -b, --batchlimit  ??? SMTP ?????????????????????\n"
 
 #: options.c:666
 msgid "  -B, --fetchlimit  set fetch limit for server connections\n"
-msgstr ""
-"  -B, --fetchlimit  ????????????????????????????"
-"??\n"
+msgstr "  -B, --fetchlimit  ??????????????????????????????\n"
 
 #: options.c:667
 msgid "      --fetchsizelimit set fetch message size limit\n"
-msgstr ""
-"      --fetchsizelimit ???????????????????????\n"
+msgstr "      --fetchsizelimit ???????????????????????\n"
 
 #: options.c:668
 msgid "      --fastuidl    do a binary search for UIDLs\n"
@@ -2307,8 +2170,7 @@
 
 #: options.c:671
 msgid "      --bsmtp       set output BSMTP file\n"
-msgstr ""
-"      --bsmtp       ????????????? BSMTP ???????????\n"
+msgstr "      --bsmtp       ????????????? BSMTP ???????????\n"
 
 #: options.c:672
 msgid "      --lmtp        use LMTP (RFC2033) for delivery\n"
@@ -2323,17 +2185,12 @@
 msgstr "      --showdots    ??????????????? . ???????\n"
 
 #: pop3.c:355
-msgid ""
-"Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead "
-"of TOP.\n"
-msgstr ""
-"??: Maillennium POP3/??????????TOP ????? RETR ???????"
-"????\n"
+msgid "Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead of TOP.\n"
+msgstr "??: Maillennium POP3/??????????TOP ????? RETR ???????????\n"
 
 #: pop3.c:454
 msgid "TLS is mandatory for this session, but server refused CAPA command.\n"
-msgstr ""
-"????????? TLS ??????????? CAPA ????????????\n"
+msgstr "????????? TLS ??????????? CAPA ????????????\n"
 
 #: pop3.c:455
 msgid "The CAPA command is however necessary for TLS.\n"
@@ -2346,9 +2203,7 @@
 
 #: pop3.c:646
 msgid "We've run out of allowed authenticators and cannot continue.\n"
-msgstr ""
-"??????????????????????????????????????"
-"???????\n"
+msgstr "?????????????????????????????????????????????\n"
 
 #: pop3.c:660
 msgid "Required APOP timestamp not found in greeting\n"
@@ -2390,8 +2245,7 @@
 
 #: pop3.c:965
 msgid "Messages inserted into list on server. Cannot handle this.\n"
-msgstr ""
-"???????????????????????????????????\n"
+msgstr "???????????????????????????????????\n"
 
 #: pop3.c:1057
 msgid "protocol error\n"
@@ -2414,20 +2268,12 @@
 msgstr "SDPS ?????????"
 
 #: rcfile_y.y:215
-msgid ""
-"fetchmail: interface option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: interface ?????? Linux (IPv6 ????????) ?FreeBSD ?"
-"?????????\n"
+msgid "fetchmail: interface option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: interface ?????? Linux (IPv6 ????????) ?FreeBSD ??????????\n"
 
 #: rcfile_y.y:222
-msgid ""
-"fetchmail: monitor option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: monitor ?????? Linux (IPv6 ????????) ?FreeBSD ??"
-"????????\n"
+msgid "fetchmail: monitor option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: monitor ?????? Linux (IPv6 ????????) ?FreeBSD ??????????\n"
 
 #: rcfile_y.y:335
 msgid "SSL is not enabled"
@@ -2440,15 +2286,12 @@
 #: rcfile_y.y:423
 #, c-format
 msgid "File %s must be a regular file.\n"
-msgstr ""
-"%s ????????????????????????????????????"
-"???\n"
+msgstr "%s ???????????????????????????????????????\n"
 
 #: rcfile_y.y:433
 #, c-format
 msgid "File %s must have no more than -rwx------ (0700) permissions.\n"
-msgstr ""
-"???? %s ????????? -rwx------ (0700) ??????????\n"
+msgstr "???? %s ????????? -rwx------ (0700) ??????????\n"
 
 #: rcfile_y.y:445
 #, c-format
@@ -2704,16 +2547,12 @@
 #: sink.c:990
 #, c-format
 msgid "%cMTP listener doesn't like recipient address `%s'\n"
-msgstr ""
-"%cMTP ????????????? `%s' ??????????????????"
-"??\n"
+msgstr "%cMTP ????????????? `%s' ????????????????????\n"
 
 #: sink.c:997
 #, c-format
 msgid "%cMTP listener doesn't really like recipient address `%s'\n"
-msgstr ""
-"%cMTP ????????????? `%s' ??????????????????"
-"??\n"
+msgstr "%cMTP ????????????? `%s' ????????????????????\n"
 
 #: sink.c:1043
 msgid "no address matches; no postmaster set.\n"
@@ -2765,11 +2604,8 @@
 
 #: sink.c:1373
 #, c-format
-msgid ""
-"Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
-msgstr ""
-"??: MDA ? pclose ? %d ????????????%d/%s ??????????"
-"????????? %s:%d ?\n"
+msgid "Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
+msgstr "??: MDA ? pclose ? %d ????????????%d/%s ??????????????????? %s:%d ?\n"
 
 #: sink.c:1395
 msgid "Message termination or close of BSMTP file failed\n"
@@ -2858,8 +2694,7 @@
 
 #: socket.c:289
 msgid "Try adding the --service option (see also FAQ item R12).\n"
-msgstr ""
-"????? --service ???????????(FAQ ? R12 ??????)?\n"
+msgstr "????? --service ???????????(FAQ ? R12 ??????)?\n"
 
 #: socket.c:300 socket.c:303
 #, c-format
@@ -2909,8 +2744,7 @@
 
 #: socket.c:626
 msgid "Warning: Issuer CommonName too long (possibly truncated).\n"
-msgstr ""
-"?? : ???? CommonName ??????? (?????????????)\n"
+msgstr "?? : ???? CommonName ??????? (?????????????)\n"
 
 #: socket.c:628
 msgid "Unknown Issuer CommonName\n"
@@ -2926,19 +2760,17 @@
 msgstr "????? : Subject CommonName ???????\n"
 
 #: socket.c:643
-#, fuzzy
 msgid "Bad certificate: Subject CommonName contains NUL, aborting!\n"
-msgstr "????? : Subject CommonName ???????\n"
+msgstr "????? : Subject CommonName ? NUL ??????????????\n"
 
 #: socket.c:664
 #, c-format
 msgid "Subject Alternative Name: %s\n"
-msgstr ""
+msgstr "?????????: %s\n"
 
 #: socket.c:670
-#, fuzzy
 msgid "Bad certificate: Subject Alternative Name contains NUL, aborting!\n"
-msgstr "????? : Subject CommonName ???????\n"
+msgstr "????? : ????????? ? NUL ??????????????\n"
 
 #: socket.c:698
 #, c-format
@@ -2999,11 +2831,9 @@
 msgstr "???????? SSL ??????????"
 
 #: socket.c:866
-#, fuzzy, c-format
+#, c-format
 msgid "Invalid SSL protocol '%s' specified, using default (SSLv23).\n"
-msgstr ""
-"??? SSL ????? `%s' ?????????????? (SSLv23)?????"
-"??\n"
+msgstr "??? SSL ????? `%s' ?????????????? (SSLv23)???????\n"
 
 #: socket.c:942
 msgid "Certificate/fingerprint verification was somehow skipped!\n"
@@ -3154,9 +2984,7 @@
 #: uid.c:645
 #, c-format
 msgid "Error writing to fetchids file %s, old file left in place.\n"
-msgstr ""
-"fetchids ???? %s ????????????????????????????"
-"??\n"
+msgstr "fetchids ???? %s ??????????????????????????????\n"
 
 #: uid.c:649
 #, c-format
@@ -3166,8 +2994,7 @@
 #: uid.c:653
 #, c-format
 msgid "Cannot open fetchids file %s for writing: %s\n"
-msgstr ""
-"fetchids ???? %s ?????????????????????????: %s\n"
+msgstr "fetchids ???? %s ?????????????????????????: %s\n"
 
 #: xmalloc.c:33
 msgid "malloc failed\n"



From svn at mknod.org  Thu Aug  6 22:33:03 2009
From: svn at mknod.org (svn at mknod.org)
Date: Thu,  6 Aug 2009 15:33:03 -0500
Subject: [fetchmail-svn] r5408 - in branches/BRANCH_6-3: . po
Message-ID: <20090806203303.2EDBA21F3F1@mknod.org>

Author: m-a
Date: 2009-08-06 15:33:02 -0500 (Thu, 06 Aug 2009)
New Revision: 5408

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/po/ca.po
   branches/BRANCH_6-3/po/es.po
   branches/BRANCH_6-3/po/pl.po
Log:
Translation updates: Spanish Castilian and Catalan, Polish.

Courtesy of Ernest Adrogu?\195?\169 Calveras, Francisco Molinero, Jakub Bogusz.

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-06 11:35:49 UTC (rev 5407)
+++ branches/BRANCH_6-3/NEWS	2009-08-06 20:33:02 UTC (rev 5408)
@@ -52,8 +52,11 @@
 fetchmail 6.3.12 (released XXXX-XX-XX - not yet):
 
 # TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
+* [ca]    Catalan (Ernest Adrogu?? Calveras)
 * [cs]    Czech (Petr Pisar)
 * [ja]    Japanese (Takeshi Hamasaki)
+* [pl]    Polish (Jakub Bogusz)
+* [es]    Spanish/Castilian (Francisco Molinero)
 
 
 fetchmail 6.3.11 (released 2009-08-06):

Modified: branches/BRANCH_6-3/po/ca.po
===================================================================
--- branches/BRANCH_6-3/po/ca.po	2009-08-06 11:35:49 UTC (rev 5407)
+++ branches/BRANCH_6-3/po/ca.po	2009-08-06 20:33:02 UTC (rev 5408)
@@ -1,13 +1,14 @@
 # Catalan messages for fetchmail.
+# This file is distributed under the same license as the fetchmail package.
 # Copyright (C) Eric S. Raymond.
-# Ernest Adrogu? Calveras <eadrogue at gmx.net>, 2005, 2006.
+# Ernest Adrogu? Calveras <eadrogue at gmx.net>, 2005, 2006, 2009.
 #
 msgid ""
 msgstr ""
-"Project-Id-Version: fetchmail 6.3.5-b1\n"
+"Project-Id-Version: fetchmail 6.3.11\n"
 "Report-Msgid-Bugs-To: fetchmail-devel at lists.berlios.de\n"
 "POT-Creation-Date: 2009-08-06 01:21+0200\n"
-"PO-Revision-Date: 2006-08-31 19:22+0200\n"
+"PO-Revision-Date: 2009-08-06 14:52+0200\n"
 "Last-Translator: Ernest Adrogu? Calveras <eadrogue at gmx.net>\n"
 "Language-Team: Catalan <ca at dodds.net>\n"
 "MIME-Version: 1.0\n"
@@ -66,29 +67,26 @@
 #: driver.c:339
 #, c-format
 msgid "The following oversized messages were deleted on server %s account %s:"
-msgstr ""
-"Els seg?ents missatges de mida excessiva s'han eliminat del servidor %s, "
-"compte %s:"
+msgstr "Els seg?ents missatges de mida excessiva s'han eliminat del servidor %s, compte %s:"
 
 #: driver.c:343
 #, c-format
 msgid "The following oversized messages remain on server %s account %s:"
-msgstr ""
-"Els seg?ents missatges de mida excessiva romanen al servidor %s, compte %s:"
+msgstr "Els seg?ents missatges de mida excessiva romanen al servidor %s, compte %s:"
 
 #: driver.c:362
-#, fuzzy, c-format
+#, c-format
 msgid "  %d message  %d octets long deleted by fetchmail."
 msgid_plural "  %d messages %d octets long deleted by fetchmail."
-msgstr[0] "  msg %d de %d octets eliminat pel fetchmail."
-msgstr[1] "  msg %d de %d octets eliminat pel fetchmail."
+msgstr[0] "  %d missatge de %d eliminat per part del fetchmail."
+msgstr[1] "  %d missatges, %d octets en total, eliminats per part del fetchmail."
 
 #: driver.c:367
-#, fuzzy, c-format
+#, c-format
 msgid "  %d message  %d octets long skipped by fetchmail."
 msgid_plural "  %d messages %d octets long skipped by fetchmail."
-msgstr[0] "  msg %d de %d octets no descarregat."
-msgstr[1] "  msg %d de %d octets no descarregat."
+msgstr[0] "  %d missatge de %d octets om?s per part del fetchmail."
+msgstr[1] "  %d missatges, %d octets en total, omesos per part del fetchmail."
 
 #: driver.c:511
 #, c-format
@@ -135,10 +133,8 @@
 
 #: driver.c:751
 #, c-format
-msgid ""
-"message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
-msgstr ""
-"el missatge %s@%s:%d no tenia la mida esperada (%d real != %d esperada)\n"
+msgid "message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
+msgstr "el missatge %s@%s:%d no tenia la mida esperada (%d real != %d esperada)\n"
 
 #: driver.c:783
 msgid " retained\n"
@@ -158,12 +154,9 @@
 #: driver.c:828
 #, c-format
 msgid "fetchlimit %d reached; %d message left on server %s account %s\n"
-msgid_plural ""
-"fetchlimit %d reached; %d messages left on server %s account %s\n"
-msgstr[0] ""
-"assolit el l?mit de %d missatge(s); en queda %d al servidor %s compte %s\n"
-msgstr[1] ""
-"assolit el l?mit de %d missatge(s); en queden %d al servidor %s compte %s\n"
+msgid_plural "fetchlimit %d reached; %d messages left on server %s account %s\n"
+msgstr[0] "assolit el l?mit de %d missatge(s); en queda %d al servidor %s compte %s\n"
+msgstr[1] "assolit el l?mit de %d missatge(s); en queden %d al servidor %s compte %s\n"
 
 #: driver.c:885
 #, c-format
@@ -196,12 +189,8 @@
 
 #: driver.c:916
 #, c-format
-msgid ""
-"Fetchmail saw more than %d timeouts while attempting to get mail from %s@%"
-"s.\n"
-msgstr ""
-"El fetchmail ha esgotat el temps d'espera m?s de %d cops quan intentava "
-"obtenir el correu de %s@%s.\n"
+msgid "Fetchmail saw more than %d timeouts while attempting to get mail from %s@%s.\n"
+msgstr "El fetchmail ha esgotat el temps d'espera m?s de %d cops quan intentava obtenir el correu de %s@%s.\n"
 
 #: driver.c:920
 msgid ""
@@ -221,9 +210,9 @@
 "reinicieu.\n"
 
 #: driver.c:946
-#, fuzzy, c-format
+#, c-format
 msgid "pre-connection command terminated with signal %d\n"
-msgstr "l'ordre de preconnexi? ha fallat amb estat %d\n"
+msgstr "l'ordre de preconnexi? ha finalitzat amb un senyal %d\n"
 
 #: driver.c:949
 #, c-format
@@ -240,9 +229,9 @@
 msgstr "El servidor principal no t? nom.\n"
 
 #: driver.c:1021
-#, fuzzy, c-format
+#, c-format
 msgid "couldn't find canonical DNS name of %s (%s): %s\n"
-msgstr "no s'ha pogut trobar el nom can?nic DNS de %s (%s)\n"
+msgstr "no s'ha pogut trobar el nom can?nic DNS de %s (%s): %s\n"
 
 #: driver.c:1068
 #, c-format
@@ -471,8 +460,7 @@
 #: driver.c:1567
 #, c-format
 msgid "%s error while fetching from %s@%s and delivering to SMTP host %s\n"
-msgstr ""
-"error %s en recollir el correu de %s@%s i lliurar-lo via SMTP al host %s\n"
+msgstr "error %s en recollir el correu de %s@%s i lliurar-lo via SMTP al host %s\n"
 
 #: driver.c:1569
 msgid "unknown"
@@ -484,9 +472,9 @@
 msgstr "error %s en recollir el correu de %s@%s\n"
 
 #: driver.c:1583
-#, fuzzy, c-format
+#, c-format
 msgid "post-connection command terminated with signal %d\n"
-msgstr "l'ordre de postconnexi? ha fallat amb estat %d\n"
+msgstr "l'ordre de postconnexi? ha finalitzat amb un senyal %d\n"
 
 #: driver.c:1585
 #, c-format
@@ -536,8 +524,7 @@
 msgid ""
 "%s: The NULLMAILER_FLAGS environment variable is set.\n"
 "This is dangerous as it can make nullmailer-inject or nullmailer's\n"
-"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: "
-"headers.\n"
+"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: headers.\n"
 "Try \"env NULLMAILER_FLAGS= %s YOUR ARGUMENTS HERE\"\n"
 "%s: Abort.\n"
 msgstr ""
@@ -565,14 +552,12 @@
 
 #: env.c:170
 msgid "Cannot find my own host in hosts database to qualify it!\n"
-msgstr ""
-"No s'ha pogut trobar el host propi a la base de dades per qualificar-lo!\n"
+msgstr "No s'ha pogut trobar el host propi a la base de dades per qualificar-lo!\n"
 
 #: env.c:174
 msgid ""
 "Trying to continue with unqualified hostname.\n"
-"DO NOT report broken Received: headers, HELO/EHLO lines or similar "
-"problems!\n"
+"DO NOT report broken Received: headers, HELO/EHLO lines or similar problems!\n"
 "DO repair your /etc/hosts, DNS, NIS or LDAP instead.\n"
 msgstr ""
 "S'intenta continuar amb el nom de host sense qualificar.\n"
@@ -644,18 +629,16 @@
 msgstr "L'opci? --check no est? suportada per ETRN\n"
 
 #: fetchmail.c:137
-#, fuzzy
 msgid ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham Wilson\n"
 "Copyright (C) 2005 - 2006 Sunil Shetye\n"
 "Copyright (C) 2005 - 2009 Matthias Andree\n"
 msgstr ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
-"Copyright (C) 2005-2006 Matthias Andree, Sunil Shetye\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert F. Funk, Graham Wilson\n"
+"Copyright (C) 2005-2006 Sunil Shetye\n"
+"Copyright (C) 2005-2009 Matthias Andree\n"
 
 #: fetchmail.c:142
 msgid ""
@@ -728,20 +711,13 @@
 msgstr "fetchmail: el fetchmail %s a %d ha estat finalitzat.\n"
 
 #: fetchmail.c:480
-msgid ""
-"fetchmail: can't check mail while another fetchmail to same host is "
-"running.\n"
-msgstr ""
-"fetchmail: no es pot comprovar el correu mentre funcioni un altre proc?s del "
-"fetchmail.\n"
+msgid "fetchmail: can't check mail while another fetchmail to same host is running.\n"
+msgstr "fetchmail: no es pot comprovar el correu mentre funcioni un altre proc?s del fetchmail.\n"
 
 #: fetchmail.c:486
 #, c-format
-msgid ""
-"fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
-msgstr ""
-"fetchmail: no es poden consultar els hosts especificats amb un altre "
-"fetchmail funcionant a %d.\n"
+msgid "fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
+msgstr "fetchmail: no es poden consultar els hosts especificats amb un altre fetchmail funcionant a %d.\n"
 
 #: fetchmail.c:493
 #, c-format
@@ -749,17 +725,13 @@
 msgstr "fetchmail: hi ha un altre fetchmail funcionant en primer terme a %d.\n"
 
 #: fetchmail.c:503
-msgid ""
-"fetchmail: can't accept options while a background fetchmail is running.\n"
-msgstr ""
-"fetchmail: no es poden acceptar opcions mentre funcioni un altre fetchmail "
-"en segon terme.\n"
+msgid "fetchmail: can't accept options while a background fetchmail is running.\n"
+msgstr "fetchmail: no es poden acceptar opcions mentre funcioni un altre fetchmail en segon terme.\n"
 
 #: fetchmail.c:509
 #, c-format
 msgid "fetchmail: background fetchmail at %d awakened.\n"
-msgstr ""
-"fetchmail: el fetchmail funcionant en segon terme a %d s'ha despertat.\n"
+msgstr "fetchmail: el fetchmail funcionant en segon terme a %d s'ha despertat.\n"
 
 #: fetchmail.c:521
 #, c-format
@@ -800,7 +772,7 @@
 
 #: fetchmail.c:625
 msgid "--check mode enabled, not fetching mail\n"
-msgstr ""
+msgstr "mode --check habilitat, no es recollir? el correu\n"
 
 #: fetchmail.c:647
 #, c-format
@@ -814,8 +786,7 @@
 
 #: fetchmail.c:657
 msgid "attempt to re-exec may fail as directory has not been restored\n"
-msgstr ""
-"l'intent de reexecuci? pot fallar ja que el directori no ha estat restaurat\n"
+msgstr "l'intent de reexecuci? pot fallar ja que el directori no ha estat restaurat\n"
 
 #: fetchmail.c:684
 msgid "attempt to re-exec fetchmail failed\n"
@@ -824,9 +795,7 @@
 #: fetchmail.c:714
 #, c-format
 msgid "poll of %s skipped (failed authentication or too many timeouts)\n"
-msgstr ""
-"s'ha om?s la consulta de %s (error d'autenticaci? o massa temps d'espera "
-"excedits)\n"
+msgstr "s'ha om?s la consulta de %s (error d'autenticaci? o massa temps d'espera excedits)\n"
 
 #: fetchmail.c:726
 #, c-format
@@ -900,9 +869,9 @@
 
 # %s ?s la sortida de timestamp()
 #: fetchmail.c:842
-#, fuzzy, c-format
+#, c-format
 msgid "sleeping at %s for %d seconds\n"
-msgstr "dormint el %s\n"
+msgstr "dormint el %s durant %d segons\n"
 
 #: fetchmail.c:866
 #, c-format
@@ -932,41 +901,32 @@
 #: fetchmail.c:1069
 #, c-format
 msgid "Warning: multiple mentions of host %s in config file\n"
-msgstr ""
-"Atenci?: hi ha m?ltiples mencions del host %s en el fitxer de configuraci?\n"
+msgstr "Atenci?: hi ha m?ltiples mencions del host %s en el fitxer de configuraci?\n"
 
 #: fetchmail.c:1102
 msgid "fetchmail: Error: multiple \"defaults\" records in config file.\n"
-msgstr ""
-"fetchmail: Error: hi ha m?s d'un compte \"default\" en el fitxer de "
-"configuraci?.\n"
+msgstr "fetchmail: Error: hi ha m?s d'un compte \"default\" en el fitxer de configuraci?.\n"
 
 #: fetchmail.c:1224
 msgid "SSL support is not compiled in.\n"
 msgstr "El suport per SSL no est? compilat.\n"
 
 #: fetchmail.c:1231
-#, fuzzy
 msgid "KERBEROS v4 support is configured, but not compiled in.\n"
-msgstr "El suport per SSL no est? compilat.\n"
+msgstr "Suport per a KERBEROS v4 configurat, per? no compilat.\n"
 
 #: fetchmail.c:1237
-#, fuzzy
 msgid "KERBEROS v5 support is configured, but not compiled in.\n"
-msgstr "El suport per SSL no est? compilat.\n"
+msgstr "Suport per a KERBEROS v5 configurat, per? no compilat.\n"
 
 #: fetchmail.c:1243
-#, fuzzy
 msgid "GSSAPI support is configured, but not compiled in.\n"
-msgstr "El suport per SSL no est? compilat.\n"
+msgstr "Suport per a GSSAPI configurat, per? no compilat.\n"
 
 #: fetchmail.c:1273
 #, c-format
-msgid ""
-"fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
-msgstr ""
-"fetchmail: atenci?: cap DNS disponible per verificar les obtencions "
-"multidrop de %s\n"
+msgid "fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
+msgstr "fetchmail: atenci?: cap DNS disponible per verificar les obtencions multidrop de %s\n"
 
 #: fetchmail.c:1284
 #, c-format
@@ -979,26 +939,18 @@
 
 #: fetchmail.c:1302
 #, c-format
-msgid ""
-"fetchmail: %s configuration invalid, specify positive port number for "
-"service or port\n"
-msgstr ""
-"fetchmail: la configuraci? de %s no ?s v?lida, el port no pot ser n?mero "
-"negatiu\n"
+msgid "fetchmail: %s configuration invalid, specify positive port number for service or port\n"
+msgstr "fetchmail: la configuraci? de %s no ?s v?lida, el port no pot ser n?mero negatiu\n"
 
 #: fetchmail.c:1309
 #, c-format
 msgid "fetchmail: %s configuration invalid, RPOP requires a privileged port\n"
-msgstr ""
-"fetchmail: la configuraci? de %s no ?s v?lida, RPOP requereix un port "
-"privilegiat\n"
+msgstr "fetchmail: la configuraci? de %s no ?s v?lida, RPOP requereix un port privilegiat\n"
 
 #: fetchmail.c:1327
 #, c-format
 msgid "%s configuration invalid, LMTP can't use default SMTP port\n"
-msgstr ""
-"la configuraci? de %s no ?s v?lida, LMTP no pot usar el port habitual "
-"d'SMTP\n"
+msgstr "la configuraci? de %s no ?s v?lida, LMTP no pot usar el port habitual d'SMTP\n"
 
 #: fetchmail.c:1341
 msgid "Both fetchall and keep on in daemon or idle mode is a mistake!\n"
@@ -1069,8 +1021,7 @@
 
 #: fetchmail.c:1546
 msgid "Fetchmail will show progress dots even in logfiles.\n"
-msgstr ""
-"El fetchmail mostrar? punts de progressi? ?dhuc als fitxers de registre.\n"
+msgstr "El fetchmail mostrar? punts de progressi? ?dhuc als fitxers de registre.\n"
 
 #: fetchmail.c:1548
 #, c-format
@@ -1086,14 +1037,12 @@
 msgstr "El fetchmail dirigir? els missatges d'error al remitent.\n"
 
 #: fetchmail.c:1557
-#, fuzzy
 msgid "Fetchmail will treat permanent errors as permanent (drop messsages).\n"
-msgstr "El fetchmail enviar? els missatges multidrop mal adre?ats a %s.\n"
+msgstr "El fetchmail considerar? els errors permanents permanents (perdr? els missatges).\n"
 
 #: fetchmail.c:1559
-#, fuzzy
 msgid "Fetchmail will treat permanent errors as temporary (keep messages).\n"
-msgstr "El fetchmail dirigir? els missatges d'error al remitent.\n"
+msgstr "El fetchmail considerar? els errors permanents temporals (es quedar? els missatges).\n"
 
 #: fetchmail.c:1566
 #, c-format
@@ -1119,8 +1068,7 @@
 
 #: fetchmail.c:1580
 msgid "  This host will not be queried when no host is specified.\n"
-msgstr ""
-"  Aquest host no es consultar? quan no se'n hagi especificat cap altre.\n"
+msgstr "  Aquest host no es consultar? quan no se'n hagi especificat cap altre.\n"
 
 #: fetchmail.c:1581
 msgid "  This host will be queried when no host is specified.\n"
@@ -1232,15 +1180,14 @@
 msgstr "  Directori de certificats SSL de confian?a: %s\n"
 
 #: fetchmail.c:1662
-#, fuzzy, c-format
+#, c-format
 msgid "  SSL server CommonName: %s\n"
-msgstr "Nom com? del servidor: %s\n"
+msgstr "  CommonName del servidor SSL: %s\n"
 
 #: fetchmail.c:1664
 #, c-format
 msgid "  SSL key fingerprint (checked against the server key): %s\n"
-msgstr ""
-"  Empremta de la clau SSL (comprovada contra la clau del servidor): %s\n"
+msgstr "  Empremta de la clau SSL (comprovada contra la clau del servidor): %s\n"
 
 #: fetchmail.c:1667
 #, c-format
@@ -1277,46 +1224,31 @@
 # la substituci? ?s: "<espai>/ no "
 #: fetchmail.c:1691
 msgid "  Fetched messages will not be kept on the server (--keep off).\n"
-msgstr ""
-"  Els missatges obtinguts no es conservaran al servidor (--keep off).\n"
+msgstr "  Els missatges obtinguts no es conservaran al servidor (--keep off).\n"
 
 #: fetchmail.c:1693
 msgid "  Old messages will be flushed before message retrieval (--flush on).\n"
-msgstr ""
-"  Els missatges vells s'eliminaran abans d'obtenir el correu (--flush on).\n"
+msgstr "  Els missatges vells s'eliminaran abans d'obtenir el correu (--flush on).\n"
 
 #: fetchmail.c:1694
-msgid ""
-"  Old messages will not be flushed before message retrieval (--flush off).\n"
-msgstr ""
-"  Els missatges vells no s'eliminaran abans d'obtenir el correu (--flush "
-"off).\n"
+msgid "  Old messages will not be flushed before message retrieval (--flush off).\n"
+msgstr "  Els missatges vells no s'eliminaran abans d'obtenir el correu (--flush off).\n"
 
 #: fetchmail.c:1696
-msgid ""
-"  Oversized messages will be flushed before message retrieval (--limitflush "
-"on).\n"
-msgstr ""
-"  Els missatges excessivament grans s'eliminaran abans d'obtenir el correu "
-"(--limitflush on).\n"
+msgid "  Oversized messages will be flushed before message retrieval (--limitflush on).\n"
+msgstr "  Els missatges excessivament grans s'eliminaran abans d'obtenir el correu (--limitflush on).\n"
 
 #: fetchmail.c:1697
-msgid ""
-"  Oversized messages will not be flushed before message retrieval (--"
-"limitflush off).\n"
-msgstr ""
-"  Els missatges excessivament grans no s'eliminaran abans d'obtenir el "
-"correu (--limitflush off).\n"
+msgid "  Oversized messages will not be flushed before message retrieval (--limitflush off).\n"
+msgstr "  Els missatges excessivament grans no s'eliminaran abans d'obtenir el correu (--limitflush off).\n"
 
 #: fetchmail.c:1699
 msgid "  Rewrite of server-local addresses is enabled (--norewrite off).\n"
-msgstr ""
-"  La reescriptura d'adreces locals est? habilitada (--norewrite off).\n"
+msgstr "  La reescriptura d'adreces locals est? habilitada (--norewrite off).\n"
 
 #: fetchmail.c:1700
 msgid "  Rewrite of server-local addresses is disabled (--norewrite on).\n"
-msgstr ""
-"  La reescriptura d'adreces locals est? deshabilitada (--norewrite on).\n"
+msgstr "  La reescriptura d'adreces locals est? deshabilitada (--norewrite on).\n"
 
 #: fetchmail.c:1702
 msgid "  Carriage-return stripping is enabled (stripcr on).\n"
@@ -1335,18 +1267,12 @@
 msgstr "  L'inserci? de retorns de carro est? deshabilitada (forcecr off).\n"
 
 #: fetchmail.c:1708
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
-msgstr ""
-"  L'interpretaci? del Content-Transfer-Encoding est? deshabilitada "
-"(pass8bits on).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
+msgstr "  L'interpretaci? del Content-Transfer-Encoding est? deshabilitada (pass8bits on).\n"
 
 #: fetchmail.c:1709
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
-msgstr ""
-"  L'interpretaci? del Content-Transfer-Encoding est? habilitada (pass8bits "
-"off).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
+msgstr "  L'interpretaci? del Content-Transfer-Encoding est? habilitada (pass8bits off).\n"
 
 #: fetchmail.c:1711
 msgid "  MIME decoding is enabled (mimedecode on).\n"
@@ -1366,13 +1292,11 @@
 
 #: fetchmail.c:1717
 msgid "  Nonempty Status lines will be discarded (dropstatus on)\n"
-msgstr ""
-"  Les l?nies Status que no estiguin en blanc es descartaran (dropstatus on)\n"
+msgstr "  Les l?nies Status que no estiguin en blanc es descartaran (dropstatus on)\n"
 
 #: fetchmail.c:1718
 msgid "  Nonempty Status lines will be kept (dropstatus off)\n"
-msgstr ""
-"  Les l?nies Status que no estiguin en blanc es mantindran (dropstatus off)\n"
+msgstr "  Les l?nies Status que no estiguin en blanc es mantindran (dropstatus off)\n"
 
 #: fetchmail.c:1720
 msgid "  Delivered-To lines will be discarded (dropdelivered on)\n"
@@ -1394,8 +1318,7 @@
 #: fetchmail.c:1730
 #, c-format
 msgid "  Message size warning interval is %d seconds (--warnings %d).\n"
-msgstr ""
-"  L'interval d'avisos de missatges grans ?s de %d segons (--warnings %d).\n"
+msgstr "  L'interval d'avisos de missatges grans ?s de %d segons (--warnings %d).\n"
 
 #: fetchmail.c:1733
 msgid "  Size warnings on every poll (--warnings 0).\n"
@@ -1426,9 +1349,7 @@
 #: fetchmail.c:1750
 #, c-format
 msgid "  Do binary search of UIDs during %d out of %d polls (--fastuidl %d).\n"
-msgstr ""
-"  Es far? una cerca bin?ria de UIDs %d consultes de cada %d (--fastuidl %"
-"d).\n"
+msgstr "  Es far? una cerca bin?ria de UIDs %d consultes de cada %d (--fastuidl %d).\n"
 
 #: fetchmail.c:1753
 msgid "   Do linear search of UIDs during each poll (--fastuidl 0).\n"
@@ -1446,9 +1367,7 @@
 #: fetchmail.c:1761
 #, c-format
 msgid "  Deletion interval between expunges forced to %d (--expunge %d).\n"
-msgstr ""
-"  L'interval entre supressions ?s de %d missatge(s) eliminat(s) (--expunge %"
-"d).\n"
+msgstr "  L'interval entre supressions ?s de %d missatge(s) eliminat(s) (--expunge %d).\n"
 
 #: fetchmail.c:1763
 msgid "  No forced expunges (--expunge 0).\n"
@@ -1541,16 +1460,12 @@
 msgstr "  La consulta DNS d'adreces multidrop est? deshabilitada.\n"
 
 #: fetchmail.c:1866
-msgid ""
-"  Server aliases will be compared with multidrop addresses by IP address.\n"
-msgstr ""
-"  Els ?lies del servidor es compararan amb les adreces multidrop per adre?a "
-"IP.\n"
+msgid "  Server aliases will be compared with multidrop addresses by IP address.\n"
+msgstr "  Els ?lies del servidor es compararan amb les adreces multidrop per adre?a IP.\n"
 
 #: fetchmail.c:1868
 msgid "  Server aliases will be compared with multidrop addresses by name.\n"
-msgstr ""
-"  Els ?lies del servidor es compararan amb les adreces multidrop pel nom.\n"
+msgstr "  Els ?lies del servidor es compararan amb les adreces multidrop pel nom.\n"
 
 #: fetchmail.c:1871
 msgid "  Envelope-address routing is disabled\n"
@@ -1613,8 +1528,7 @@
 #: fetchmail.c:1923
 #, c-format
 msgid "  Listener connections will be made via plugout %s (--plugout %s).\n"
-msgstr ""
-"  Les connexions amb el receptor SMTP es faran via %s (--plugout %s).\n"
+msgstr "  Les connexions amb el receptor SMTP es faran via %s (--plugout %s).\n"
 
 #: fetchmail.c:1925
 msgid "  No plugout command specified.\n"
@@ -1733,19 +1647,19 @@
 msgstr "es far? una pausa despr?s de l'obtenci?\n"
 
 #: imap.c:446 pop3.c:518
-#, fuzzy, c-format
+#, c-format
 msgid "%s: upgrade to TLS succeeded.\n"
-msgstr "%s: actualitzaci? oportunista a TLS.\n"
+msgstr "%s: la promoci? a TLS ha reeixit.\n"
 
 #: imap.c:455 pop3.c:527
-#, fuzzy, c-format
+#, c-format
 msgid "%s: upgrade to TLS failed.\n"
-msgstr "%s: actualitzaci? oportunista a TLS.\n"
+msgstr "%s: la promoci? a TLS a fallat.\n"
 
 #: imap.c:459
-#, fuzzy, c-format
+#, c-format
 msgid "%s: opportunistic upgrade to TLS failed, trying to continue\n"
-msgstr "%s: actualitzaci? oportunista a TLS.\n"
+msgstr "%s: la promoci? oportunista a TLS a fallat, intentant continuar.\n"
 
 #: imap.c:579
 msgid "Required OTP capability not compiled into fetchmail\n"
@@ -1812,17 +1726,12 @@
 msgstr "%u ?s el primer missatge no llegit\n"
 
 #: imap.c:1002
-msgid ""
-"Warning: ignoring bogus data for message sizes returned by the server.\n"
-msgstr ""
-"Atenci?: s'ignoren les dades err?nies sobre la mida dels missatges enviades "
-"pel servidor.\n"
+msgid "Warning: ignoring bogus data for message sizes returned by the server.\n"
+msgstr "Atenci?: s'ignoren les dades err?nies sobre la mida dels missatges enviades pel servidor.\n"
 
 #: interface.c:256
 msgid "Unable to open kvm interface. Make sure fetchmail is SGID kmem."
-msgstr ""
-"No s'ha pogut obrir l'interf?cie kvm. Asseguereu-vos que el fetchmail ?s "
-"SGID kmem."
+msgstr "No s'ha pogut obrir l'interf?cie kvm. Asseguereu-vos que el fetchmail ?s SGID kmem."
 
 #: interface.c:396
 #, c-format
@@ -2089,11 +1998,8 @@
 msgstr "  -L, --logfile     especifica el fitxer on registrar l'activitat\n"
 
 #: options.c:613
-msgid ""
-"      --syslog      use syslog(3) for most messages when running as a "
-"daemon\n"
-msgstr ""
-"      --syslog      en mode dimoni, registra l'activitat via syslog(3)\n"
+msgid "      --syslog      use syslog(3) for most messages when running as a daemon\n"
+msgstr "      --syslog      en mode dimoni, registra l'activitat via syslog(3)\n"
 
 #: options.c:614
 msgid "      --invisible   don't write Received & enable host spoofing\n"
@@ -2118,19 +2024,15 @@
 
 #: options.c:619
 msgid "      --nobounce    redirect bounces from user to postmaster.\n"
-msgstr ""
-"      --nobounce    redirigeix els missatges retornats cap al postmaster\n"
+msgstr "      --nobounce    redirigeix els missatges retornats cap al postmaster\n"
 
 #: options.c:620
-msgid ""
-"      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
-msgstr ""
+msgid "      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
+msgstr "      --nosoftbounce esborra permanentment missatges que no es poden lliurar\n"
 
 #: options.c:621
-msgid ""
-"      --softbounce  keep permanently undeliverable messages on server "
-"(default).\n"
-msgstr ""
+msgid "      --softbounce  keep permanently undeliverable messages on server (default).\n"
+msgstr "      --softbounce  mant? al servidor missatges que no es poden lliurar (predet.)\n"
 
 #: options.c:623
 msgid "  -I, --interface   interface required specification\n"
@@ -2138,8 +2040,7 @@
 
 #: options.c:624
 msgid "  -M, --monitor     monitor interface for activity\n"
-msgstr ""
-"  -M, --monitor     monitora l'activitat de l'interf?cie especificada\n"
+msgstr "  -M, --monitor     monitora l'activitat de l'interf?cie especificada\n"
 
 #: options.c:627
 msgid "      --ssl         enable ssl encrypted session\n"
@@ -2164,17 +2065,12 @@
 msgstr "      --sslcertpath cam? cap als certificats ssl\n"
 
 #: options.c:632
-msgid ""
-"      --sslcommonname  expect this CommonName from server (discouraged)\n"
-msgstr ""
+msgid "      --sslcommonname  expect this CommonName from server (discouraged)\n"
+msgstr "      --sslcommonname  espera aquest CommonName del servidor (no recomenat)\n"
 
 #: options.c:633
-msgid ""
-"      --sslfingerprint fingerprint that must match that of the server's "
-"cert.\n"
-msgstr ""
-"      --sslfingerprint empremta que ha de coincidir amb el cert. del "
-"servidor.\n"
+msgid "      --sslfingerprint fingerprint that must match that of the server's cert.\n"
+msgstr "      --sslfingerprint empremta que ha de coincidir amb el cert. del servidor.\n"
 
 #: options.c:634
 msgid "      --sslproto    force ssl protocol (SSL2/SSL3/TLS1)\n"
@@ -2182,18 +2078,15 @@
 
 #: options.c:636
 msgid "      --plugin      specify external command to open connection\n"
-msgstr ""
-"      --plugin      especifica l'ordre externa per obrir una connexi?\n"
+msgstr "      --plugin      especifica l'ordre externa per obrir una connexi?\n"
 
 #: options.c:637
 msgid "      --plugout     specify external command to open smtp connection\n"
-msgstr ""
-"      --plogout     especifica l'ordre externa per obrir una connexi? smtp\n"
+msgstr "      --plogout     especifica l'ordre externa per obrir una connexi? smtp\n"
 
 #: options.c:639
 msgid "  -p, --protocol    specify retrieval protocol (see man page)\n"
-msgstr ""
-"  -p, --protocol    especifica el protocol que s'usa per obtenir el correu\n"
+msgstr "  -p, --protocol    especifica el protocol que s'usa per obtenir el correu\n"
 
 #: options.c:640
 msgid "  -U, --uidl        force the use of UIDLs (pop3 only)\n"
@@ -2201,16 +2094,11 @@
 
 #: options.c:641
 msgid "      --port        TCP port to connect to (obsolete, use --service)\n"
-msgstr ""
-"      --port        port TCP/IP al qual connectar-se (obsolet, useu --"
-"service)\n"
+msgstr "      --port        port TCP/IP al qual connectar-se (obsolet, useu --service)\n"
 
 #: options.c:642
-msgid ""
-"  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
-msgstr ""
-"  -P, --service      servei TCP/IP al qual connectar-se (o un n?mero de "
-"port)\n"
+msgid "  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
+msgstr "  -P, --service      servei TCP/IP al qual connectar-se (o un n?mero de port)\n"
 
 #: options.c:643
 msgid "      --auth        authentication type (password/kerberos/ssh/otp)\n"
@@ -2234,8 +2122,7 @@
 
 #: options.c:648
 msgid "      --tracepolls  add poll-tracing information to Received header\n"
-msgstr ""
-"      --tracepolls  afegeix el rastre de l'obtenci? a la cap?alera Received\n"
+msgstr "      --tracepolls  afegeix el rastre de l'obtenci? a la cap?alera Received\n"
 
 #: options.c:650
 msgid "  -u, --username    specify users's login on server\n"
@@ -2247,8 +2134,7 @@
 
 #: options.c:652
 msgid "  -K, --nokeep      delete new messages after retrieval\n"
-msgstr ""
-"  -K, --nokeep      esborra els missatges nous despr?s de recollir-los\n"
+msgstr "  -K, --nokeep      esborra els missatges nous despr?s de recollir-los\n"
 
 #: options.c:653
 msgid "  -k, --keep        save new messages after retrieval\n"
@@ -2268,9 +2154,7 @@
 
 #: options.c:657
 msgid "  -l, --limit       don't fetch messages over given size\n"
-msgstr ""
-"  -l, --limit       no recull els missatges que superin la mida "
-"especificada\n"
+msgstr "  -l, --limit       no recull els missatges que superin la mida especificada\n"
 
 #: options.c:658
 msgid "  -w, --warnings    interval between warning mail notification\n"
@@ -2294,18 +2178,15 @@
 
 #: options.c:664
 msgid "  -Z, --antispam,   set antispam response values\n"
-msgstr ""
-"  -Z, --antispam,   estableix els valors reconeguts com a resposta antispam\n"
+msgstr "  -Z, --antispam,   estableix els valors reconeguts com a resposta antispam\n"
 
 #: options.c:665
 msgid "  -b, --batchlimit  set batch limit for SMTP connections\n"
-msgstr ""
-"  -b, --batchlimit  estableix el l?mit de missatges SMTP enviats en s?rie\n"
+msgstr "  -b, --batchlimit  estableix el l?mit de missatges SMTP enviats en s?rie\n"
 
 #: options.c:666
 msgid "  -B, --fetchlimit  set fetch limit for server connections\n"
-msgstr ""
-"  -B, --fetchlimit  estableix el l?mit de missatges obtinguts per connexi?\n"
+msgstr "  -B, --fetchlimit  estableix el l?mit de missatges obtinguts per connexi?\n"
 
 #: options.c:667
 msgid "      --fetchsizelimit set fetch message size limit\n"
@@ -2317,9 +2198,7 @@
 
 #: options.c:669
 msgid "  -e, --expunge     set max deletions between expunges\n"
-msgstr ""
-"  -e, --expunge     estableix el m?xim de missatges eliminats entre "
-"supressions\n"
+msgstr "  -e, --expunge     estableix el m?xim de missatges eliminats entre supressions\n"
 
 #: options.c:670
 msgid "  -m, --mda         set MDA to use for forwarding\n"
@@ -2339,47 +2218,41 @@
 
 #: options.c:674
 msgid "      --showdots    show progress dots even in logfiles\n"
-msgstr ""
-"      --showdots    mostra punts de progressi? ?dhuc als fitxers de "
-"registre\n"
+msgstr "      --showdots    mostra punts de progressi? ?dhuc als fitxers de registre\n"
 
 #: pop3.c:355
-msgid ""
-"Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead "
-"of TOP.\n"
-msgstr ""
-"Atenci?: s'ha detectat un \"Maillennium POP3/PROXY server\", s'usa RETR en "
-"lloc de TOP.\n"
+msgid "Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead of TOP.\n"
+msgstr "Atenci?: s'ha detectat un \"Maillennium POP3/PROXY server\", s'usa RETR en lloc de TOP.\n"
 
 #: pop3.c:454
 msgid "TLS is mandatory for this session, but server refused CAPA command.\n"
-msgstr ""
+msgstr "Aquesta sessi? requereix TLS, per? el servidor no admet l'ordre CAPA.\n"
 
 #: pop3.c:455
 msgid "The CAPA command is however necessary for TLS.\n"
-msgstr ""
+msgstr "No obstant l'ordre CAPA ?s necess?ria per a TLS.\n"
 
 #: pop3.c:538
-#, fuzzy, c-format
+#, c-format
 msgid "%s: opportunistic upgrade to TLS failed, trying to continue.\n"
-msgstr "%s: actualitzaci? oportunista a TLS.\n"
+msgstr "%s: la promoci? oportunista a TLS a fallat, intentant continuar.\n"
 
 #: pop3.c:646
 msgid "We've run out of allowed authenticators and cannot continue.\n"
-msgstr ""
+msgstr "S'han esgotat els autenticadors permesos i no es pot continuar.\n"
 
 # timestamp: marca hor?ria
 #: pop3.c:660
 msgid "Required APOP timestamp not found in greeting\n"
-msgstr "No s'ha trobat la marca hor?ria APOP requerida a la salutaci?\n"
+msgstr "No s'ha trobat l'informaci? hor?ria APOP requerida a la salutaci?\n"
 
 #: pop3.c:669
 msgid "Timestamp syntax error in greeting\n"
-msgstr "Error de sintaxi en la marca hor?ria de la salutaci?\n"
+msgstr "Error de sintaxi en l'informaci? hor?ria de la salutaci?\n"
 
 #: pop3.c:685
 msgid "Invalid APOP timestamp.\n"
-msgstr ""
+msgstr "Informaci? hor?ria APOP err?nia.\n"
 
 #: pop3.c:709
 msgid "Undefined protocol request in POP3_auth\n"
@@ -2409,8 +2282,7 @@
 
 #: pop3.c:965
 msgid "Messages inserted into list on server. Cannot handle this.\n"
-msgstr ""
-"Els missatges estan inserits a la llista del servidor. No es pot continuar.\n"
+msgstr "Els missatges estan inserits a la llista del servidor. No es pot continuar.\n"
 
 #: pop3.c:1057
 msgid "protocol error\n"
@@ -2433,20 +2305,12 @@
 msgstr "SDPS no habilitat."
 
 #: rcfile_y.y:215
-msgid ""
-"fetchmail: interface option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: l'opci? d'interf?cie nom?s est? suportada en Linux (sense IPv6) i "
-"FreeBSD\n"
+msgid "fetchmail: interface option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: l'opci? d'interf?cie nom?s est? suportada en Linux (sense IPv6) i FreeBSD\n"
 
 #: rcfile_y.y:222
-msgid ""
-"fetchmail: monitor option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: l'opci? de monitoraci? nom?s est? suportada en Linux (sense IPv6) "
-"i FreeBSD\n"
+msgid "fetchmail: monitor option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: l'opci? de monitoraci? nom?s est? suportada en Linux (sense IPv6) i FreeBSD\n"
 
 #: rcfile_y.y:335
 msgid "SSL is not enabled"
@@ -2476,9 +2340,9 @@
 msgstr "Error no identificat del sistema"
 
 #: report.c:92
-#, fuzzy, c-format
+#, c-format
 msgid "%s (log message incomplete)\n"
-msgstr "%s (missatge de registre incomplet)"
+msgstr "%s (missatge de registre incomplet)\n"
 
 #: rfc822.c:76
 #, c-format
@@ -2523,7 +2387,7 @@
 #: rpa.c:199
 #, c-format
 msgid "Service timestamp %s\n"
-msgstr "Marca hor?ria del servei %s\n"
+msgstr "Informaci? hor?ria del servei %s\n"
 
 #: rpa.c:204
 msgid "RPA token 2 length error\n"
@@ -2707,17 +2571,16 @@
 
 #: sink.c:550
 msgid "SMTP server requires STARTTLS, keeping message.\n"
-msgstr ""
+msgstr "El servidor SMTP requereix STARTTLS, es mant? el missatge.\n"
 
 #: sink.c:730
-#, fuzzy, c-format
+#, c-format
 msgid "BSMTP file open failed: %s\n"
-msgstr "Ha fallat l'obertura del fitxer BSMTP o l'escriptura del pre?mbul\n"
+msgstr "No s'ha pogut obrir el fitxer BSMTP: %s\n"
 
 #: sink.c:776
-#, fuzzy
 msgid "BSMTP preamble write failed.\n"
-msgstr "Ha fallat l'obertura del fitxer BSMTP o l'escriptura del pre?mbul\n"
+msgstr "No s'ha pogut escriure el pre?mbul del fitxer BSMTP.\n"
 
 #: sink.c:990
 #, c-format
@@ -2780,11 +2643,8 @@
 
 #: sink.c:1373
 #, c-format
-msgid ""
-"Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
-msgstr ""
-"Estrany: La funci? pclose de l'MDA a retornat %d i errno %d/%s, no es pot "
-"continuar a %s:%d\n"
+msgid "Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
+msgstr "Estrany: La funci? pclose de l'MDA a retornat %d i errno %d/%s, no es pot continuar a %s:%d\n"
 
 #: sink.c:1395
 msgid "Message termination or close of BSMTP file failed\n"
@@ -2910,9 +2770,7 @@
 
 #: socket.c:619
 msgid "Warning: Issuer Organization Name too long (possibly truncated).\n"
-msgstr ""
-"Atenci?: El nom de l'organitzaci? emissora ?s massa llarg (pot estar "
-"truncat).\n"
+msgstr "Atenci?: El nom de l'organitzaci? emissora ?s massa llarg (pot estar truncat).\n"
 
 #: socket.c:621
 msgid "Unknown Organization\n"
@@ -2925,8 +2783,7 @@
 
 #: socket.c:626
 msgid "Warning: Issuer CommonName too long (possibly truncated).\n"
-msgstr ""
-"Atenci?: El nom com? de l'emissor ?s massa llarg (pot estar truncat).\n"
+msgstr "Atenci?: El nom com? de l'emissor ?s massa llarg (pot estar truncat).\n"
 
 #: socket.c:628
 msgid "Unknown Issuer CommonName\n"
@@ -2939,32 +2796,29 @@
 
 #: socket.c:637
 msgid "Bad certificate: Subject CommonName too long!\n"
-msgstr "Certificat incorrecte: El component CommonName ?s massa llarg!\n"
+msgstr "Certificat erroni: El CommonName del subjecte ?s massa llarg!\n"
 
 #: socket.c:643
-#, fuzzy
 msgid "Bad certificate: Subject CommonName contains NUL, aborting!\n"
-msgstr "Certificat incorrecte: El component CommonName ?s massa llarg!\n"
+msgstr "Certificat erroni: El CommonName del subjecte cont? un car?cter nul, s'avorta!\n"
 
 #: socket.c:664
 #, c-format
 msgid "Subject Alternative Name: %s\n"
-msgstr ""
+msgstr "Nom alternatiu del subjecte: %s\n"
 
 #: socket.c:670
-#, fuzzy
 msgid "Bad certificate: Subject Alternative Name contains NUL, aborting!\n"
-msgstr "Certificat incorrecte: El component CommonName ?s massa llarg!\n"
+msgstr "Certificat erroni: El nom alternatiu del subjecte cont? un car?cter nul!\n"
 
 #: socket.c:698
 #, c-format
 msgid "Server CommonName mismatch: %s != %s\n"
-msgstr "El nom com? del servidor no encaixa: %s != %s\n"
+msgstr "El nom com? del servidor no coincideix: %s != %s\n"
 
 #: socket.c:705
 msgid "Server name not set, could not verify certificate!\n"
-msgstr ""
-"El nom del servidor no est? definit, no es pot verificar el certificat!\n"
+msgstr "El nom del servidor no est? definit, no es pot verificar el certificat!\n"
 
 #: socket.c:710
 msgid "Unknown Server CommonName\n"
@@ -3017,7 +2871,7 @@
 msgstr "Descriptor del fitxer fora d'abast per SSL"
 
 #: socket.c:866
-#, fuzzy, c-format
+#, c-format
 msgid "Invalid SSL protocol '%s' specified, using default (SSLv23).\n"
 msgstr "El protocol SSL especificat `%s' no ?s v?lid, s'usa SSLv23.\n"
 
@@ -3149,8 +3003,7 @@
 
 #: uid.c:556
 msgid "not swapping UID lists, no UIDs seen this query\n"
-msgstr ""
-"no s'intercanvien llistes d'UIDs, no s'han trobat UIDs en aquesta consulta\n"
+msgstr "no s'intercanvien llistes d'UIDs, no s'han trobat UIDs en aquesta consulta\n"
 
 #: uid.c:581
 msgid "discarding new UID list\n"
@@ -3193,5 +3046,4 @@
 msgstr "la rutina realloc ha fallat\n"
 
 #~ msgid "message delimiter found while scanning headers\n"
-#~ msgstr ""
-#~ "s'ha trobat un delimitador de missatge quan s'analitzava l'encap?alament\n"
+#~ msgstr "s'ha trobat un delimitador de missatge quan s'analitzava l'encap?alament\n"

Modified: branches/BRANCH_6-3/po/es.po
===================================================================
--- branches/BRANCH_6-3/po/es.po	2009-08-06 11:35:49 UTC (rev 5407)
+++ branches/BRANCH_6-3/po/es.po	2009-08-06 20:33:02 UTC (rev 5408)
@@ -7,10 +7,10 @@
 #
 msgid ""
 msgstr ""
-"Project-Id-Version: fetchmail 6.3.10-pre2\n"
+"Project-Id-Version: fetchmail 6.3.11\n"
 "Report-Msgid-Bugs-To: fetchmail-devel at lists.berlios.de\n"
 "POT-Creation-Date: 2009-08-06 01:21+0200\n"
-"PO-Revision-Date: 2009-07-03 20:09+0200\n"
+"PO-Revision-Date: 2009-08-06 20:00+0200\n"
 "Last-Translator: Francisco Molinero <paco at byasl.com>\n"
 "Language-Team: Spanish <es at li.org>\n"
 "MIME-Version: 1.0\n"
@@ -34,14 +34,12 @@
 #: checkalias.c:203
 #, c-format
 msgid "nameserver failure while looking for '%s' during poll of %s: %s\n"
-msgstr ""
-"fallo en la resoluci??n de nombres buscando ??%s?? durante la consulta de %s:%s\n"
+msgstr "fallo en la resoluci??n de nombres buscando ??%s?? durante la consulta de %s:%s\n"
 
 #: checkalias.c:228
 #, c-format
 msgid "nameserver failure while looking for `%s' during poll of %s.\n"
-msgstr ""
-"fallo en la resoluci??n de nombres buscando ??%s?? durante la consulta de %s.\n"
+msgstr "fallo en la resoluci??n de nombres buscando ??%s?? durante la consulta de %s.\n"
 
 #: cram.c:95
 msgid "could not decode BASE64 challenge\n"
@@ -69,16 +67,12 @@
 #: driver.c:339
 #, c-format
 msgid "The following oversized messages were deleted on server %s account %s:"
-msgstr ""
-"Los siguientes mensajes excedidos de tama??o se borraron del servidor %s "
-"cuenta %s:"
+msgstr "Los siguientes mensajes excedidos de tama??o se borraron del servidor %s cuenta %s:"
 
 #: driver.c:343
 #, c-format
 msgid "The following oversized messages remain on server %s account %s:"
-msgstr ""
-"Los siguientes mensajes excedidos de tama??o permanecen en el servidor %s "
-"cuenta %s:"
+msgstr "Los siguientes mensajes excedidos de tama??o permanecen en el servidor %s cuenta %s:"
 
 #: driver.c:362
 #, c-format
@@ -115,8 +109,7 @@
 #: driver.c:602
 #, c-format
 msgid "couldn't fetch headers, message %s@%s:%d (%d octets)\n"
-msgstr ""
-"no fue posible recibir los encabezados, mensaje %s@%s:%d (%d octetos)\n"
+msgstr "no fue posible recibir los encabezados, mensaje %s@%s:%d (%d octetos)\n"
 
 #: driver.c:619
 #, c-format
@@ -140,11 +133,8 @@
 
 #: driver.c:751
 #, c-format
-msgid ""
-"message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
-msgstr ""
-"el mensaje %s@%s:%d no ten??a la longitud esperada (%d actual != %d "
-"esperada)\n"
+msgid "message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
+msgstr "el mensaje %s@%s:%d no ten??a la longitud esperada (%d actual != %d esperada)\n"
 
 #: driver.c:783
 msgid " retained\n"
@@ -161,21 +151,14 @@
 #: driver.c:828
 #, c-format
 msgid "fetchlimit %d reached; %d message left on server %s account %s\n"
-msgid_plural ""
-"fetchlimit %d reached; %d messages left on server %s account %s\n"
-msgstr[0] ""
-"l??mite de %d mensajes alcanzado; se dej?? %d mensaje en la cuenta %s del "
-"servidor %s\n"
-msgstr[1] ""
-"l??mite de %d mensajes alcanzado; se dejaron %d mensajes en la cuenta %s del "
-"servidor %s\n"
+msgid_plural "fetchlimit %d reached; %d messages left on server %s account %s\n"
+msgstr[0] "l??mite de %d mensajes alcanzado; se dej?? %d mensaje en la cuenta %s del servidor %s\n"
+msgstr[1] "l??mite de %d mensajes alcanzado; se dejaron %d mensajes en la cuenta %s del servidor %s\n"
 
 #: driver.c:885
 #, c-format
 msgid "timeout after %d seconds waiting to connect to server %s.\n"
-msgstr ""
-"tiempo agotado despu??s de %d segundos de espera para conectarse con el "
-"servidor %s.\n"
+msgstr "tiempo agotado despu??s de %d segundos de espera para conectarse con el servidor %s.\n"
 
 #: driver.c:889
 #, c-format
@@ -190,8 +173,7 @@
 #: driver.c:898
 #, c-format
 msgid "timeout after %d seconds waiting for listener to respond.\n"
-msgstr ""
-"tiempo agotado despu??s de %d segundos de esperar respuesta del cliente.\n"
+msgstr "tiempo agotado despu??s de %d segundos de esperar respuesta del cliente.\n"
 
 #: driver.c:901
 #, c-format
@@ -204,12 +186,8 @@
 
 #: driver.c:916
 #, c-format
-msgid ""
-"Fetchmail saw more than %d timeouts while attempting to get mail from %s@%"
-"s.\n"
-msgstr ""
-"Fetchmail vio m??s de %d excesos en el tiempo de espera mientras intentaba "
-"obtener correo de %s@%s.\n"
+msgid "Fetchmail saw more than %d timeouts while attempting to get mail from %s@%s.\n"
+msgstr "Fetchmail vio m??s de %d excesos en el tiempo de espera mientras intentaba obtener correo de %s@%s.\n"
 
 #: driver.c:920
 msgid ""
@@ -351,8 +329,7 @@
 "is restored."
 msgstr ""
 "El intento de obtener autorizaci??n fall??.\n"
-"Esto probablemente signifique que su contrase??a no es v??lida. Aunque "
-"algunos\n"
+"Esto probablemente signifique que su contrase??a no es v??lida. Aunque algunos\n"
 "servidores POP3 tienen otros modos de fallar que fetchmail no puede\n"
 "distinguir de ??ste porque no env??an mensajes de error ??tiles cuando se\n"
 "falla en el acceso.\n"
@@ -551,8 +528,7 @@
 msgid ""
 "%s: The NULLMAILER_FLAGS environment variable is set.\n"
 "This is dangerous as it can make nullmailer-inject or nullmailer's\n"
-"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: "
-"headers.\n"
+"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: headers.\n"
 "Try \"env NULLMAILER_FLAGS= %s YOUR ARGUMENTS HERE\"\n"
 "%s: Abort.\n"
 msgstr ""
@@ -580,20 +556,16 @@
 
 #: env.c:170
 msgid "Cannot find my own host in hosts database to qualify it!\n"
-msgstr ""
-"No puedo encontrar mi propio anfitri??n en la base de datos de anfitriones "
-"para cualificarlo.\n"
+msgstr "No puedo encontrar mi propio anfitri??n en la base de datos de anfitriones para cualificarlo.\n"
 
 #: env.c:174
 msgid ""
 "Trying to continue with unqualified hostname.\n"
-"DO NOT report broken Received: headers, HELO/EHLO lines or similar "
-"problems!\n"
+"DO NOT report broken Received: headers, HELO/EHLO lines or similar problems!\n"
 "DO repair your /etc/hosts, DNS, NIS or LDAP instead.\n"
 msgstr ""
 "Intentando continuar con un anfitri??n no cualificado.\n"
-"NO informe de cabeceras ??Received:?? rotas, l??neas HELO/EHLO o problemas "
-"similares\n"
+"NO informe de cabeceras ??Received:?? rotas, l??neas HELO/EHLO o problemas similares\n"
 "REPARE su /etc/hosts, DNS, NIS o LDAP.\n"
 
 #: etrn.c:49 odmr.c:60
@@ -663,14 +635,12 @@
 #: fetchmail.c:137
 msgid ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham Wilson\n"
 "Copyright (C) 2005 - 2006 Sunil Shetye\n"
 "Copyright (C) 2005 - 2009 Matthias Andree\n"
 msgstr ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham Wilson\n"
 "Copyright (C) 2005 - 2006 Sunil Shetye\n"
 "Copyright (C) 2005 - 2009 Matthias Andree\n"
 
@@ -681,8 +651,7 @@
 "please see the file COPYING in the source or documentation directory.\n"
 msgstr ""
 "Fetchmail viene SIN GARANT??A DE NINGUNA CLASE. Esto es software libre y se\n"
-"le anima a redistribuirlo bajo ciertas concidiones. Para conocer m??s "
-"detalles,\n"
+"le anima a redistribuirlo bajo ciertas concidiones. Para conocer m??s detalles,\n"
 "vea el archivo COPYING en la fuente o en el directorio de documentaci??n.\n"
 
 #: fetchmail.c:176
@@ -743,20 +712,13 @@
 msgstr "fetchmail: %s fetchmail (%d) terminado.\n"
 
 #: fetchmail.c:480
-msgid ""
-"fetchmail: can't check mail while another fetchmail to same host is "
-"running.\n"
-msgstr ""
-"fetchmail: no es posible verificar el correo mientras otro fetchmail est?? en "
-"ejecuci??n hacia el mismo anfitri??n\n"
+msgid "fetchmail: can't check mail while another fetchmail to same host is running.\n"
+msgstr "fetchmail: no es posible verificar el correo mientras otro fetchmail est?? en ejecuci??n hacia el mismo anfitri??n\n"
 
 #: fetchmail.c:486
 #, c-format
-msgid ""
-"fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
-msgstr ""
-"fetchmail: no es posible consultar los anfitriones especificados con otro "
-"fetchmail (%d) en ejecuci??n.\n"
+msgid "fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
+msgstr "fetchmail: no es posible consultar los anfitriones especificados con otro fetchmail (%d) en ejecuci??n.\n"
 
 #: fetchmail.c:493
 #, c-format
@@ -764,11 +726,8 @@
 msgstr "fetchmail: otro fetchmail (%d) est?? en ejecuci??n en primer plano.\n"
 
 #: fetchmail.c:503
-msgid ""
-"fetchmail: can't accept options while a background fetchmail is running.\n"
-msgstr ""
-"fetchmail: no es posible aceptar opciones mientras un fetchmail est?? en "
-"ejecuci??n en segundo plano.\n"
+msgid "fetchmail: can't accept options while a background fetchmail is running.\n"
+msgstr "fetchmail: no es posible aceptar opciones mientras un fetchmail est?? en ejecuci??n en segundo plano.\n"
 
 #: fetchmail.c:509
 #, c-format
@@ -806,9 +765,7 @@
 
 #: fetchmail.c:606
 msgid "fetchmail: Warning: syslog and logfile are set. Check both for logs!\n"
-msgstr ""
-"fetchmail: Aviso: syslog y logfile est??n establecidos. Compruebe ambos "
-"registros\n"
+msgstr "fetchmail: Aviso: syslog y logfile est??n establecidos. Compruebe ambos registros\n"
 
 #: fetchmail.c:625
 msgid "--check mode enabled, not fetching mail\n"
@@ -826,9 +783,7 @@
 
 #: fetchmail.c:657
 msgid "attempt to re-exec may fail as directory has not been restored\n"
-msgstr ""
-"el intento de volver a ejectuar puede fallar dado que el directorio no se ha "
-"restaurado\n"
+msgstr "el intento de volver a ejectuar puede fallar dado que el directorio no se ha restaurado\n"
 
 #: fetchmail.c:684
 msgid "attempt to re-exec fetchmail failed\n"
@@ -837,9 +792,7 @@
 #: fetchmail.c:714
 #, c-format
 msgid "poll of %s skipped (failed authentication or too many timeouts)\n"
-msgstr ""
-"la consulta %s se omiti?? (fallo en la autenticaci??n o demasiados excesos de "
-"espera)\n"
+msgstr "la consulta %s se omiti?? (fallo en la autenticaci??n o demasiados excesos de espera)\n"
 
 #: fetchmail.c:726
 #, c-format
@@ -943,14 +896,11 @@
 #: fetchmail.c:1069
 #, c-format
 msgid "Warning: multiple mentions of host %s in config file\n"
-msgstr ""
-"Aviso: m??ltiples menciones del anfitri??n %s en el archivo de configuraci??n\n"
+msgstr "Aviso: m??ltiples menciones del anfitri??n %s en el archivo de configuraci??n\n"
 
 #: fetchmail.c:1102
 msgid "fetchmail: Error: multiple \"defaults\" records in config file.\n"
-msgstr ""
-"fetchmail: Error: m??ltiples registros ??predeterminados?? en el archivo de "
-"configuraci??n.\n"
+msgstr "fetchmail: Error: m??ltiples registros ??predeterminados?? en el archivo de configuraci??n.\n"
 
 #: fetchmail.c:1224
 msgid "SSL support is not compiled in.\n"
@@ -970,11 +920,8 @@
 
 #: fetchmail.c:1273
 #, c-format
-msgid ""
-"fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
-msgstr ""
-"fetchmail: aviso: no hay DNS disponible para verificar recepciones "
-"??multidrop?? de %s\n"
+msgid "fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
+msgstr "fetchmail: aviso: no hay DNS disponible para verificar recepciones ??multidrop?? de %s\n"
 
 #: fetchmail.c:1284
 #, c-format
@@ -983,38 +930,26 @@
 
 #: fetchmail.c:1285
 msgid "warning: Do not ask for support if all mail goes to postmaster!\n"
-msgstr ""
-"aviso: ??no pida soporte t??cnico si todo el correo est?? dirigido al "
-"postmaster!\n"
+msgstr "aviso: ??no pida soporte t??cnico si todo el correo est?? dirigido al postmaster!\n"
 
 #: fetchmail.c:1302
 #, c-format
-msgid ""
-"fetchmail: %s configuration invalid, specify positive port number for "
-"service or port\n"
-msgstr ""
-"fetchmail: la configuraci??n %s no es v??lida, especifique un n??mero de puerto "
-"positivo para el servicio el puerto\n"
+msgid "fetchmail: %s configuration invalid, specify positive port number for service or port\n"
+msgstr "fetchmail: la configuraci??n %s no es v??lida, especifique un n??mero de puerto positivo para el servicio el puerto\n"
 
 #: fetchmail.c:1309
 #, c-format
 msgid "fetchmail: %s configuration invalid, RPOP requires a privileged port\n"
-msgstr ""
-"fetchmail: la configuraci??n %s no es v??lida, RPOP requiere un puerto "
-"privilegiado\n"
+msgstr "fetchmail: la configuraci??n %s no es v??lida, RPOP requiere un puerto privilegiado\n"
 
 #: fetchmail.c:1327
 #, c-format
 msgid "%s configuration invalid, LMTP can't use default SMTP port\n"
-msgstr ""
-"configuraci??n de %s inv??lida, LMTP no puede usar el puerto SMTP "
-"predeterminado\n"
+msgstr "configuraci??n de %s inv??lida, LMTP no puede usar el puerto SMTP predeterminado\n"
 
 #: fetchmail.c:1341
 msgid "Both fetchall and keep on in daemon or idle mode is a mistake!\n"
-msgstr ""
-"Ambos, ??fetchall?? y ??keep on?? en el demonio o en el modo de espera, es un "
-"error\n"
+msgstr "Ambos, ??fetchall?? y ??keep on?? en el demonio o en el modo de espera, es un error\n"
 
 #: fetchmail.c:1366
 #, c-format
@@ -1080,8 +1015,7 @@
 
 #: fetchmail.c:1546
 msgid "Fetchmail will show progress dots even in logfiles.\n"
-msgstr ""
-"Fetchmail mostrar?? puntos de progreso incluso en los archivos de registro.\n"
+msgstr "Fetchmail mostrar?? puntos de progreso incluso en los archivos de registro.\n"
 
 #: fetchmail.c:1548
 #, c-format
@@ -1098,15 +1032,11 @@
 
 #: fetchmail.c:1557
 msgid "Fetchmail will treat permanent errors as permanent (drop messsages).\n"
-msgstr ""
-"Fetchmail tratar?? los errores permanentes como permanentes (soltar "
-"mensajes).\n"
+msgstr "Fetchmail tratar?? los errores permanentes como permanentes (soltar mensajes).\n"
 
 #: fetchmail.c:1559
 msgid "Fetchmail will treat permanent errors as temporary (keep messages).\n"
-msgstr ""
-"Fetchmail tratar?? los errores permanentes como temporales (mantener "
-"mensajes).\n"
+msgstr "Fetchmail tratar?? los errores permanentes como temporales (mantener mensajes).\n"
 
 #: fetchmail.c:1566
 #, c-format
@@ -1132,13 +1062,11 @@
 
 #: fetchmail.c:1580
 msgid "  This host will not be queried when no host is specified.\n"
-msgstr ""
-"  Este anfitri??n no ser?? consultado cuando no se especifica un anfitri??n.\n"
+msgstr "  Este anfitri??n no ser?? consultado cuando no se especifica un anfitri??n.\n"
 
 #: fetchmail.c:1581
 msgid "  This host will be queried when no host is specified.\n"
-msgstr ""
-"  Este anfitri??n ser?? consultado cuando no se especifique ning??n anfitri??n.\n"
+msgstr "  Este anfitri??n ser?? consultado cuando no se especifique ning??n anfitri??n.\n"
 
 #: fetchmail.c:1585
 msgid "  Password will be prompted for.\n"
@@ -1253,8 +1181,7 @@
 #: fetchmail.c:1664
 #, c-format
 msgid "  SSL key fingerprint (checked against the server key): %s\n"
-msgstr ""
-"  Huella digital de la clave SSL (comprobada con la clave del servidor): %s\n"
+msgstr "  Huella digital de la clave SSL (comprobada con la clave del servidor): %s\n"
 
 #: fetchmail.c:1667
 #, c-format
@@ -1291,32 +1218,19 @@
 
 #: fetchmail.c:1693
 msgid "  Old messages will be flushed before message retrieval (--flush on).\n"
-msgstr ""
-"  Los mensajes viejos ser??n eliminados antes de recibir nuevos (--flush "
-"on).\n"
+msgstr "  Los mensajes viejos ser??n eliminados antes de recibir nuevos (--flush on).\n"
 
 #: fetchmail.c:1694
-msgid ""
-"  Old messages will not be flushed before message retrieval (--flush off).\n"
-msgstr ""
-"  No se eliminar??n los mensajes viejos antes de recibir nuevos (--flush "
-"off).\n"
+msgid "  Old messages will not be flushed before message retrieval (--flush off).\n"
+msgstr "  No se eliminar??n los mensajes viejos antes de recibir nuevos (--flush off).\n"
 
 #: fetchmail.c:1696
-msgid ""
-"  Oversized messages will be flushed before message retrieval (--limitflush "
-"on).\n"
-msgstr ""
-"  Los mensajes demasiado grandes se eliminar??n antes de recibir nuevos (--"
-"limitflush on).\n"
+msgid "  Oversized messages will be flushed before message retrieval (--limitflush on).\n"
+msgstr "  Los mensajes demasiado grandes se eliminar??n antes de recibir nuevos (--limitflush on).\n"
 
 #: fetchmail.c:1697
-msgid ""
-"  Oversized messages will not be flushed before message retrieval (--"
-"limitflush off).\n"
-msgstr ""
-"  Los mensajes demasiado garndes no se eliminar??n antes de recibir nuevos (--"
-"limitflush off).\n"
+msgid "  Oversized messages will not be flushed before message retrieval (--limitflush off).\n"
+msgstr "  Los mensajes demasiado garndes no se eliminar??n antes de recibir nuevos (--limitflush off).\n"
 
 #: fetchmail.c:1699
 msgid "  Rewrite of server-local addresses is enabled (--norewrite off).\n"
@@ -1343,16 +1257,12 @@
 msgstr "  No se a??adir??n retornos de carro (forcecr off).\n"
 
 #: fetchmail.c:1708
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
-msgstr ""
-"  Se ignorar?? el contenido de ??Content-Transfer-Encoding?? (pass8bits on).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
+msgstr "  Se ignorar?? el contenido de ??Content-Transfer-Encoding?? (pass8bits on).\n"
 
 #: fetchmail.c:1709
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
-msgstr ""
-"  Se respetar?? el contenido de ??Content-Transfer-Encoding?? (pass8bits off).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
+msgstr "  Se respetar?? el contenido de ??Content-Transfer-Encoding?? (pass8bits off).\n"
 
 #: fetchmail.c:1711
 msgid "  MIME decoding is enabled (mimedecode on).\n"
@@ -1372,13 +1282,11 @@
 
 #: fetchmail.c:1717
 msgid "  Nonempty Status lines will be discarded (dropstatus on)\n"
-msgstr ""
-"  Las l??neas ??Status?? que no est??n vac??as se descartar??n (dropstatus on).\n"
+msgstr "  Las l??neas ??Status?? que no est??n vac??as se descartar??n (dropstatus on).\n"
 
 #: fetchmail.c:1718
 msgid "  Nonempty Status lines will be kept (dropstatus off)\n"
-msgstr ""
-"  Las l??neas ??Status?? que no est??n vac??as se conservar??n (dropstatus off).\n"
+msgstr "  Las l??neas ??Status?? que no est??n vac??as se conservar??n (dropstatus off).\n"
 
 #: fetchmail.c:1720
 msgid "  Delivered-To lines will be discarded (dropdelivered on)\n"
@@ -1400,33 +1308,25 @@
 #: fetchmail.c:1730
 #, c-format
 msgid "  Message size warning interval is %d seconds (--warnings %d).\n"
-msgstr ""
-"  Los avisos sobre el tama??o de los mensajes se dar??n cada %d segundos (--"
-"warnings %d).\n"
+msgstr "  Los avisos sobre el tama??o de los mensajes se dar??n cada %d segundos (--warnings %d).\n"
 
 #: fetchmail.c:1733
 msgid "  Size warnings on every poll (--warnings 0).\n"
-msgstr ""
-"  Los avisos sobre el tama??o de los mensajes se dar??n en cada consulta (--"
-"warnings 0).\n"
+msgstr "  Los avisos sobre el tama??o de los mensajes se dar??n en cada consulta (--warnings 0).\n"
 
 #: fetchmail.c:1736
 #, c-format
 msgid "  Received-message limit is %d (--fetchlimit %d).\n"
-msgstr ""
-"  La cantidad de mensajes recibidos est?? limitada a %d (--fetchlimit %d).\n"
+msgstr "  La cantidad de mensajes recibidos est?? limitada a %d (--fetchlimit %d).\n"
 
 #: fetchmail.c:1739
 msgid "  No received-message limit (--fetchlimit 0).\n"
-msgstr ""
-"  La cantidad de mensajes recibidos no est?? limitada (--fetchlimit 0).\n"
+msgstr "  La cantidad de mensajes recibidos no est?? limitada (--fetchlimit 0).\n"
 
 #: fetchmail.c:1741
 #, c-format
 msgid "  Fetch message size limit is %d (--fetchsizelimit %d).\n"
-msgstr ""
-"  El l??mite de tama??o para los mensajes recibidos es de %d (--fetchsizelimit "
-"%d).\n"
+msgstr "  El l??mite de tama??o para los mensajes recibidos es de %d (--fetchsizelimit %d).\n"
 
 #: fetchmail.c:1744
 msgid "  No fetch message size limit (--fetchsizelimit 0).\n"
@@ -1434,20 +1334,16 @@
 
 #: fetchmail.c:1748
 msgid "  Do binary search of UIDs during each poll (--fastuidl 1).\n"
-msgstr ""
-"  Utilizar b??squeda binaria de UID durante cada consulta (--fastuidl 1).\n"
+msgstr "  Utilizar b??squeda binaria de UID durante cada consulta (--fastuidl 1).\n"
 
 #: fetchmail.c:1750
 #, c-format
 msgid "  Do binary search of UIDs during %d out of %d polls (--fastuidl %d).\n"
-msgstr ""
-"  Utilizar b??squeda binaria de UID durante %d de cada %d consultas (--"
-"fastuidl %d).\n"
+msgstr "  Utilizar b??squeda binaria de UID durante %d de cada %d consultas (--fastuidl %d).\n"
 
 #: fetchmail.c:1753
 msgid "   Do linear search of UIDs during each poll (--fastuidl 0).\n"
-msgstr ""
-"  Utilizar b??squeda lineal de UID durante cada consulta (--fastuidl 0).\n"
+msgstr "  Utilizar b??squeda lineal de UID durante cada consulta (--fastuidl 0).\n"
 
 #: fetchmail.c:1755
 #, c-format
@@ -1456,15 +1352,12 @@
 
 #: fetchmail.c:1757
 msgid "  No SMTP message batch limit (--batchlimit 0).\n"
-msgstr ""
-"  La cantidad de mensajes emitidos no est?? limitada (--batchlimit 0).\n"
+msgstr "  La cantidad de mensajes emitidos no est?? limitada (--batchlimit 0).\n"
 
 #: fetchmail.c:1761
 #, c-format
 msgid "  Deletion interval between expunges forced to %d (--expunge %d).\n"
-msgstr ""
-"  El intervalo de borrado entre eliminaciones est?? forzado a %d (--expunge %"
-"d).\n"
+msgstr "  El intervalo de borrado entre eliminaciones est?? forzado a %d (--expunge %d).\n"
 
 #: fetchmail.c:1763
 msgid "  No forced expunges (--expunge 0).\n"
@@ -1501,8 +1394,7 @@
 #: fetchmail.c:1803
 #, c-format
 msgid "  Address to be put in RCPT TO lines shipped to SMTP will be %s\n"
-msgstr ""
-"  La direcci??n a poner en las l??neas RCPT TO enviadas al STMP ser?? %s\n"
+msgstr "  La direcci??n a poner en las l??neas RCPT TO enviadas al STMP ser?? %s\n"
 
 #: fetchmail.c:1812
 msgid "  Recognized listener spam block responses are:"
@@ -1558,17 +1450,12 @@
 msgstr "  No se consultar?? al DNS por las direcciones ??multidrop??.\n"
 
 #: fetchmail.c:1866
-msgid ""
-"  Server aliases will be compared with multidrop addresses by IP address.\n"
-msgstr ""
-"  Se comparar?? la direcci??n IP de los alias del servidor contra las "
-"direcciones ??multidrop??.\n"
+msgid "  Server aliases will be compared with multidrop addresses by IP address.\n"
+msgstr "  Se comparar?? la direcci??n IP de los alias del servidor contra las direcciones ??multidrop??.\n"
 
 #: fetchmail.c:1868
 msgid "  Server aliases will be compared with multidrop addresses by name.\n"
-msgstr ""
-"  Se comparar?? el nombre de los alias del servidor contra las direcciones "
-"??multidrop??.\n"
+msgstr "  Se comparar?? el nombre de los alias del servidor contra las direcciones ??multidrop??.\n"
 
 #: fetchmail.c:1871
 msgid "  Envelope-address routing is disabled\n"
@@ -1622,9 +1509,7 @@
 #: fetchmail.c:1919
 #, c-format
 msgid "  Server connections will be made via plugin %s (--plugin %s).\n"
-msgstr ""
-"  Las conexiones al servidor se llevar??n a cabo a trav??s del complemento %s "
-"(--plugin %s).\n"
+msgstr "  Las conexiones al servidor se llevar??n a cabo a trav??s del complemento %s (--plugin %s).\n"
 
 #: fetchmail.c:1921
 msgid "  No plugin command specified.\n"
@@ -1633,9 +1518,7 @@
 #: fetchmail.c:1923
 #, c-format
 msgid "  Listener connections will be made via plugout %s (--plugout %s).\n"
-msgstr ""
-"  Las conexiones al cliente se llevar??n a cabo a trav??s del ??plugout?? %s (--"
-"plugout %s).\n"
+msgstr "  Las conexiones al cliente se llevar??n a cabo a trav??s del ??plugout?? %s (--plugout %s).\n"
 
 #: fetchmail.c:1925
 msgid "  No plugout command specified.\n"
@@ -1652,17 +1535,13 @@
 
 #: fetchmail.c:1947
 msgid "  Poll trace information will be added to the Received header.\n"
-msgstr ""
-"  Se a??adir?? informaci??n de traceado sobre la consulta al encabezado "
-"??Received??.\n"
+msgstr "  Se a??adir?? informaci??n de traceado sobre la consulta al encabezado ??Received??.\n"
 
 #: fetchmail.c:1949
 msgid ""
 "  No poll trace information will be added to the Received header.\n"
 ".\n"
-msgstr ""
-"  No se a??adir?? informaci??n de traceado sobre la consulta al encabezado "
-"??Received??.\n"
+msgstr "  No se a??adir?? informaci??n de traceado sobre la consulta al encabezado ??Received??.\n"
 
 #: fetchmail.c:1952
 #, c-format
@@ -1834,17 +1713,12 @@
 msgstr "%u es el primero que no fue visto\n"
 
 #: imap.c:1002
-msgid ""
-"Warning: ignoring bogus data for message sizes returned by the server.\n"
-msgstr ""
-"Aviso: ignorando datos de errores para los tama??os de mensaje devueltos por "
-"el servidor.\n"
+msgid "Warning: ignoring bogus data for message sizes returned by the server.\n"
+msgstr "Aviso: ignorando datos de errores para los tama??os de mensaje devueltos por el servidor.\n"
 
 #: interface.c:256
 msgid "Unable to open kvm interface. Make sure fetchmail is SGID kmem."
-msgstr ""
-"No es posible abrir la interfaz kvm. Aseg??rese de que fetchmail este SGID "
-"kmem."
+msgstr "No es posible abrir la interfaz kvm. Aseg??rese de que fetchmail este SGID kmem."
 
 #: interface.c:396
 #, c-format
@@ -2090,14 +1964,11 @@
 
 #: options.c:608
 msgid "  -v, --verbose     work noisily (diagnostic output)\n"
-msgstr ""
-"  -v, --verbose     trabajar ruidosamente (informaci??n de diagn??stico)\n"
+msgstr "  -v, --verbose     trabajar ruidosamente (informaci??n de diagn??stico)\n"
 
 #: options.c:609
 msgid "  -d, --daemon      run as a daemon once per n seconds\n"
-msgstr ""
-"  -d, --daemon      correr en segundo plano y activarse una vez cada n "
-"segundos\n"
+msgstr "  -d, --daemon      correr en segundo plano y activarse una vez cada n segundos\n"
 
 #: options.c:610
 msgid "  -N, --nodetach    don't detach daemon process\n"
@@ -2112,23 +1983,16 @@
 msgstr "  -L, --logfile     especificar el nombre del archivo de registro\n"
 
 #: options.c:613
-msgid ""
-"      --syslog      use syslog(3) for most messages when running as a "
-"daemon\n"
-msgstr ""
-"      --syslog      usar syslog(3) para la mayor??a de los mensajes cuando se "
-"ejecuta en segundo plano\n"
+msgid "      --syslog      use syslog(3) for most messages when running as a daemon\n"
+msgstr "      --syslog      usar syslog(3) para la mayor??a de los mensajes cuando se ejecuta en segundo plano\n"
 
 #: options.c:614
 msgid "      --invisible   don't write Received & enable host spoofing\n"
-msgstr ""
-"      --invisible   no escribir ??Received?? y activar falsificaci??n del "
-"anfitri??n\n"
+msgstr "      --invisible   no escribir ??Received?? y activar falsificaci??n del anfitri??n\n"
 
 #: options.c:615
 msgid "  -f, --fetchmailrc specify alternate run control file\n"
-msgstr ""
-"  -f, --fetchmailrc especificar archivo de control de ejecuci??n alterno\n"
+msgstr "  -f, --fetchmailrc especificar archivo de control de ejecuci??n alterno\n"
 
 #: options.c:616
 msgid "  -i, --idfile      specify alternate UIDs file\n"
@@ -2147,19 +2011,12 @@
 msgstr "      --nobounce    redirigir rebotes del usuario al postmaster.\n"
 
 #: options.c:620
-msgid ""
-"      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
-msgstr ""
-"      --nosoftbounce fetchmail borra permanentemente los mensajes que no se "
-"pueden entregar.\n"
+msgid "      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
+msgstr "      --nosoftbounce fetchmail borra permanentemente los mensajes que no se pueden entregar.\n"
 
 #: options.c:621
-msgid ""
-"      --softbounce  keep permanently undeliverable messages on server "
-"(default).\n"
-msgstr ""
-"      --softbounce  mantiene permanentemente los mensajes que no se pueden "
-"entregar en el servidor (predeterminado).\n"
+msgid "      --softbounce  keep permanently undeliverable messages on server (default).\n"
+msgstr "      --softbounce  mantiene permanentemente los mensajes que no se pueden entregar en el servidor (predeterminado).\n"
 
 #: options.c:623
 msgid "  -I, --interface   interface required specification\n"
@@ -2183,28 +2040,19 @@
 
 #: options.c:630
 msgid "      --sslcertck   do strict server certificate check (recommended)\n"
-msgstr ""
-"      --sslcert     comprobaci??n estricta del certificado del servidor "
-"(recomendado)\n"
+msgstr "      --sslcert     comprobaci??n estricta del certificado del servidor (recomendado)\n"
 
 #: options.c:631
 msgid "      --sslcertpath path to ssl certificates\n"
 msgstr "      --sslcertpath ubicaci??n de los certificados ssl\n"
 
 #: options.c:632
-msgid ""
-"      --sslcommonname  expect this CommonName from server (discouraged)\n"
-msgstr ""
-"      --sslcommonname  esperar este ??CommonName?? del servidor "
-"(desaconsejado)\n"
+msgid "      --sslcommonname  expect this CommonName from server (discouraged)\n"
+msgstr "      --sslcommonname  esperar este ??CommonName?? del servidor (desaconsejado)\n"
 
 #: options.c:633
-msgid ""
-"      --sslfingerprint fingerprint that must match that of the server's "
-"cert.\n"
-msgstr ""
-"      --sslfingerprint huella digital que debe coincidir con la del "
-"certificado del servidor.\n"
+msgid "      --sslfingerprint fingerprint that must match that of the server's cert.\n"
+msgstr "      --sslfingerprint huella digital que debe coincidir con la del certificado del servidor.\n"
 
 #: options.c:634
 msgid "      --sslproto    force ssl protocol (SSL2/SSL3/TLS1)\n"
@@ -2212,19 +2060,15 @@
 
 #: options.c:636
 msgid "      --plugin      specify external command to open connection\n"
-msgstr ""
-"      --plugin      especificar la orden externa para abrir una conexi??n\n"
+msgstr "      --plugin      especificar la orden externa para abrir una conexi??n\n"
 
 #: options.c:637
 msgid "      --plugout     specify external command to open smtp connection\n"
-msgstr ""
-"      --plugout     especificar la orden externa para abrir una conexi??n "
-"smtp\n"
+msgstr "      --plugout     especificar la orden externa para abrir una conexi??n smtp\n"
 
 #: options.c:639
 msgid "  -p, --protocol    specify retrieval protocol (see man page)\n"
-msgstr ""
-"  -p, --protocol    especificar el protocolo de recepci??n (ver p??gina man)\n"
+msgstr "  -p, --protocol    especificar el protocolo de recepci??n (ver p??gina man)\n"
 
 #: options.c:640
 msgid "  -U, --uidl        force the use of UIDLs (pop3 only)\n"
@@ -2235,16 +2079,12 @@
 msgstr "      --port        Puerto TCP a conectar (obsoleto, use --service)\n"
 
 #: options.c:642
-msgid ""
-"  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
-msgstr ""
-"  -P, --service     Servicio TCP al que conectarse (puede ser un puerto TCP "
-"num??rico)\n"
+msgid "  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
+msgstr "  -P, --service     Servicio TCP al que conectarse (puede ser un puerto TCP num??rico)\n"
 
 #: options.c:643
 msgid "      --auth        authentication type (password/kerberos/ssh/otp)\n"
-msgstr ""
-"      --auth        tipo de autenticaci??n (contrase??a/kerberos/ssh/otp)\n"
+msgstr "      --auth        tipo de autenticaci??n (contrase??a/kerberos/ssh/otp)\n"
 
 #: options.c:644
 msgid "  -t, --timeout     server nonresponse timeout\n"
@@ -2256,9 +2096,7 @@
 
 #: options.c:646
 msgid "  -Q, --qvirtual    prefix to remove from local user id\n"
-msgstr ""
-"  -Q, --qvirtual    prefijo a eliminar de la identificaci??n local del "
-"usuario\n"
+msgstr "  -Q, --qvirtual    prefijo a eliminar de la identificaci??n local del usuario\n"
 
 #: options.c:647
 msgid "      --principal   mail service principal\n"
@@ -2266,9 +2104,7 @@
 
 #: options.c:648
 msgid "      --tracepolls  add poll-tracing information to Received header\n"
-msgstr ""
-"      --tracepolls  a??adir informaci??n sobre traceado de consultas al "
-"encabezado ??Received??\n"
+msgstr "      --tracepolls  a??adir informaci??n sobre traceado de consultas al encabezado ??Received??\n"
 
 #: options.c:650
 msgid "  -u, --username    specify users's login on server\n"
@@ -2300,8 +2136,7 @@
 
 #: options.c:657
 msgid "  -l, --limit       don't fetch messages over given size\n"
-msgstr ""
-"  -l, --limit       no recibir mensajes m??s grandes de lo especificado\n"
+msgstr "  -l, --limit       no recibir mensajes m??s grandes de lo especificado\n"
 
 #: options.c:658
 msgid "  -w, --warnings    interval between warning mail notification\n"
@@ -2321,9 +2156,7 @@
 
 #: options.c:663
 msgid "      --smtpname    set SMTP full name username at domain\n"
-msgstr ""
-"      --smtpname    usar nombreusuario at dominio como nombre completo para "
-"SMTP\n"
+msgstr "      --smtpname    usar nombreusuario at dominio como nombre completo para SMTP\n"
 
 #: options.c:664
 msgid "  -Z, --antispam,   set antispam response values\n"
@@ -2331,15 +2164,11 @@
 
 #: options.c:665
 msgid "  -b, --batchlimit  set batch limit for SMTP connections\n"
-msgstr ""
-"  -b, --batchlimit  configurar el l??mite de mensajes para las conexiones "
-"SMTP\n"
+msgstr "  -b, --batchlimit  configurar el l??mite de mensajes para las conexiones SMTP\n"
 
 #: options.c:666
 msgid "  -B, --fetchlimit  set fetch limit for server connections\n"
-msgstr ""
-"  -B, --fetchlimit  configurar el l??mite de mensajes para las conexiones al "
-"servidor\n"
+msgstr "  -B, --fetchlimit  configurar el l??mite de mensajes para las conexiones al servidor\n"
 
 #: options.c:667
 msgid "      --fetchsizelimit set fetch message size limit\n"
@@ -2351,9 +2180,7 @@
 
 #: options.c:669
 msgid "  -e, --expunge     set max deletions between expunges\n"
-msgstr ""
-"  -e, --expunge     configurar la cantidad de mensajes borrados entre "
-"eliminaciones\n"
+msgstr "  -e, --expunge     configurar la cantidad de mensajes borrados entre eliminaciones\n"
 
 #: options.c:670
 msgid "  -m, --mda         set MDA to use for forwarding\n"
@@ -2373,22 +2200,15 @@
 
 #: options.c:674
 msgid "      --showdots    show progress dots even in logfiles\n"
-msgstr ""
-"      --showdots    mostrar puntos de progreso incluso en los archivos de "
-"registro\n"
+msgstr "      --showdots    mostrar puntos de progreso incluso en los archivos de registro\n"
 
 #: pop3.c:355
-msgid ""
-"Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead "
-"of TOP.\n"
-msgstr ""
-"Aviso: ??Servidor Maillennium POP3/PROXYr?? encontrado. use la orden RETR en "
-"vez de TOP.\n"
+msgid "Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead of TOP.\n"
+msgstr "Aviso: ??Servidor Maillennium POP3/PROXYr?? encontrado. use la orden RETR en vez de TOP.\n"
 
 #: pop3.c:454
 msgid "TLS is mandatory for this session, but server refused CAPA command.\n"
-msgstr ""
-"TLS es obligatorio para esta sesi??n, pero el servidor rechaza la orden CAPA\n"
+msgstr "TLS es obligatorio para esta sesi??n, pero el servidor rechaza la orden CAPA\n"
 
 #: pop3.c:455
 msgid "The CAPA command is however necessary for TLS.\n"
@@ -2443,8 +2263,7 @@
 
 #: pop3.c:965
 msgid "Messages inserted into list on server. Cannot handle this.\n"
-msgstr ""
-"Mensajes insertados en una lista en el servidor. No se puede manejar esto.\n"
+msgstr "Mensajes insertados en una lista en el servidor. No se puede manejar esto.\n"
 
 #: pop3.c:1057
 msgid "protocol error\n"
@@ -2467,20 +2286,12 @@
 msgstr "SDPS no activado."
 
 #: rcfile_y.y:215
-msgid ""
-"fetchmail: interface option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: la opci??n ??interface?? solo est?? permitida bajo Linux (sin IPv6) y "
-"FreeBSD\n"
+msgid "fetchmail: interface option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: la opci??n ??interface?? solo est?? permitida bajo Linux (sin IPv6) y FreeBSD\n"
 
 #: rcfile_y.y:222
-msgid ""
-"fetchmail: monitor option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: la opci??n ??monitor?? s??lo est?? permitida bajo Linux (sin IPv6) y "
-"FreeBSD\n"
+msgid "fetchmail: monitor option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: la opci??n ??monitor?? s??lo est?? permitida bajo Linux (sin IPv6) y FreeBSD\n"
 
 #: rcfile_y.y:335
 msgid "SSL is not enabled"
@@ -2759,8 +2570,7 @@
 #: sink.c:997
 #, c-format
 msgid "%cMTP listener doesn't really like recipient address `%s'\n"
-msgstr ""
-"Al servidor %cMTP realmente no le gusta la direcci??n de recipiente ??%s??\n"
+msgstr "Al servidor %cMTP realmente no le gusta la direcci??n de recipiente ??%s??\n"
 
 #: sink.c:1043
 msgid "no address matches; no postmaster set.\n"
@@ -2812,10 +2622,8 @@
 
 #: sink.c:1373
 #, c-format
-msgid ""
-"Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
-msgstr ""
-"Extra??o: MDA pclose devolvi?? %d y errno %d/%s, no se puede manejar en %s:%d\n"
+msgid "Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
+msgstr "Extra??o: MDA pclose devolvi?? %d y errno %d/%s, no se puede manejar en %s:%d\n"
 
 #: sink.c:1395
 msgid "Message termination or close of BSMTP file failed\n"
@@ -2904,8 +2712,7 @@
 
 #: socket.c:289
 msgid "Try adding the --service option (see also FAQ item R12).\n"
-msgstr ""
-"Intentando a??adir la opci??n --service (vea tambi??n FAQ elemento R12).\n"
+msgstr "Intentando a??adir la opci??n --service (vea tambi??n FAQ elemento R12).\n"
 
 #: socket.c:300 socket.c:303
 #, c-format
@@ -2942,9 +2749,7 @@
 
 #: socket.c:619
 msgid "Warning: Issuer Organization Name too long (possibly truncated).\n"
-msgstr ""
-"Aviso: el nombre de la organizaci??n emisora es muy largo (posiblemente "
-"truncado).\n"
+msgstr "Aviso: el nombre de la organizaci??n emisora es muy largo (posiblemente truncado).\n"
 
 #: socket.c:621
 msgid "Unknown Organization\n"
@@ -2957,8 +2762,7 @@
 
 #: socket.c:626
 msgid "Warning: Issuer CommonName too long (possibly truncated).\n"
-msgstr ""
-"Aviso: el ??CommonName?? del emisor es muy largo (posiblemente truncado).\n"
+msgstr "Aviso: el ??CommonName?? del emisor es muy largo (posiblemente truncado).\n"
 
 #: socket.c:628
 msgid "Unknown Issuer CommonName\n"
@@ -2974,19 +2778,17 @@
 msgstr "Certificado incorrecto: el ??CommonName?? del asunto es muy largo.\n"
 
 #: socket.c:643
-#, fuzzy
 msgid "Bad certificate: Subject CommonName contains NUL, aborting!\n"
-msgstr "Certificado incorrecto: el ??CommonName?? del asunto es muy largo.\n"
+msgstr "Certificado incorrecto: el ??CommonName?? del asunto contiene NUL, abortando.\n"
 
 #: socket.c:664
 #, c-format
 msgid "Subject Alternative Name: %s\n"
-msgstr ""
+msgstr "Nombre alternativo del asunto: %s\n"
 
 #: socket.c:670
-#, fuzzy
 msgid "Bad certificate: Subject Alternative Name contains NUL, aborting!\n"
-msgstr "Certificado incorrecto: el ??CommonName?? del asunto es muy largo.\n"
+msgstr "Certificado incorrecto: El nombre alternativo del asunto contiene NUL, abortando.\n"
 
 #: socket.c:698
 #, c-format
@@ -2995,9 +2797,7 @@
 
 #: socket.c:705
 msgid "Server name not set, could not verify certificate!\n"
-msgstr ""
-"El nombre de servidor no fue configurado, ??no fue posible verificar el "
-"certificado!\n"
+msgstr "El nombre de servidor no fue configurado, ??no fue posible verificar el certificado!\n"
 
 #: socket.c:710
 msgid "Unknown Server CommonName\n"
@@ -3049,16 +2849,13 @@
 msgstr "Descriptor de archivo fuera de rango para SSL"
 
 #: socket.c:866
-#, fuzzy, c-format
+#, c-format
 msgid "Invalid SSL protocol '%s' specified, using default (SSLv23).\n"
-msgstr ""
-"El protocolo SSL ??%s?? especificado es inv??lido, usando el predeterminado "
-"(SSLv23).\n"
+msgstr "El protocolo SSL ??%s?? especificado es inv??lido, usando el predeterminado (SSLv23).\n"
 
 #: socket.c:942
 msgid "Certificate/fingerprint verification was somehow skipped!\n"
-msgstr ""
-"??La verificaci??n de certificado/huella digital fue de alg??n modo omitida!\n"
+msgstr "??La verificaci??n de certificado/huella digital fue de alg??n modo omitida!\n"
 
 #: socket.c:1020
 msgid "Cygwin socket read retry\n"
@@ -3113,8 +2910,7 @@
 
 #: transact.c:592
 msgid "incorrect header line found while scanning headers\n"
-msgstr ""
-"encabezado incorrecto encontrado durante la exploraci??n de encabezados\n"
+msgstr "encabezado incorrecto encontrado durante la exploraci??n de encabezados\n"
 
 #: transact.c:594
 #, c-format
@@ -3136,8 +2932,7 @@
 
 #: transact.c:1277
 msgid "no recipient addresses matched declared local names"
-msgstr ""
-"ninguna direcci??n de destino coincidi?? con los nombres locales declarados"
+msgstr "ninguna direcci??n de destino coincidi?? con los nombres locales declarados"
 
 #: transact.c:1284
 #, c-format
@@ -3185,9 +2980,7 @@
 
 #: uid.c:556
 msgid "not swapping UID lists, no UIDs seen this query\n"
-msgstr ""
-"no se intercambian las listas de UID, no se encontraron UID en esta "
-"consulta\n"
+msgstr "no se intercambian las listas de UID, no se encontraron UID en esta consulta\n"
 
 #: uid.c:581
 msgid "discarding new UID list\n"
@@ -3209,9 +3002,7 @@
 #: uid.c:645
 #, c-format
 msgid "Error writing to fetchids file %s, old file left in place.\n"
-msgstr ""
-"Error escribiendo al archivo fetchids %s. Se dej?? el archivo original "
-"intacto.\n"
+msgstr "Error escribiendo al archivo fetchids %s. Se dej?? el archivo original intacto.\n"
 
 #: uid.c:649
 #, c-format
@@ -3232,8 +3023,7 @@
 msgstr "realloc fall??\n"
 
 #~ msgid "message delimiter found while scanning headers\n"
-#~ msgstr ""
-#~ "delimitador de mensajes encontrado durante la exploraci??n de encabezados\n"
+#~ msgstr "delimitador de mensajes encontrado durante la exploraci??n de encabezados\n"
 
 #~ msgid "SIGPIPE thrown from an MDA or a stream socket error\n"
 #~ msgstr "SIGPIPE lanzado desde un MDA o un error de socket de flujo\n"

Modified: branches/BRANCH_6-3/po/pl.po
===================================================================
--- branches/BRANCH_6-3/po/pl.po	2009-08-06 11:35:49 UTC (rev 5407)
+++ branches/BRANCH_6-3/po/pl.po	2009-08-06 20:33:02 UTC (rev 5408)
@@ -1,5 +1,5 @@
 # Polish translation for fetchmail.
-# Copyright (C) 1998, 2002, 2003, 2005 Eric S. Raymond (msgids)
+# Copyright (C) 1998, 2002, 2003, 2005, 2009 Eric S. Raymond (msgids)
 # This file is distributed under the same license as the fetchmail package.
 # Pawe? Krawczyk <kravietz at ceti.pl>, 1998-1999.
 # Jakub Bogusz <qboosh at pld-linux.org>, 2002-2009.
@@ -7,17 +7,16 @@
 #
 msgid ""
 msgstr ""
-"Project-Id-Version: fetchmail 6.3.10-pre1\n"
+"Project-Id-Version: fetchmail 6.3.11\n"
 "Report-Msgid-Bugs-To: fetchmail-devel at lists.berlios.de\n"
 "POT-Creation-Date: 2009-08-06 01:21+0200\n"
-"PO-Revision-Date: 2009-05-31 23:43+0200\n"
+"PO-Revision-Date: 2009-08-06 19:09+0200\n"
 "Last-Translator: Jakub Bogusz <qboosh at pld-linux.org>\n"
 "Language-Team: Polish <translation-team-pl at lists.sourceforge.net>\n"
 "MIME-Version: 1.0\n"
 "Content-Type: text/plain; charset=ISO-8859-2\n"
 "Content-Transfer-Encoding: 8bit\n"
-"Plural-Forms: nplurals=3; plural=(n==1 ? 0 : n%10>=2 && n%10<=4 && (n%100<10 "
-"|| n%100>=20) ? 1 : 2);\n"
+"Plural-Forms: nplurals=3; plural=(n==1 ? 0 : n%10>=2 && n%10<=4 && (n%100<10 || n%100>=20) ? 1 : 2);\n"
 
 #: checkalias.c:179
 #, c-format
@@ -68,15 +67,12 @@
 #: driver.c:339
 #, c-format
 msgid "The following oversized messages were deleted on server %s account %s:"
-msgstr ""
-"Nast?puj?ce zbyt du?e listy zosta?y usuni?te z konta %2$s na serwerze poczty "
-"%1$s:"
+msgstr "Nast?puj?ce zbyt du?e listy zosta?y usuni?te z konta %2$s na serwerze poczty %1$s:"
 
 #: driver.c:343
 #, c-format
 msgid "The following oversized messages remain on server %s account %s:"
-msgstr ""
-"Nast?puj?ce zbyt du?e listy pozosta?y na koncie %2$s na serwerze poczty %1$s:"
+msgstr "Nast?puj?ce zbyt du?e listy pozosta?y na koncie %2$s na serwerze poczty %1$s:"
 
 #: driver.c:362
 #, c-format
@@ -139,11 +135,8 @@
 
 #: driver.c:751
 #, c-format
-msgid ""
-"message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
-msgstr ""
-"d?ugo?? listu %s@%s:%d nie odpowiada d?ugo?ci zg?oszonej przez serwer (%d != "
-"%d)\n"
+msgid "message %s@%s:%d was not the expected length (%d actual != %d expected)\n"
+msgstr "d?ugo?? listu %s@%s:%d nie odpowiada d?ugo?ci zg?oszonej przez serwer (%d != %d)\n"
 
 #: driver.c:783
 msgid " retained\n"
@@ -160,23 +153,15 @@
 #: driver.c:828
 #, c-format
 msgid "fetchlimit %d reached; %d message left on server %s account %s\n"
-msgid_plural ""
-"fetchlimit %d reached; %d messages left on server %s account %s\n"
-msgstr[0] ""
-"limit pobranych list?w %d osi?gni?ty: %d pozosta? na serwerze %s na koncie %"
-"s\n"
-msgstr[1] ""
-"limit pobranych list?w %d osi?gni?ty: %d pozosta?y na serwerze %s na koncie %"
-"s\n"
-msgstr[2] ""
-"limit pobranych list?w %d osi?gni?ty: %d pozosta?o na serwerze %s na koncie %"
-"s\n"
+msgid_plural "fetchlimit %d reached; %d messages left on server %s account %s\n"
+msgstr[0] "limit pobranych list?w %d osi?gni?ty: %d pozosta? na serwerze %s na koncie %s\n"
+msgstr[1] "limit pobranych list?w %d osi?gni?ty: %d pozosta?y na serwerze %s na koncie %s\n"
+msgstr[2] "limit pobranych list?w %d osi?gni?ty: %d pozosta?o na serwerze %s na koncie %s\n"
 
 #: driver.c:885
 #, c-format
 msgid "timeout after %d seconds waiting to connect to server %s.\n"
-msgstr ""
-"limit czasu %d sekund przekroczony podczas oczekiwania na po??czenie z %s.\n"
+msgstr "limit czasu %d sekund przekroczony podczas oczekiwania na po??czenie z %s.\n"
 
 #: driver.c:889
 #, c-format
@@ -204,9 +189,7 @@
 
 #: driver.c:916
 #, c-format
-msgid ""
-"Fetchmail saw more than %d timeouts while attempting to get mail from %s@%"
-"s.\n"
+msgid "Fetchmail saw more than %d timeouts while attempting to get mail from %s@%s.\n"
 msgstr "Po %d timeoutach fetchmail nie m?g? pobra? poczty z %s@%s.\n"
 
 #: driver.c:920
@@ -531,8 +514,7 @@
 "%s: Abort.\n"
 msgstr ""
 "%s: Zmienna ?rodowiskowa QMAILINJECT jest ustawiona.\n"
-"Jest to niebezpieczne, poniewa? mo?e spowodowa?, ?e qmail-inject lub "
-"qmailowy\n"
+"Jest to niebezpieczne, poniewa? mo?e spowodowa?, ?e qmail-inject lub qmailowy\n"
 "zast?pnik sendmaila namiesza z nag??wkami From: lub Message-ID:.\n"
 "Prosz? spr?bowa? \"env QMAILINJECT= %s W?ASNE PARAMETRY\"\n"
 "%s: Przerwano.\n"
@@ -542,8 +524,7 @@
 msgid ""
 "%s: The NULLMAILER_FLAGS environment variable is set.\n"
 "This is dangerous as it can make nullmailer-inject or nullmailer's\n"
-"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: "
-"headers.\n"
+"sendmail wrapper tamper with your From:, Message-ID: or Return-Path: headers.\n"
 "Try \"env NULLMAILER_FLAGS= %s YOUR ARGUMENTS HERE\"\n"
 "%s: Abort.\n"
 msgstr ""
@@ -576,8 +557,7 @@
 #: env.c:174
 msgid ""
 "Trying to continue with unqualified hostname.\n"
-"DO NOT report broken Received: headers, HELO/EHLO lines or similar "
-"problems!\n"
+"DO NOT report broken Received: headers, HELO/EHLO lines or similar problems!\n"
 "DO repair your /etc/hosts, DNS, NIS or LDAP instead.\n"
 msgstr ""
 "Pr?ba kontynuacji z nierozwi?zan? nazw? hosta.\n"
@@ -652,14 +632,12 @@
 #: fetchmail.c:137
 msgid ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham Wilson\n"
 "Copyright (C) 2005 - 2006 Sunil Shetye\n"
 "Copyright (C) 2005 - 2009 Matthias Andree\n"
 msgstr ""
 "Copyright (C) 2002, 2003 Eric S. Raymond\n"
-"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham "
-"Wilson\n"
+"Copyright (C) 2004 Matthias Andree, Eric S. Raymond, Robert M. Funk, Graham Wilson\n"
 "Copyright (C) 2005 - 2006 Sunil Shetye\n"
 "Copyright (C) 2005 - 2009 Matthias Andree\n"
 
@@ -669,8 +647,7 @@
 "are welcome to redistribute it under certain conditions. For details,\n"
 "please see the file COPYING in the source or documentation directory.\n"
 msgstr ""
-"Fetchmail jest dostarczany BEZ JAKIEJKOLWIEK GWARANCJI. Jest to "
-"oprogramowanie\n"
+"Fetchmail jest dostarczany BEZ JAKIEJKOLWIEK GWARANCJI. Jest to oprogramowanie\n"
 "darmowe i mo?na je rozpowszechnia? pod pewnymi warunkami. Szczeg??y mo?na\n"
 "znale?? w pliku COPYING w ?r?d?ach lub katalogu z dokumentacj?.\n"
 
@@ -716,8 +693,7 @@
 #: fetchmail.c:448
 #, c-format
 msgid "fetchmail: error killing %s fetchmail at %d; bailing out.\n"
-msgstr ""
-"fetchmail: wyst?pi? b??d podczas pr?by zabicia %s fetchmaila, PID %d.\n"
+msgstr "fetchmail: wyst?pi? b??d podczas pr?by zabicia %s fetchmaila, PID %d.\n"
 
 #: fetchmail.c:449 fetchmail.c:458
 msgid "background"
@@ -733,20 +709,13 @@
 msgstr "fetchmail: zabito %s fetchmaila o numerze procesu %d.\n"
 
 #: fetchmail.c:480
-msgid ""
-"fetchmail: can't check mail while another fetchmail to same host is "
-"running.\n"
-msgstr ""
-"fetchmail: nie mog? sprawdzi? poczty, bo dzia?a inny fetchmail do tego "
-"serwera\n"
+msgid "fetchmail: can't check mail while another fetchmail to same host is running.\n"
+msgstr "fetchmail: nie mog? sprawdzi? poczty, bo dzia?a inny fetchmail do tego serwera\n"
 
 #: fetchmail.c:486
 #, c-format
-msgid ""
-"fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
-msgstr ""
-"fetchmail: nie mog? po??czy? si? z podanym hostem, bo dzia?a inny fetchmail "
-"(proces %d).\n"
+msgid "fetchmail: can't poll specified hosts with another fetchmail running at %d.\n"
+msgstr "fetchmail: nie mog? po??czy? si? z podanym hostem, bo dzia?a inny fetchmail (proces %d).\n"
 
 #: fetchmail.c:493
 #, c-format
@@ -754,11 +723,8 @@
 msgstr "fetchmail: dzia?a inny chodz?cy z konsoli fetchmail (proces %d).\n"
 
 #: fetchmail.c:503
-msgid ""
-"fetchmail: can't accept options while a background fetchmail is running.\n"
-msgstr ""
-"fetchmail: nie mog? przyjmowa? opcji, poniewa? inny fetchmail dzia?a ju? w "
-"tle.\n"
+msgid "fetchmail: can't accept options while a background fetchmail is running.\n"
+msgstr "fetchmail: nie mog? przyjmowa? opcji, poniewa? inny fetchmail dzia?a ju? w tle.\n"
 
 #: fetchmail.c:509
 #, c-format
@@ -768,8 +734,7 @@
 #: fetchmail.c:521
 #, c-format
 msgid "fetchmail: elder sibling at %d died mysteriously.\n"
-msgstr ""
-"fetchmail: starszy proces %d zgin?? w niewyja?nionych okoliczno?ciach.\n"
+msgstr "fetchmail: starszy proces %d zgin?? w niewyja?nionych okoliczno?ciach.\n"
 
 #: fetchmail.c:536
 #, c-format
@@ -797,8 +762,7 @@
 
 #: fetchmail.c:606
 msgid "fetchmail: Warning: syslog and logfile are set. Check both for logs!\n"
-msgstr ""
-"fetchmail: Uwaga: ustawiono sysloga i plik loga. Log?w nale?y szuka? w obu!\n"
+msgstr "fetchmail: Uwaga: ustawiono sysloga i plik loga. Log?w nale?y szuka? w obu!\n"
 
 #: fetchmail.c:625
 msgid "--check mode enabled, not fetching mail\n"
@@ -816,8 +780,7 @@
 
 #: fetchmail.c:657
 msgid "attempt to re-exec may fail as directory has not been restored\n"
-msgstr ""
-"pr?ba restartu mo?e si? nie uda?, poniewa? katalog nie zosta? odtworzony\n"
+msgstr "pr?ba restartu mo?e si? nie uda?, poniewa? katalog nie zosta? odtworzony\n"
 
 #: fetchmail.c:684
 msgid "attempt to re-exec fetchmail failed\n"
@@ -934,8 +897,7 @@
 
 #: fetchmail.c:1102
 msgid "fetchmail: Error: multiple \"defaults\" records in config file.\n"
-msgstr ""
-"fetchmail: B??d: wiele rekord?w \"defaults\" w pliku konfiguracyjnym.\n"
+msgstr "fetchmail: B??d: wiele rekord?w \"defaults\" w pliku konfiguracyjnym.\n"
 
 #: fetchmail.c:1224
 msgid "SSL support is not compiled in.\n"
@@ -943,13 +905,11 @@
 
 #: fetchmail.c:1231
 msgid "KERBEROS v4 support is configured, but not compiled in.\n"
-msgstr ""
-"obs?uga KERBEROSA v4 jest skonfigurowana, ale nie zosta?a wkompilowana.\n"
+msgstr "obs?uga KERBEROSA v4 jest skonfigurowana, ale nie zosta?a wkompilowana.\n"
 
 #: fetchmail.c:1237
 msgid "KERBEROS v5 support is configured, but not compiled in.\n"
-msgstr ""
-"obs?uga KERBEROSA v5 jest skonfigurowana, ale nie zosta?a wkompilowana.\n"
+msgstr "obs?uga KERBEROSA v5 jest skonfigurowana, ale nie zosta?a wkompilowana.\n"
 
 #: fetchmail.c:1243
 msgid "GSSAPI support is configured, but not compiled in.\n"
@@ -957,8 +917,7 @@
 
 #: fetchmail.c:1273
 #, c-format
-msgid ""
-"fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
+msgid "fetchmail: warning: no DNS available to check multidrop fetches from %s\n"
 msgstr "fetchmail: uwaga: brak serwera DNS potrzebnego do sprawdzenia %s\n"
 
 #: fetchmail.c:1284
@@ -972,30 +931,22 @@
 
 #: fetchmail.c:1302
 #, c-format
-msgid ""
-"fetchmail: %s configuration invalid, specify positive port number for "
-"service or port\n"
-msgstr ""
-"fetchmail: konfiguracja dla %s jest b??dna - nale?y poda? dodatni numer "
-"portu\n"
+msgid "fetchmail: %s configuration invalid, specify positive port number for service or port\n"
+msgstr "fetchmail: konfiguracja dla %s jest b??dna - nale?y poda? dodatni numer portu\n"
 
 #: fetchmail.c:1309
 #, c-format
 msgid "fetchmail: %s configuration invalid, RPOP requires a privileged port\n"
-msgstr ""
-"fetchmail: konfiguracja dla %s jest b??dna - RPOP wymaga uprzywilejowanego "
-"portu\n"
+msgstr "fetchmail: konfiguracja dla %s jest b??dna - RPOP wymaga uprzywilejowanego portu\n"
 
 #: fetchmail.c:1327
 #, c-format
 msgid "%s configuration invalid, LMTP can't use default SMTP port\n"
-msgstr ""
-"konfiguracja dla %s jest b??dna - LMTP nie u?ywa domy?lnego portu SMTP\n"
+msgstr "konfiguracja dla %s jest b??dna - LMTP nie u?ywa domy?lnego portu SMTP\n"
 
 #: fetchmail.c:1341
 msgid "Both fetchall and keep on in daemon or idle mode is a mistake!\n"
-msgstr ""
-"Jednoczesne fetchall i keep w trybie demona lub bezczynno?ci to b??d!\n"
+msgstr "Jednoczesne fetchall i keep w trybie demona lub bezczynno?ci to b??d!\n"
 
 #: fetchmail.c:1366
 #, c-format
@@ -1005,8 +956,7 @@
 #: fetchmail.c:1439
 #, c-format
 msgid "%s querying %s (protocol %s) at %s: poll started\n"
-msgstr ""
-"%s ??czy si? z %s (protok?? %s) o godzinie %s: odpytywanie rozpocz?te\n"
+msgstr "%s ??czy si? z %s (protok?? %s) o godzinie %s: odpytywanie rozpocz?te\n"
 
 #: fetchmail.c:1464
 msgid "POP2 support is not configured.\n"
@@ -1035,8 +985,7 @@
 #: fetchmail.c:1517
 #, c-format
 msgid "%s querying %s (protocol %s) at %s: poll completed\n"
-msgstr ""
-"%s ??czy si? z %s (protok?? %s) o godzinie %s: odpytywanie zako?czone\n"
+msgstr "%s ??czy si? z %s (protok?? %s) o godzinie %s: odpytywanie zako?czone\n"
 
 #: fetchmail.c:1534
 #, c-format
@@ -1084,8 +1033,7 @@
 
 #: fetchmail.c:1559
 msgid "Fetchmail will treat permanent errors as temporary (keep messages).\n"
-msgstr ""
-"Fetchmail b?dzie traktowa? trwa?e b??dy jako tymczasowe (zachowa listy).\n"
+msgstr "Fetchmail b?dzie traktowa? trwa?e b??dy jako tymczasowe (zachowa listy).\n"
 
 #: fetchmail.c:1566
 #, c-format
@@ -1112,15 +1060,11 @@
 
 #: fetchmail.c:1580
 msgid "  This host will not be queried when no host is specified.\n"
-msgstr ""
-"  Z tym serwerem nie b?d? si? ??czy? je?li nie zostanie podany ?aden inny "
-"serwer.\n"
+msgstr "  Z tym serwerem nie b?d? si? ??czy? je?li nie zostanie podany ?aden inny serwer.\n"
 
 #: fetchmail.c:1581
 msgid "  This host will be queried when no host is specified.\n"
-msgstr ""
-"  Z tym serwerem b?d? si? ??czy? je?li nie zostanie podany ?aden inny "
-"serwer.\n"
+msgstr "  Z tym serwerem b?d? si? ??czy? je?li nie zostanie podany ?aden inny serwer.\n"
 
 #: fetchmail.c:1585
 msgid "  Password will be prompted for.\n"
@@ -1269,81 +1213,55 @@
 
 #: fetchmail.c:1691
 msgid "  Fetched messages will not be kept on the server (--keep off).\n"
-msgstr ""
-"  Pobrane listy nie b?d? pozostawione na serwerze (--keep wy??czone).\n"
+msgstr "  Pobrane listy nie b?d? pozostawione na serwerze (--keep wy??czone).\n"
 
 #: fetchmail.c:1693
 msgid "  Old messages will be flushed before message retrieval (--flush on).\n"
-msgstr ""
-"  Stare listy b?d? kasowane przed pobraniem poczty (--flush w??czone).\n"
+msgstr "  Stare listy b?d? kasowane przed pobraniem poczty (--flush w??czone).\n"
 
 #: fetchmail.c:1694
-msgid ""
-"  Old messages will not be flushed before message retrieval (--flush off).\n"
-msgstr ""
-"  Stare listy nie b?d? kasowane przed pobraniem poczty (--flush wy??czone).\n"
+msgid "  Old messages will not be flushed before message retrieval (--flush off).\n"
+msgstr "  Stare listy nie b?d? kasowane przed pobraniem poczty (--flush wy??czone).\n"
 
 #: fetchmail.c:1696
-msgid ""
-"  Oversized messages will be flushed before message retrieval (--limitflush "
-"on).\n"
-msgstr ""
-"  Zbyt du?e listy b?d? kasowane przed pobraniem poczty (--limitflush "
-"w??czone).\n"
+msgid "  Oversized messages will be flushed before message retrieval (--limitflush on).\n"
+msgstr "  Zbyt du?e listy b?d? kasowane przed pobraniem poczty (--limitflush w??czone).\n"
 
 #: fetchmail.c:1697
-msgid ""
-"  Oversized messages will not be flushed before message retrieval (--"
-"limitflush off).\n"
-msgstr ""
-"  Zbyt du?e listy nie b?d? kasowane przed pobraniem poczty (--limitflush "
-"wy??czone).\n"
+msgid "  Oversized messages will not be flushed before message retrieval (--limitflush off).\n"
+msgstr "  Zbyt du?e listy nie b?d? kasowane przed pobraniem poczty (--limitflush wy??czone).\n"
 
 #: fetchmail.c:1699
 msgid "  Rewrite of server-local addresses is enabled (--norewrite off).\n"
-msgstr ""
-"  Przepisywanie adres?w na posta? lokaln? jest w??czone (--norewrite "
-"wy??czone).\n"
+msgstr "  Przepisywanie adres?w na posta? lokaln? jest w??czone (--norewrite wy??czone).\n"
 
 #: fetchmail.c:1700
 msgid "  Rewrite of server-local addresses is disabled (--norewrite on).\n"
-msgstr ""
-"  Przepisywanie adres?w na posta? lokaln? jest wy??czone (--norewrite "
-"w??czone).\n"
+msgstr "  Przepisywanie adres?w na posta? lokaln? jest wy??czone (--norewrite w??czone).\n"
 
 #: fetchmail.c:1702
 msgid "  Carriage-return stripping is enabled (stripcr on).\n"
-msgstr ""
-"  Usuwanie znak?w CR z ko?c?w linii jest w??czone (stripcr w??czone).\n"
+msgstr "  Usuwanie znak?w CR z ko?c?w linii jest w??czone (stripcr w??czone).\n"
 
 #: fetchmail.c:1703
 msgid "  Carriage-return stripping is disabled (stripcr off).\n"
-msgstr ""
-"  Usuwanie znak?w CR z ko?c?w linii jest wy??czone (stripcr wy??czone).\n"
+msgstr "  Usuwanie znak?w CR z ko?c?w linii jest wy??czone (stripcr wy??czone).\n"
 
 #: fetchmail.c:1705
 msgid "  Carriage-return forcing is enabled (forcecr on).\n"
-msgstr ""
-"  Dodawanie znak?w CR na ko?cach linii jest w??czone (forcecr w??czone).\n"
+msgstr "  Dodawanie znak?w CR na ko?cach linii jest w??czone (forcecr w??czone).\n"
 
 #: fetchmail.c:1706
 msgid "  Carriage-return forcing is disabled (forcecr off).\n"
-msgstr ""
-"  Dodawanie znak?w CR na ko?cach linii jest wy??czone (forcecr wy??czone).\n"
+msgstr "  Dodawanie znak?w CR na ko?cach linii jest wy??czone (forcecr wy??czone).\n"
 
 #: fetchmail.c:1708
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
-msgstr ""
-"  Interpretowanie nag??wka Content-Transfer-Encoding jest wy??czone "
-"(pass8bits w??czone).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is disabled (pass8bits on).\n"
+msgstr "  Interpretowanie nag??wka Content-Transfer-Encoding jest wy??czone (pass8bits w??czone).\n"
 
 #: fetchmail.c:1709
-msgid ""
-"  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
-msgstr ""
-"  Interpretowanie nag??wka Content-Transfer-Encoding jest w??czone "
-"(pass8bits wy??czone).\n"
+msgid "  Interpretation of Content-Transfer-Encoding is enabled (pass8bits off).\n"
+msgstr "  Interpretowanie nag??wka Content-Transfer-Encoding jest w??czone (pass8bits wy??czone).\n"
 
 #: fetchmail.c:1711
 msgid "  MIME decoding is enabled (mimedecode on).\n"
@@ -1389,15 +1307,11 @@
 #: fetchmail.c:1730
 #, c-format
 msgid "  Message size warning interval is %d seconds (--warnings %d).\n"
-msgstr ""
-"  Ostrze?enia o wielko?ci listu b?d? wy?wietlane co %d sekund (--warnings %"
-"d).\n"
+msgstr "  Ostrze?enia o wielko?ci listu b?d? wy?wietlane co %d sekund (--warnings %d).\n"
 
 #: fetchmail.c:1733
 msgid "  Size warnings on every poll (--warnings 0).\n"
-msgstr ""
-"  Ostrze?enia o wielko?ci b?d? wy?wietlane przy ka?dym ??czeniu (--warnings "
-"0).\n"
+msgstr "  Ostrze?enia o wielko?ci b?d? wy?wietlane przy ka?dym ??czeniu (--warnings 0).\n"
 
 #: fetchmail.c:1736
 #, c-format
@@ -1406,8 +1320,7 @@
 
 #: fetchmail.c:1739
 msgid "  No received-message limit (--fetchlimit 0).\n"
-msgstr ""
-"  Limit ilo?ci otrzymanych list?w nie jest ustawiony (--fetchlimit 0).\n"
+msgstr "  Limit ilo?ci otrzymanych list?w nie jest ustawiony (--fetchlimit 0).\n"
 
 #: fetchmail.c:1741
 #, c-format
@@ -1420,19 +1333,16 @@
 
 #: fetchmail.c:1748
 msgid "  Do binary search of UIDs during each poll (--fastuidl 1).\n"
-msgstr ""
-"  Binarne przeszukiwanie UID-?w przy ka?dym ?ci?ganiu (--fastuidl 1).\n"
+msgstr "  Binarne przeszukiwanie UID-?w przy ka?dym ?ci?ganiu (--fastuidl 1).\n"
 
 #: fetchmail.c:1750
 #, c-format
 msgid "  Do binary search of UIDs during %d out of %d polls (--fastuidl %d).\n"
-msgstr ""
-"  Binarne przeszukiwanie UID-?w przy %d z %d ?ci?ga? (--fastuidl %d).\n"
+msgstr "  Binarne przeszukiwanie UID-?w przy %d z %d ?ci?ga? (--fastuidl %d).\n"
 
 #: fetchmail.c:1753
 msgid "   Do linear search of UIDs during each poll (--fastuidl 0).\n"
-msgstr ""
-"   Liniowe przeszukiwanie UID-?w przy ka?dym ?ci?ganiu (--fastuidl 0).\n"
+msgstr "   Liniowe przeszukiwanie UID-?w przy ka?dym ?ci?ganiu (--fastuidl 0).\n"
 
 #: fetchmail.c:1755
 #, c-format
@@ -1441,8 +1351,7 @@
 
 #: fetchmail.c:1757
 msgid "  No SMTP message batch limit (--batchlimit 0).\n"
-msgstr ""
-"  Limit ilo?ci list?w wysy?anych przez SMTP nie ustawiony (--batchlimit 0).\n"
+msgstr "  Limit ilo?ci list?w wysy?anych przez SMTP nie ustawiony (--batchlimit 0).\n"
 
 #: fetchmail.c:1761
 #, c-format
@@ -1484,8 +1393,7 @@
 #: fetchmail.c:1803
 #, c-format
 msgid "  Address to be put in RCPT TO lines shipped to SMTP will be %s\n"
-msgstr ""
-"  Adresem do umieszczenia w liniach RCPT TO przekazanych SMTP b?dzie %s\n"
+msgstr "  Adresem do umieszczenia w liniach RCPT TO przekazanych SMTP b?dzie %s\n"
 
 #: fetchmail.c:1812
 msgid "  Recognized listener spam block responses are:"
@@ -1511,8 +1419,7 @@
 
 #: fetchmail.c:1829
 msgid "  No post-connection command.\n"
-msgstr ""
-"  Po zamkni?ciu po??czenia nie b?dzie wykonywane ?adne dodatkowe polecenie.\n"
+msgstr "  Po zamkni?ciu po??czenia nie b?dzie wykonywane ?adne dodatkowe polecenie.\n"
 
 #: fetchmail.c:1832
 msgid "  No localnames declared for this host.\n"
@@ -1543,8 +1450,7 @@
 msgstr "  Odpytywanie DNS dla adres?w wieloskrzynkowych jest wy??czone.\n"
 
 #: fetchmail.c:1866
-msgid ""
-"  Server aliases will be compared with multidrop addresses by IP address.\n"
+msgid "  Server aliases will be compared with multidrop addresses by IP address.\n"
 msgstr "  Aliasy serwera b?d? por?wnywane z adresami skrzynek po adresie IP.\n"
 
 #: fetchmail.c:1868
@@ -1603,8 +1509,7 @@
 #: fetchmail.c:1919
 #, c-format
 msgid "  Server connections will be made via plugin %s (--plugin %s).\n"
-msgstr ""
-"  Po??czenia z serwerem b?d? nawi?zywane przez wtyczk? %s (--plugin %s).\n"
+msgstr "  Po??czenia z serwerem b?d? nawi?zywane przez wtyczk? %s (--plugin %s).\n"
 
 #: fetchmail.c:1921
 msgid "  No plugin command specified.\n"
@@ -1613,9 +1518,7 @@
 #: fetchmail.c:1923
 #, c-format
 msgid "  Listener connections will be made via plugout %s (--plugout %s).\n"
-msgstr ""
-"  Po??czenie z serwerem odbiorcy zostanie nawi?zane programem %s (--plugout %"
-"s).\n"
+msgstr "  Po??czenie z serwerem odbiorcy zostanie nawi?zane programem %s (--plugout %s).\n"
 
 #: fetchmail.c:1925
 msgid "  No plugout command specified.\n"
@@ -1632,8 +1535,7 @@
 
 #: fetchmail.c:1947
 msgid "  Poll trace information will be added to the Received header.\n"
-msgstr ""
-"  Informacje o ?ledzeniu po??czenia b?d? dodane do nag??wka Received.\n"
+msgstr "  Informacje o ?ledzeniu po??czenia b?d? dodane do nag??wka Received.\n"
 
 #: fetchmail.c:1949
 msgid ""
@@ -1819,16 +1721,12 @@
 msgstr "%u jest pierwszym nieprzeczytanym\n"
 
 #: imap.c:1002
-msgid ""
-"Warning: ignoring bogus data for message sizes returned by the server.\n"
-msgstr ""
-"Uwaga: zignorowano nieprawdziwe dane o rozmiarze wiadomo?ci zwr?cone przez "
-"serwer.\n"
+msgid "Warning: ignoring bogus data for message sizes returned by the server.\n"
+msgstr "Uwaga: zignorowano nieprawdziwe dane o rozmiarze wiadomo?ci zwr?cone przez serwer.\n"
 
 #: interface.c:256
 msgid "Unable to open kvm interface. Make sure fetchmail is SGID kmem."
-msgstr ""
-"Nie mo?na otworzy? interfejsu kvm. By? mo?e fetchmail nie jest SGID kmem."
+msgstr "Nie mo?na otworzy? interfejsu kvm. By? mo?e fetchmail nie jest SGID kmem."
 
 #: interface.c:396
 #, c-format
@@ -2095,17 +1993,12 @@
 msgstr "  -L, --logfile     podaje nazw? pliku kroniki\n"
 
 #: options.c:613
-msgid ""
-"      --syslog      use syslog(3) for most messages when running as a "
-"daemon\n"
-msgstr ""
-"      --syslog      w??cza wy?wietlanie wi?kszo?ci komunikat?w przez syslog"
-"(3)\n"
+msgid "      --syslog      use syslog(3) for most messages when running as a daemon\n"
+msgstr "      --syslog      w??cza wy?wietlanie wi?kszo?ci komunikat?w przez syslog(3)\n"
 
 #: options.c:614
 msgid "      --invisible   don't write Received & enable host spoofing\n"
-msgstr ""
-"      --invisible   w??cza udawanie hosta i nie dodaje nag??wk?w Received\n"
+msgstr "      --invisible   w??cza udawanie hosta i nie dodaje nag??wk?w Received\n"
 
 #: options.c:615
 msgid "  -f, --fetchmailrc specify alternate run control file\n"
@@ -2128,19 +2021,12 @@
 msgstr "      --nobounce    przekierowuje odbit? poczt? do postmastera.\n"
 
 #: options.c:620
-msgid ""
-"      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
-msgstr ""
-"      --nosoftbounce fetchmail usunie listy trwale niemo?liwe do "
-"dostarczenia.\n"
+msgid "      --nosoftbounce fetchmail deletes permanently undeliverable messages.\n"
+msgstr "      --nosoftbounce fetchmail usunie listy trwale niemo?liwe do dostarczenia.\n"
 
 #: options.c:621
-msgid ""
-"      --softbounce  keep permanently undeliverable messages on server "
-"(default).\n"
-msgstr ""
-"      --softbounce  zachowa listy trwale niemo?liwe do dostarczenia "
-"(domy?lne).\n"
+msgid "      --softbounce  keep permanently undeliverable messages on server (default).\n"
+msgstr "      --softbounce  zachowa listy trwale niemo?liwe do dostarczenia (domy?lne).\n"
 
 #: options.c:623
 msgid "  -I, --interface   interface required specification\n"
@@ -2164,26 +2050,19 @@
 
 #: options.c:630
 msgid "      --sslcertck   do strict server certificate check (recommended)\n"
-msgstr ""
-"      --sslcertck   dok?adne sprawdzanie certyfikatu serwera (zalecane)\n"
+msgstr "      --sslcertck   dok?adne sprawdzanie certyfikatu serwera (zalecane)\n"
 
 #: options.c:631
 msgid "      --sslcertpath path to ssl certificates\n"
 msgstr "      --sslcertpath ?cie?ka do certyfikat?w ssl\n"
 
 #: options.c:632
-msgid ""
-"      --sslcommonname  expect this CommonName from server (discouraged)\n"
-msgstr ""
-"      --sslcommonname  oczekiwanie od serwera tego CommonName (niezalecane)\n"
+msgid "      --sslcommonname  expect this CommonName from server (discouraged)\n"
+msgstr "      --sslcommonname  oczekiwanie od serwera tego CommonName (niezalecane)\n"
 
 #: options.c:633
-msgid ""
-"      --sslfingerprint fingerprint that must match that of the server's "
-"cert.\n"
-msgstr ""
-"      --sslfingerprint odcisk, kt?ry musi pasowa? do odcisku certyfikatu "
-"serwera.\n"
+msgid "      --sslfingerprint fingerprint that must match that of the server's cert.\n"
+msgstr "      --sslfingerprint odcisk, kt?ry musi pasowa? do odcisku certyfikatu serwera.\n"
 
 #: options.c:634
 msgid "      --sslproto    force ssl protocol (SSL2/SSL3/TLS1)\n"
@@ -2191,21 +2070,15 @@
 
 #: options.c:636
 msgid "      --plugin      specify external command to open connection\n"
-msgstr ""
-"      --plugin      ?cie?ka do zewn?trznego polecenia otwieraj?cego "
-"po??czenie\n"
+msgstr "      --plugin      ?cie?ka do zewn?trznego polecenia otwieraj?cego po??czenie\n"
 
 #: options.c:637
 msgid "      --plugout     specify external command to open smtp connection\n"
-msgstr ""
-"      --plugout     ?cie?ka do zewn. polecenia otwieraj?cego po??czenie "
-"smtp\n"
+msgstr "      --plugout     ?cie?ka do zewn. polecenia otwieraj?cego po??czenie smtp\n"
 
 #: options.c:639
 msgid "  -p, --protocol    specify retrieval protocol (see man page)\n"
-msgstr ""
-"  -p, --protocol    okre?la protok?? kt?rym b?d? pobierane listy (patrz "
-"manual)\n"
+msgstr "  -p, --protocol    okre?la protok?? kt?rym b?d? pobierane listy (patrz manual)\n"
 
 #: options.c:640
 msgid "  -U, --uidl        force the use of UIDLs (pop3 only)\n"
@@ -2213,22 +2086,15 @@
 
 #: options.c:641
 msgid "      --port        TCP port to connect to (obsolete, use --service)\n"
-msgstr ""
-"      --port        ??czenie z portem TCP (przestarza?e, nale?y u?ywa? --"
-"service)\n"
+msgstr "      --port        ??czenie z portem TCP (przestarza?e, nale?y u?ywa? --service)\n"
 
 #: options.c:642
-msgid ""
-"  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
-msgstr ""
-"  -P, --service     ??czenie z podan? us?ug? TCP (mo?e by? numerem portu "
-"TCP)\n"
+msgid "  -P, --service     TCP service to connect to (can be numeric TCP port)\n"
+msgstr "  -P, --service     ??czenie z podan? us?ug? TCP (mo?e by? numerem portu TCP)\n"
 
 #: options.c:643
 msgid "      --auth        authentication type (password/kerberos/ssh/otp)\n"
-msgstr ""
-"      --auth        okre?la metod? uwierzytelnienia (has?o/Kerberos/ssh/"
-"otp)\n"
+msgstr "      --auth        okre?la metod? uwierzytelnienia (has?o/Kerberos/ssh/otp)\n"
 
 #: options.c:644
 msgid "  -t, --timeout     server nonresponse timeout\n"
@@ -2236,13 +2102,11 @@
 
 #: options.c:645
 msgid "  -E, --envelope    envelope address header\n"
-msgstr ""
-"  -E, --envelope    okre?la nazw? nag??wka zawieraj?cego adres z koperty\n"
+msgstr "  -E, --envelope    okre?la nazw? nag??wka zawieraj?cego adres z koperty\n"
 
 #: options.c:646
 msgid "  -Q, --qvirtual    prefix to remove from local user id\n"
-msgstr ""
-"  -Q, --qvirtual    przedrostek, kt?ry b?dzie usuwany z nazwy u?ytkownika\n"
+msgstr "  -Q, --qvirtual    przedrostek, kt?ry b?dzie usuwany z nazwy u?ytkownika\n"
 
 #: options.c:647
 msgid "      --principal   mail service principal\n"
@@ -2250,8 +2114,7 @@
 
 #: options.c:648
 msgid "      --tracepolls  add poll-tracing information to Received header\n"
-msgstr ""
-"      --tracepolls  dodaje informacje o ?ledzeniu po??czenia do Received\n"
+msgstr "      --tracepolls  dodaje informacje o ?ledzeniu po??czenia do Received\n"
 
 #: options.c:650
 msgid "  -u, --username    specify users's login on server\n"
@@ -2291,8 +2154,7 @@
 
 #: options.c:660
 msgid "  -S, --smtphost    set SMTP forwarding host\n"
-msgstr ""
-"  -S, --smtphost    okre?la nazw? hosta SMTP przesy?aj?cego nasze listy\n"
+msgstr "  -S, --smtphost    okre?la nazw? hosta SMTP przesy?aj?cego nasze listy\n"
 
 #: options.c:661
 msgid "      --fetchdomains fetch mail for specified domains\n"
@@ -2300,9 +2162,7 @@
 
 #: options.c:662
 msgid "  -D, --smtpaddress set SMTP delivery domain to use\n"
-msgstr ""
-"  -D, --smtpaddress okre?la nazw? domeny SMTP u?ywan? przy dor?czaniu "
-"poczty\n"
+msgstr "  -D, --smtpaddress okre?la nazw? domeny SMTP u?ywan? przy dor?czaniu poczty\n"
 
 #: options.c:663
 msgid "      --smtpname    set SMTP full name username at domain\n"
@@ -2314,13 +2174,11 @@
 
 #: options.c:665
 msgid "  -b, --batchlimit  set batch limit for SMTP connections\n"
-msgstr ""
-"  -b, --batchlimit  okre?la limit list?w wys?anych w jednym po??czeniu SMTP\n"
+msgstr "  -b, --batchlimit  okre?la limit list?w wys?anych w jednym po??czeniu SMTP\n"
 
 #: options.c:666
 msgid "  -B, --fetchlimit  set fetch limit for server connections\n"
-msgstr ""
-"  -B, --fetchlimit  okre?la limit list?w pobieranych w jednym po??czeniu\n"
+msgstr "  -B, --fetchlimit  okre?la limit list?w pobieranych w jednym po??czeniu\n"
 
 #: options.c:667
 msgid "      --fetchsizelimit set fetch message size limit\n"
@@ -2332,13 +2190,11 @@
 
 #: options.c:669
 msgid "  -e, --expunge     set max deletions between expunges\n"
-msgstr ""
-"  -e, --expunge     liczba skasowanych list?w mi?dzy czyszczeniem skrzynki\n"
+msgstr "  -e, --expunge     liczba skasowanych list?w mi?dzy czyszczeniem skrzynki\n"
 
 #: options.c:670
 msgid "  -m, --mda         set MDA to use for forwarding\n"
-msgstr ""
-"  -m, --mda         okre?la ?cie?k? do MDA dor?czaj?cego pobrane listy\n"
+msgstr "  -m, --mda         okre?la ?cie?k? do MDA dor?czaj?cego pobrane listy\n"
 
 #: options.c:671
 msgid "      --bsmtp       set output BSMTP file\n"
@@ -2354,16 +2210,11 @@
 
 #: options.c:674
 msgid "      --showdots    show progress dots even in logfiles\n"
-msgstr ""
-"      --showdots    pokazuje kropki oznaczaj?ce post?p tak?e w logach\n"
+msgstr "      --showdots    pokazuje kropki oznaczaj?ce post?p tak?e w logach\n"
 
 #: pop3.c:355
-msgid ""
-"Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead "
-"of TOP.\n"
-msgstr ""
-"Uwaga: Odkryto serwer \"POP3/PROXY Maillennium\", u?ycie polecenia RETR "
-"zamiast TOP.\n"
+msgid "Warning: \"Maillennium POP3/PROXY server\" found, using RETR command instead of TOP.\n"
+msgstr "Uwaga: Odkryto serwer \"POP3/PROXY Maillennium\", u?ycie polecenia RETR zamiast TOP.\n"
 
 #: pop3.c:454
 msgid "TLS is mandatory for this session, but server refused CAPA command.\n"
@@ -2380,8 +2231,7 @@
 
 #: pop3.c:646
 msgid "We've run out of allowed authenticators and cannot continue.\n"
-msgstr ""
-"Wyczerpano dozwolone sposoby uwierzytelnienia, nie mo?na kontynuowa?.\n"
+msgstr "Wyczerpano dozwolone sposoby uwierzytelnienia, nie mo?na kontynuowa?.\n"
 
 #: pop3.c:660
 msgid "Required APOP timestamp not found in greeting\n"
@@ -2423,8 +2273,7 @@
 
 #: pop3.c:965
 msgid "Messages inserted into list on server. Cannot handle this.\n"
-msgstr ""
-"Przesy?ki zosta?y dodane do listy na serwerze. Nie mog? tego obs?u?y?.\n"
+msgstr "Przesy?ki zosta?y dodane do listy na serwerze. Nie mog? tego obs?u?y?.\n"
 
 #: pop3.c:1057
 msgid "protocol error\n"
@@ -2447,20 +2296,12 @@
 msgstr "SDPS nie w??czone."
 
 #: rcfile_y.y:215
-msgid ""
-"fetchmail: interface option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: opcja interface jest obs?ugiwana tylko pod Linuksem (bez IPv6) i "
-"FreeBSD\n"
+msgid "fetchmail: interface option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: opcja interface jest obs?ugiwana tylko pod Linuksem (bez IPv6) i FreeBSD\n"
 
 #: rcfile_y.y:222
-msgid ""
-"fetchmail: monitor option is only supported under Linux (without IPv6) and "
-"FreeBSD\n"
-msgstr ""
-"fetchmail: opcja monitor jest obs?ugiwana tylko pod Linuksem (bez IPv6) i "
-"FreeBSD\n"
+msgid "fetchmail: monitor option is only supported under Linux (without IPv6) and FreeBSD\n"
+msgstr "fetchmail: opcja monitor jest obs?ugiwana tylko pod Linuksem (bez IPv6) i FreeBSD\n"
 
 #: rcfile_y.y:335
 msgid "SSL is not enabled"
@@ -2792,10 +2633,8 @@
 
 #: sink.c:1373
 #, c-format
-msgid ""
-"Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
-msgstr ""
-"Dziwne: MDA pclose zwr?ci?o %d a errno %d/%s, nie mo?na obs?u?y? w %s:%d\n"
+msgid "Strange: MDA pclose returned %d and errno %d/%s, cannot handle at %s:%d\n"
+msgstr "Dziwne: MDA pclose zwr?ci?o %d a errno %d/%s, nie mo?na obs?u?y? w %s:%d\n"
 
 #: sink.c:1395
 msgid "Message termination or close of BSMTP file failed\n"
@@ -2950,19 +2789,17 @@
 msgstr "B??dny certyfikat: za d?ugie CommonName podmiotu!\n"
 
 #: socket.c:643
-#, fuzzy
 msgid "Bad certificate: Subject CommonName contains NUL, aborting!\n"
-msgstr "B??dny certyfikat: za d?ugie CommonName podmiotu!\n"
+msgstr "B??dny certyfikat: CommonName podmiotu zawiera NUL, przerwano!\n"
 
 #: socket.c:664
 #, c-format
 msgid "Subject Alternative Name: %s\n"
-msgstr ""
+msgstr "Alternatywna nazwa podmiotu: %s\n"
 
 #: socket.c:670
-#, fuzzy
 msgid "Bad certificate: Subject Alternative Name contains NUL, aborting!\n"
-msgstr "B??dny certyfikat: za d?ugie CommonName podmiotu!\n"
+msgstr "B??dny certyfikat: alternatywna nazwa podmiotu zawiera NUL, przerwano!\n"
 
 #: socket.c:698
 #, c-format
@@ -3023,7 +2860,7 @@
 msgstr "Deskryptor pliku poza zakresem dla SSL"
 
 #: socket.c:866
-#, fuzzy, c-format
+#, c-format
 msgid "Invalid SSL protocol '%s' specified, using default (SSLv23).\n"
 msgstr "Podano b??dny protok?? SSL `%s', u?ywam domy?lnego (SSLv23).\n"
 
@@ -3177,8 +3014,7 @@
 #: uid.c:645
 #, c-format
 msgid "Error writing to fetchids file %s, old file left in place.\n"
-msgstr ""
-"B??d podczas zapisu pliku fetchids %s, stary plik pozostawiono na miejscu.\n"
+msgstr "B??d podczas zapisu pliku fetchids %s, stary plik pozostawiono na miejscu.\n"
 
 #: uid.c:649
 #, c-format
@@ -3197,6 +3033,3 @@
 #: xmalloc.c:47
 msgid "realloc failed\n"
 msgstr "b??d realloc\n"
-
-#~ msgid "message delimiter found while scanning headers\n"
-#~ msgstr "podczas skanowania nag??wk?w znaleziono separator list?w\n"



From svn at mknod.org  Wed Aug 12 12:24:58 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed, 12 Aug 2009 05:24:58 -0500
Subject: [fetchmail-svn] r5409 - branches/BRANCH_MAPI
Message-ID: <20090812102458.39EEA21F2C7@mknod.org>

Author: mojmir
Date: 2009-08-12 05:24:57 -0500 (Wed, 12 Aug 2009)
New Revision: 5409

Modified:
   branches/BRANCH_MAPI/mapi.c
Log:
+ crash if From: or Cc: field empty

(testing, testing... do you hear me?)



Modified: branches/BRANCH_MAPI/mapi.c
===================================================================
--- branches/BRANCH_MAPI/mapi.c	2009-08-06 20:33:02 UTC (rev 5408)
+++ branches/BRANCH_MAPI/mapi.c	2009-08-12 10:24:57 UTC (rev 5409)
@@ -1236,7 +1236,7 @@
 	MapiWrite(lenp, "Date: %s\n", date);
 
 	MapiWrite(lenp, "From: %s", from);
-	smtp_address(lenp, from);
+	smtp_address(lenp, from ? from : "<empty>");
 
 	if (strlen(to)) {
 	    MapiWrite(lenp, "To: %s", to);
@@ -1245,7 +1245,7 @@
 
 	if (strlen(cc)) {
 	    MapiWrite(lenp, "Cc: %s", cc);
-	    smtp_address(lenp, cc);
+	    smtp_address(lenp, cc ? cc : "<empty>");
 	}
 
 	if (strlen(bcc)) {



From svn at mknod.org  Wed Aug 12 18:52:12 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed, 12 Aug 2009 11:52:12 -0500
Subject: [fetchmail-svn] r5410 - branches/BRANCH_MAPI
Message-ID: <20090812165212.69C2921F2CF@mknod.org>

Author: mojmir
Date: 2009-08-12 11:52:11 -0500 (Wed, 12 Aug 2009)
New Revision: 5410

Modified:
   branches/BRANCH_MAPI/fetchmail.c
Log:
- removed c++ comment (to use with -pedantic)


Modified: branches/BRANCH_MAPI/fetchmail.c
===================================================================
--- branches/BRANCH_MAPI/fetchmail.c	2009-08-12 10:24:57 UTC (rev 5409)
+++ branches/BRANCH_MAPI/fetchmail.c	2009-08-12 16:52:11 UTC (rev 5410)
@@ -2005,7 +2005,7 @@
 	    printf(GT_("  Windows domain name \"%s\".\n"),
 		   visbuf(ctl->mapi_domain));
 
-//TODO: to dump language as name, not as code.
+/*TODO: to dump language as name, not as code.*/
 	if (ctl->mapi_lcid)
 	    printf(GT_("  Language to use \"%s\".\n"),
 		   visbuf(ctl->mapi_lcid));



From svn at mknod.org  Wed Aug 12 18:52:56 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed, 12 Aug 2009 11:52:56 -0500
Subject: [fetchmail-svn] r5411 - branches/BRANCH_MAPI
Message-ID: <20090812165257.15D3721F2CF@mknod.org>

Author: mojmir
Date: 2009-08-12 11:52:56 -0500 (Wed, 12 Aug 2009)
New Revision: 5411

Modified:
   branches/BRANCH_MAPI/mapi.c
Log:
* mainly formatting changes while reading the code



Modified: branches/BRANCH_MAPI/mapi.c
===================================================================
--- branches/BRANCH_MAPI/mapi.c	2009-08-12 16:52:11 UTC (rev 5410)
+++ branches/BRANCH_MAPI/mapi.c	2009-08-12 16:52:56 UTC (rev 5411)
@@ -24,52 +24,56 @@
 
 #ifdef MAPI_ENABLE
 #include <libmapi/libmapi.h>
-#include  <ctype.h>
+#include <ctype.h>
 
 #if defined(HAVE_UNISTD_H)
 #include <unistd.h>
 #endif
 
 #if defined(STDC_HEADERS)
-#include  <stdlib.h>
+#include <stdlib.h>
 #endif
 
-#include  <errno.h>
+#include <errno.h>
 #include <magic.h>
 
-#include  "fetchmail.h"
-#include  "i18n.h"
-#include  "openchange-tools.h"
+#include "fetchmail.h"
+#include "i18n.h"
+#include "openchange-tools.h"
 
+/* samba includes */
+#include <ldb.h>
+#include <util/data_blob.h>
+
 #define DEFAULT_MAPI_PROFILES "%s/.fetchmail_mapi_profiles.ldb"
-#define MAPI_BOUNDARY	"=_DocE+STaALJfprDB"
+#define MAPI_BOUNDARY "=_DocE+STaALJfprDB"
 
 #ifndef PATH_MAX
-#define PATH_MAX 1024
+# define PATH_MAX 1024
 #endif
 
-static TALLOC_CTX *mapi_mem_ctx;
-static struct mapi_profile *mapi_profile;
-static mapi_object_t mapi_obj_store;
-static mapi_object_t mapi_obj_folder;
-static mapi_object_t mapi_obj_table;
-static mapi_id_array_t mapi_deleted_ids;
-static struct SRowSet mapi_rowset;
-static int      mapi_initialized = FALSE;
-static char     mapi_profdb[PATH_MAX];	/* mapi profiles databse */
-static char     password[128];
-static struct mapi_session * s_mapi_session = NULL;
+static TALLOC_CTX * g_mapi_mem_ctx;
+static struct mapi_profile * mapi_profile;
+static mapi_object_t g_mapi_obj_store;
+static mapi_object_t g_mapi_obj_folder;
+static mapi_object_t g_mapi_obj_table;
+static mapi_id_array_t g_mapi_deleted_ids;
+static struct SRowSet g_mapi_rowset;
+static int g_mapi_initialized = FALSE;
+static char g_mapi_profdb[PATH_MAX]; /* mapi profiles databse */
+static char g_password[128];
+static struct mapi_session * g_mapi_session = NULL;
 
 
-static DATA_BLOB mapi_buffer;
-static int      mapi_buffer_count;
+static DATA_BLOB g_mapi_buffer;
+static size_t g_mapi_buffer_count;
 
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  MapiWrite
- *  Description:  write data into mapi_buffer
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  MapiWrite
+ *	Description:  write data into g_mapi_buffer
  * =====================================================================================
  */
 #if defined(HAVE_STDARG_H)
@@ -77,84 +81,81 @@
 {
 #else
 void MapiWrite(lenp, format, va_alist)
-    int            *lenp;
-    char           *format;
-    va_dcl
+	int	* lenp;
+	char * format;
+	va_dcl
 {
 #endif
 
-    va_list         ap;
-    char           *temp_line;
+	va_list	ap;
+	char * temp_line;
 #if defined(HAVE_STDARG_H)
-    va_start(ap, format);
+	va_start(ap, format);
 #else
-    va_start(ap);
+	va_start(ap);
 #endif
-    temp_line = talloc_vasprintf(mapi_mem_ctx, format, ap);
-    data_blob_append(mapi_mem_ctx, &mapi_buffer, temp_line, strlen(temp_line));
-    *lenp += strlen(temp_line);
-    talloc_free(temp_line);
-    va_end(ap);
+	temp_line = talloc_vasprintf(g_mapi_mem_ctx, format, ap);
+	data_blob_append(g_mapi_mem_ctx, &g_mapi_buffer, temp_line, strlen(temp_line));
+	*lenp += strlen(temp_line);
+	talloc_free(temp_line);
+	va_end(ap);
 
-    return;
+	return;
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  MapiRead
- *  Description:  match the interface of SockRead in socket.h to feed the driver with
- *                MAPI data.
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  MapiRead
+ *	Description:  match the interface of SockRead in socket.h to feed the driver with
+ *				  MAPI data.
  * =====================================================================================
  */
-int MapiRead(int sock, char *buf, int len)
+int MapiRead (int sock, char *buf, int len)
 {
-    int             count = 0;
+	int count = 0;
 
-    while (mapi_buffer_count < mapi_buffer.length) {
-	*(buf + count) = *(mapi_buffer.data + mapi_buffer_count);
-	count++;
-	mapi_buffer_count++;
-	if (*(buf + count - 1) == '\n') {
-	    *(buf + count) = '\0';
-	    return count;
+	while (g_mapi_buffer_count < g_mapi_buffer.length) {
+		*(buf + count) = *(g_mapi_buffer.data + g_mapi_buffer_count);
+		count++;
+		g_mapi_buffer_count++;
+		if (*(buf + count - 1) == '\n') {
+			*(buf + count) = '\0';
+			return count;
+		}
+		if (count == len - 1) {
+			*(buf + count) = '\0';
+			return count;
+		}
 	}
-	if (count == len - 1) {
-	    *(buf + count) = '\0';
-	    return count;
-	}
-    }
 
-    return -1;
+	return -1;
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  MapiPeek
- *  Description:  match the interface of SockPeek.
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  MapiPeek
+ *	Description:  match the interface of SockPeek.
  * =====================================================================================
  */
-int MapiPeek(int sock)
+int MapiPeek (int sock)
 {
-    if (mapi_buffer_count < mapi_buffer.length)
-	return *(mapi_buffer.data + mapi_buffer_count);
-    else
-	return -1;
+	if (g_mapi_buffer_count < g_mapi_buffer.length)
+		return *(g_mapi_buffer.data + g_mapi_buffer_count);
+	else
+		return -1;
 }
 
 
-
-static const char *get_filename(const char *filename)
+static const char * get_filename (const char * filename)
 {
-    const char     *substr;
+	const char * substr = 0;
 
-    if (!filename)
-	return NULL;
+	if (!filename) return NULL;
 
-    substr = rindex(filename, '/');
-    if (substr)
-	return substr;
+	substr = rindex(filename, '/');
+	if (substr) return substr;
 
-    return filename;
+	return filename;
 }
 
 /*
@@ -162,1604 +163,1524 @@
  * Samba4 code
  * caller frees 
  */
-static char *ldb_base64_encode(void *mem_ctx, const char *buf, int len)
-{
-    const char     *b64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
-    int             bit_offset;
-    int             byte_offset;
-    int             idx;
-    int             i;
-    const uint8_t  *d = (const uint8_t *) buf;
-    int             bytes = (len * 8 + 5) / 6;
-    int             pad_bytes = (bytes % 4) ? 4 - (bytes % 4) : 0;
-    char           *out;
-
-    out = talloc_array(mem_ctx, char, bytes + pad_bytes + 1);
-    if (!out)
-	return NULL;
-
-    for (i = 0; i < bytes; i++) {
-	byte_offset = (i * 6) / 8;
-	bit_offset = (i * 6) % 8;
-	if (bit_offset < 3) {
-	    idx = (d[byte_offset] >> (2 - bit_offset)) & 0x3F;
-	} else {
-	    idx = (d[byte_offset] << (bit_offset - 2)) & 0x3F;
-	    if (byte_offset + 1 < len) {
-		idx |= (d[byte_offset + 1] >> (8 - (bit_offset - 2)));
-	    }
-	}
-	out[i] = b64[idx];
-    }
-
-    for (; i < bytes + pad_bytes; i++)
-	out[i] = '=';
-    out[i] = 0;
-
-    return out;
-}
-
-
 static char * get_base64_attachment (TALLOC_CTX * mem_ctx, mapi_object_t obj_attach, const uint32_t size, char ** magic)
 {
-    enum MAPISTATUS retval;
-    mapi_object_t   obj_stream;
-    DATA_BLOB	    data;
-    size_t	    data_pos = 0;
-    uint16_t	    read_bytes = 0;
-    magic_t	    cookie = NULL;
+	enum MAPISTATUS retval;
+	mapi_object_t	obj_stream;
+	DATA_BLOB		data;
+	size_t		data_pos = 0;
+	uint16_t		read_bytes = 0;
+	magic_t		cookie = NULL;
 
-    if (outlevel >= O_MONITOR) report(stdout, GT_("MAPI> mapi_get_base64_attachment(): size=%u\n"), size);
+	if (outlevel >= O_MONITOR) report(stdout, GT_("MAPI> mapi_get_base64_attachment(): size=%u\n"), size);
 
-    if (OpenStream(&obj_attach, PR_ATTACH_DATA_BIN, 0, &obj_stream) != MAPI_E_SUCCESS)
-	return NULL;
-    if (GetStreamSize(&obj_stream, &data.length) != MAPI_E_SUCCESS)
-	return NULL;
+	if (OpenStream(&obj_attach, PR_ATTACH_DATA_BIN, 0, &obj_stream) != MAPI_E_SUCCESS) return NULL;
+	if (GetStreamSize(&obj_stream, &data.length) != MAPI_E_SUCCESS) return NULL;
 
-    data.data = talloc_size(mem_ctx, data.length);
-    if (outlevel >= O_MONITOR) report(stdout, GT_("MAPI> allocated size=%u\n"), data.length);
+	data.data = talloc_size(mem_ctx, data.length);
+	if (outlevel >= O_MONITOR) report(stdout, GT_("MAPI> allocated size=%u\n"), data.length);
 
-    do {
-	if (ReadStream(&obj_stream, data.data + data_pos, MSGBUFSIZE, &read_bytes) != MAPI_E_SUCCESS)
-	    return NULL;
-	data_pos += read_bytes;
-    } while (data_pos < data.length);
+	do {
+		if (ReadStream(&obj_stream, data.data + data_pos, MSGBUFSIZE, &read_bytes) != MAPI_E_SUCCESS) return NULL;
+		data_pos += read_bytes;
+	} while (data_pos < data.length);
 
-    if (outlevel >= O_MONITOR) report(stdout, GT_("MAPI> All data received: data_pos=%u\n"), data_pos);
+	if (outlevel >= O_MONITOR) report(stdout, GT_("MAPI> All data received: data_pos=%u\n"), data_pos);
 
-    cookie = magic_open(MAGIC_MIME);
-    if (cookie == NULL) {
-	report(stderr, GT_("MAPI> mime error: %s\n"), magic_error(cookie));
-	return NULL;
-    }
-    if (magic_load(cookie, NULL) == -1) {
-	report(stderr, GT_("MAPI> mime error: %s\n"), magic_error(cookie));
+	cookie = magic_open(MAGIC_MIME);
+	if (cookie == NULL) {
+		report(stderr, GT_("MAPI> mime error: %s\n"), magic_error(cookie));
+		return NULL;
+	}
+	if (magic_load(cookie, NULL) == -1) {
+		report(stderr, GT_("MAPI> mime error: %s\n"), magic_error(cookie));
+		magic_close(cookie);
+		return NULL;
+	}
+	*magic = talloc_strdup(mem_ctx, magic_buffer(cookie, data.data, data.length));
 	magic_close(cookie);
-	return NULL;
-    }
-    *magic = talloc_strdup(mem_ctx, magic_buffer(cookie, data.data, data.length));
-    magic_close(cookie);
 
-    return ldb_base64_encode(mem_ctx, data.data, data.length);
+	return ldb_base64_encode(mem_ctx, data.data, data.length);
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  is_safe_char
- *  Description:  check if a character is safe to be represented as the ASCII character.
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  is_safe_char
+ *	Description:  check if a character is safe to be represented as the ASCII character.
  * =====================================================================================
  */
 static int is_safe_char(char ch)
 {
 	/*-----------------------------------------------------------------------------
-	 *  For total robustness, it is better to quote every character except for the
-	 *  73-character set known to be invariant across all gateways, that is the 
-	 *  letters anddigits (A-Z, a-z and 0-9) and the following 11 characters:
-	 *  ' ( ) + , - . / : = ?
+	 *	For total robustness, it is better to quote every character except for the
+	 *	73-character set known to be invariant across all gateways, that is the 
+	 *	letters anddigits (A-Z, a-z and 0-9) and the following 11 characters:
+	 *	' ( ) + , - . / : = ?
 	 *-----------------------------------------------------------------------------*/
-    return isalnum(ch) || ch == '\'' || ch == '(' || ch == ')' || ch == '+' || ch == ','
+	return isalnum(ch) || ch == '\'' || ch == '(' || ch == ')' || ch == '+' || ch == ','
 	|| ch == '-' || ch == '.' || ch == '/' || ch == ':' || ch == '=' || ch == '?';
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  quoted_printable_encode
- *  Description:  encode the body and append it to mapi_buffer 
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  quoted_printable_encode
+ *	Description:  encode the body and append it to g_mapi_buffer 
  * =====================================================================================
  */
 static void quoted_printable_encode(const DATA_BLOB * body, int *lenp)
 {
-    int             line_count = 0;
-    int             body_count = 0;
-    char            hex[16] = "0123456789ABCDEF";
-    char            ch;
-    char            line[78];
+	int				line_count = 0;
+	int				body_count = 0;
+	char			hex[16] = "0123456789ABCDEF";
+	char			ch;
+	char			line[78];
 
-    while (body_count < body->length) {
-	ch = *(body->data + body_count);
-	body_count++;
+	while (body_count < body->length)
+	{
+		ch = *(body->data + body_count);
+		body_count++;
 
-	if (is_safe_char(ch))
-	    line[line_count++] = ch;
-	else {
-	    line[line_count++] = '=';
-	    line[line_count++] = hex[(ch >> 4) & 15];
-	    line[line_count++] = hex[ch & 15];
-	}
+		if (is_safe_char(ch))
+			line[line_count++] = ch;
+		else {
+			line[line_count++] = '=';
+			line[line_count++] = hex[(ch >> 4) & 15];
+			line[line_count++] = hex[ch & 15];
+		}
 
-	if (line_count >= 73 || ch == '\n') {
-	    if (ch != '\n')
-		line[line_count++] = '=';
-	    line[line_count++] = '\r';
-	    line[line_count] = '\n';
+		if (line_count >= 73 || ch == '\n') {
+			if (ch != '\n')
+				line[line_count++] = '=';
+			line[line_count++] = '\r';
+			line[line_count] = '\n';
 
-	    data_blob_append(mapi_mem_ctx, &mapi_buffer, line, line_count);
-	    *lenp += line_count;
+			data_blob_append(g_mapi_mem_ctx, &g_mapi_buffer, line, line_count);
+			*lenp += line_count;
 
-	    line_count = 0;
+			line_count = 0;
+		}
 	}
-    }
-    if (line_count != 0) {
-	line[line_count++] = '\r';
-	line[line_count] = '\n';
-	data_blob_append(mapi_mem_ctx, &mapi_buffer, line, line_count);
-	*lenp += line_count;
-    }
+	if (line_count != 0) {
+		line[line_count++] = '\r';
+		line[line_count] = '\n';
+		data_blob_append(g_mapi_mem_ctx, &g_mapi_buffer, line, line_count);
+		*lenp += line_count;
+	}
 }
 
 
 static void mapi_clean()
 {
-    mapi_object_release(&mapi_obj_table);
-    mapi_object_release(&mapi_obj_folder);
-    mapi_object_release(&mapi_obj_store);
-    MAPIUninitialize();
-    talloc_free(mapi_mem_ctx);
+	mapi_object_release(&g_mapi_obj_table);
+	mapi_object_release(&g_mapi_obj_folder);
+	mapi_object_release(&g_mapi_obj_store);
+	MAPIUninitialize();
+	talloc_free(g_mapi_mem_ctx);
 
-    mapi_initialized = FALSE;
+	g_mapi_initialized = FALSE;
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_open_folder
- *  Description:  open folder that matches the name specified by --folder option
- *                Note: it only searches in the top level, i.e. it's not recursive 
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_open_folder
+ *	Description:  open folder that matches the name specified by --folder option
+ *				  Note: it only searches in the top level, i.e. it's not recursive 
  * =====================================================================================
  */
 static int mapi_open_folder(mapi_object_t * obj_container, mapi_object_t * obj_child, const char *folder)
 {
-    enum MAPISTATUS retval;
-    struct SPropTagArray *SPropTagArray;
-    struct SPropValue		*lpProps;
-    struct SRowSet  rowset;
-    mapi_object_t   obj_htable;
-    const char     *name;
-    const uint64_t *fid;
-    uint32_t        index;
-    int             count;
+	enum MAPISTATUS retval;
+	struct SPropTagArray *SPropTagArray;
+	struct SPropValue		*lpProps;
+	struct SRowSet	rowset;
+	mapi_object_t	obj_htable;
+	const char	   *name;
+	const uint64_t *fid;
+	uint32_t		index;
+	int				count;
 
-    mapi_object_init(&obj_htable);
-    retval = GetHierarchyTable(obj_container, &obj_htable, 0, &count);
-    if (retval != MAPI_E_SUCCESS)
-	return GetLastError();
+	mapi_object_init(&obj_htable);
+	retval = GetHierarchyTable(obj_container, &obj_htable, 0, &count);
+	if (retval != MAPI_E_SUCCESS) return GetLastError();
 
-    SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x2, PR_DISPLAY_NAME, PR_FID);
-    retval = SetColumns(&obj_htable, SPropTagArray);
-    MAPIFreeBuffer(SPropTagArray);
-    if (retval != MAPI_E_SUCCESS)
-	return GetLastError();
+	SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x2, PR_DISPLAY_NAME, PR_FID);
+	retval = SetColumns(&obj_htable, SPropTagArray);
+	MAPIFreeBuffer(SPropTagArray);
+	if (retval != MAPI_E_SUCCESS) return GetLastError();
 
-    retval = QueryRows(&obj_htable, count, TBL_ADVANCE, &rowset);
-    if (retval != MAPI_E_SUCCESS)
-	return GetLastError();
+	retval = QueryRows(&obj_htable, count, TBL_ADVANCE, &rowset);
+	if (retval != MAPI_E_SUCCESS) return GetLastError();
 
-    if (!rowset.cRows)
-	return MAPI_E_NOT_FOUND;
+	if (!rowset.cRows) return MAPI_E_NOT_FOUND;
 
-    for (index = 0; index < rowset.cRows; index++) {
-	fid = (const uint64_t *) find_SPropValue_data(&rowset.aRow[index], PR_FID);
-	name = (const char *) find_SPropValue_data(&rowset.aRow[index], PR_DISPLAY_NAME);
+	for (index = 0; index < rowset.cRows; index++)
+	{
+		fid = (const uint64_t *) find_SPropValue_data(&rowset.aRow[index], PR_FID);
+		name = (const char *) find_SPropValue_data(&rowset.aRow[index], PR_DISPLAY_NAME);
 
-	if (fid && !strcmp(name, folder)) {
-	    retval = OpenFolder(obj_container, *fid, obj_child);
-	    if (retval != MAPI_E_SUCCESS)
-		break;
+		if (fid && !strcmp(name, folder))
+		{
+			retval = OpenFolder(obj_container, *fid, obj_child);
+			if (retval != MAPI_E_SUCCESS) break;
 
-	    /*-----------------------------------------------------------------------------
-	     *  check the class of the folder, only IPF.Note and IPF.Post are supported
-	     *-----------------------------------------------------------------------------*/
-	    SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x1, PR_CONTAINER_CLASS);
-	    retval = GetProps(obj_container, SPropTagArray, &lpProps, &count);
-	    MAPIFreeBuffer(SPropTagArray);
+			/*-----------------------------------------------------------------------------
+			 *	check the class of the folder, only IPF.Note and IPF.Post are supported
+			 *-----------------------------------------------------------------------------*/
+			SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x1, PR_CONTAINER_CLASS);
+			retval = GetProps(obj_container, SPropTagArray, &lpProps, &count);
+			MAPIFreeBuffer(SPropTagArray);
 
-	    if ((lpProps[0].ulPropTag != PR_CONTAINER_CLASS) || (retval != MAPI_E_SUCCESS))
-		break;
+			if ((lpProps[0].ulPropTag != PR_CONTAINER_CLASS) || (retval != MAPI_E_SUCCESS)) break;
 
-	    if (strcmp(lpProps[0].value.lpszA, "IPF.Note") == 0 || strcmp(lpProps[0].value.lpszA, "IPF.Post") == 0)
-		return MAPI_E_SUCCESS;
+			if (strcmp(lpProps[0].value.lpszA, "IPF.Note") == 0 || strcmp(lpProps[0].value.lpszA, "IPF.Post") == 0)
+				return MAPI_E_SUCCESS;
+		}
 	}
-    }
 
-    report(stderr, GT_("MAPI: No folder matches the one specified by --folder option\n"));
-    return MAPI_E_NOT_FOUND;
+	report(stderr, GT_("MAPI: No folder matches the one specified by --folder option\n"));
+	return MAPI_E_NOT_FOUND;
 }
 
 static int mapi_init(const char *folder)
 {
-    enum MAPISTATUS retval;
-    mapi_object_t   obj_tis;
-    mapi_id_t       id_folder;
-    struct SPropTagArray *SPropTagArray = NULL;
-    const char     *profname;
-    uint32_t        count;
+	enum MAPISTATUS retval;
+	mapi_object_t	obj_tis;
+	mapi_id_t		id_folder;
+	struct SPropTagArray *SPropTagArray = NULL;
+	const char	   *profname;
+	uint32_t		count;
 
-    if (mapi_initialized)
-	mapi_clean();
+	if (g_mapi_initialized) mapi_clean();
 
-    mapi_mem_ctx = talloc_init("fetchmail");
+	g_mapi_mem_ctx = talloc_init("fetchmail");
 
-    /*-----------------------------------------------------------------------------
-     *  Initialize MAPI subsystem
-     *-----------------------------------------------------------------------------*/
-    retval = MAPIInitialize(mapi_profdb);
-    if (retval != MAPI_E_SUCCESS) {
-	report(stderr, GT_("MAPI: MAPIInitialize failed\n"));
-	mapi_clean();
-	return GetLastError();
-    }
-
-    /*-----------------------------------------------------------------------------
-     *  use the default mapi_profile
-     *-----------------------------------------------------------------------------*/
-    retval = GetDefaultProfile(&profname);
-    if (retval != MAPI_E_SUCCESS) {
-	report(stderr, GT_("MAPI: GetDefaultProfile failed\n"));
-	mapi_clean();
-	return GetLastError();
-    }
-
-    retval = MapiLogonEx(&s_mapi_session, profname, password);
-    if (retval != MAPI_E_SUCCESS) {
-	report(stderr, GT_("MAPI: MapiLogonEx failed\n"));
-	mapi_clean();
-	return GetLastError();
-    }
-    mapi_profile = s_mapi_session->profile;
-
-    /*-----------------------------------------------------------------------------
-     *  Open the default message store
-     *-----------------------------------------------------------------------------*/
-    mapi_object_init(&mapi_obj_store);
-    retval = OpenMsgStore(s_mapi_session, &mapi_obj_store);
-    if (retval != MAPI_E_SUCCESS) {
-	report(stderr, GT_("MAPI: OpenMsgStore failed\n"));
-	mapi_clean();
-	return GetLastError();
-    }
-
-    if (folder != NULL) {
 	/*-----------------------------------------------------------------------------
-         *  open TopInformationStore
-         *-----------------------------------------------------------------------------*/
-	retval = GetDefaultFolder(&mapi_obj_store, &id_folder, olFolderTopInformationStore);
+	 *	Initialize MAPI subsystem
+	 *-----------------------------------------------------------------------------*/
+	retval = MAPIInitialize(g_mapi_profdb);
 	if (retval != MAPI_E_SUCCESS) {
-	    report(stderr, GT_("MAPI: GetDefaultFolder-olFolderTopInformationStore failed\n"));
-	    mapi_clean();
-	    return GetLastError();
+		report(stderr, GT_("MAPI: MAPIInitialize failed\n"));
+		mapi_clean();
+		return GetLastError();
 	}
 
-	mapi_object_init(&obj_tis);
-	retval = OpenFolder(&mapi_obj_store, id_folder, &obj_tis);
+	/*-----------------------------------------------------------------------------
+	 *	use the default mapi_profile
+	 *-----------------------------------------------------------------------------*/
+	retval = GetDefaultProfile(&profname);
 	if (retval != MAPI_E_SUCCESS) {
-	    report(stderr, GT_("MAPI: OpenFolder-olFolderTopInformationStore failed\n"));
-	    mapi_clean();
-	    return GetLastError();
+		report(stderr, GT_("MAPI: GetDefaultProfile failed\n"));
+		mapi_clean();
+		return GetLastError();
 	}
 
-	retval = mapi_open_folder(&obj_tis, &mapi_obj_folder, folder);
+	retval = MapiLogonEx(&g_mapi_session, profname, g_password);
 	if (retval != MAPI_E_SUCCESS) {
-	    report(stderr, GT_("MAPI: mapi_open_folder failed\n"));
-	    mapi_clean();
-	    return retval;
+		report(stderr, GT_("MAPI: MapiLogonEx failed\n"));
+		mapi_clean();
+		return GetLastError();
 	}
-    } else {
+	mapi_profile = g_mapi_session->profile;
+
 	/*-----------------------------------------------------------------------------
-         *  open default Inbox
-         *-----------------------------------------------------------------------------*/
-	retval = GetDefaultFolder(&mapi_obj_store, &id_folder, olFolderInbox);
+	 *	Open the default message store
+	 *-----------------------------------------------------------------------------*/
+	mapi_object_init(&g_mapi_obj_store);
+	retval = OpenMsgStore(g_mapi_session, &g_mapi_obj_store);
 	if (retval != MAPI_E_SUCCESS) {
-	    report(stderr, GT_("MAPI: GetDefaultFolder-olFolderInbox failed\n"));
-	    mapi_clean();
-	    return GetLastError();
+		report(stderr, GT_("MAPI: OpenMsgStore failed\n"));
+		mapi_clean();
+		return GetLastError();
 	}
 
-	mapi_object_init(&mapi_obj_folder);
-	retval = OpenFolder(&mapi_obj_store, id_folder, &mapi_obj_folder);
-	if (retval != MAPI_E_SUCCESS) {
-	    report(stderr, GT_("MAPI: OpenFolder failed\n"));
-	    mapi_clean();
-	    return GetLastError();
+	if (folder != NULL)
+	{
+		/*-----------------------------------------------------------------------------
+		 *	open TopInformationStore
+		 *-----------------------------------------------------------------------------*/
+		retval = GetDefaultFolder(&g_mapi_obj_store, &id_folder, olFolderTopInformationStore);
+		if (retval != MAPI_E_SUCCESS) {
+			report(stderr, GT_("MAPI: GetDefaultFolder-olFolderTopInformationStore failed\n"));
+			mapi_clean();
+			return GetLastError();
+		}
+
+		mapi_object_init(&obj_tis);
+		retval = OpenFolder(&g_mapi_obj_store, id_folder, &obj_tis);
+		if (retval != MAPI_E_SUCCESS) {
+			report(stderr, GT_("MAPI: OpenFolder-olFolderTopInformationStore failed\n"));
+			mapi_clean();
+			return GetLastError();
+		}
+
+		retval = mapi_open_folder(&obj_tis, &g_mapi_obj_folder, folder);
+		if (retval != MAPI_E_SUCCESS) {
+			report(stderr, GT_("MAPI: mapi_open_folder failed\n"));
+			mapi_clean();
+			return retval;
+		}
 	}
-    }
+	else
+	{
+		/*-----------------------------------------------------------------------------
+		 *	open default Inbox
+		 *-----------------------------------------------------------------------------*/
+		retval = GetDefaultFolder(&g_mapi_obj_store, &id_folder, olFolderInbox);
+		if (retval != MAPI_E_SUCCESS) {
+			report(stderr, GT_("MAPI: GetDefaultFolder-olFolderInbox failed\n"));
+			mapi_clean();
+			return GetLastError();
+		}
 
-    mapi_object_init(&mapi_obj_table);
-    retval = GetContentsTable(&mapi_obj_folder, &mapi_obj_table, 0, &count);
-    if (retval != MAPI_E_SUCCESS) {
-	report(stderr, GT_("MAPI: GetContentsTable failed\n"));
-	mapi_clean();
-	return GetLastError();
-    }
+		mapi_object_init(&g_mapi_obj_folder);
+		retval = OpenFolder(&g_mapi_obj_store, id_folder, &g_mapi_obj_folder);
+		if (retval != MAPI_E_SUCCESS) {
+			report(stderr, GT_("MAPI: OpenFolder failed\n"));
+			mapi_clean();
+			return GetLastError();
+		}
+	}
 
-    SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x2, PR_FID, PR_MID);
-    retval = SetColumns(&mapi_obj_table, SPropTagArray);
-    MAPIFreeBuffer(SPropTagArray);
-    if (retval != MAPI_E_SUCCESS) {
-	report(stderr, GT_("MAPI: SetColumns failed\n"));
-	mapi_clean();
-	return GetLastError();
-    }
+	mapi_object_init(&g_mapi_obj_table);
+	retval = GetContentsTable(&g_mapi_obj_folder, &g_mapi_obj_table, 0, &count);
+	if (retval != MAPI_E_SUCCESS) {
+		report(stderr, GT_("MAPI: GetContentsTable failed\n"));
+		mapi_clean();
+		return GetLastError();
+	}
 
-    retval = QueryRows(&mapi_obj_table, count, TBL_ADVANCE, &mapi_rowset);
-    if (retval != MAPI_E_SUCCESS) {
-	report(stderr, GT_("MAPI: QueryRows failed\n"));
-	mapi_clean();
-	return GetLastError();
-    }
+	SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x2, PR_FID, PR_MID);
+	retval = SetColumns(&g_mapi_obj_table, SPropTagArray);
+	MAPIFreeBuffer(SPropTagArray);
+	if (retval != MAPI_E_SUCCESS) {
+		report(stderr, GT_("MAPI: SetColumns failed\n"));
+		mapi_clean();
+		return GetLastError();
+	}
 
-    mapi_id_array_init(&mapi_deleted_ids);
-    mapi_initialized = TRUE;
-    return MAPI_E_SUCCESS;
+	retval = QueryRows(&g_mapi_obj_table, count, TBL_ADVANCE, &g_mapi_rowset);
+	if (retval != MAPI_E_SUCCESS) {
+		report(stderr, GT_("MAPI: QueryRows failed\n"));
+		mapi_clean();
+		return GetLastError();
+	}
+
+	mapi_id_array_init(&g_mapi_deleted_ids);
+	g_mapi_initialized = TRUE;
+	return MAPI_E_SUCCESS;
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  translate_mapi_error
- *  Description:  translate mapi error code into fetchmail error code
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  translate_mapi_error
+ *	Description:  translate mapi error code into fetchmail error code
  * =====================================================================================
  */
 static int translate_mapi_error(enum MAPISTATUS mapi_error)
 {
-    switch (mapi_error) {
-    case MAPI_E_SUCCESS:
-	return PS_SUCCESS;
-    case MAPI_E_CALL_FAILED:
-    case MAPI_E_NO_SUPPORT:
-    case MAPI_E_BAD_CHARWIDTH:
-    case MAPI_E_STRING_TOO_LONG:
-    case MAPI_E_UNKNOWN_FLAGS:
-    case MAPI_E_INVALID_ENTRYID:
-    case MAPI_E_INVALID_OBJECT:
-    case MAPI_E_OBJECT_CHANGED:
-    case MAPI_E_OBJECT_DELETED:
-    case MAPI_E_BUSY:
-    case MAPI_E_NOT_ENOUGH_DISK:
-    case MAPI_E_NOT_ENOUGH_RESOURCES:
-    case MAPI_E_NOT_FOUND:
-    case MAPI_E_VERSION:
-    case MAPI_E_LOGON_FAILED:
-    case MAPI_E_SESSION_LIMIT:
-    case MAPI_E_USER_CANCEL:
-    case MAPI_E_UNABLE_TO_ABORT:
-    case MAPI_E_NETWORK_ERROR:
-    case MAPI_E_DISK_ERROR:
-    case MAPI_E_TOO_COMPLEX:
-    case MAPI_E_BAD_COLUMN:
-    case MAPI_E_EXTENDED_ERROR:
-    case MAPI_E_COMPUTED:
-    case MAPI_E_CORRUPT_DATA:
-    case MAPI_E_UNCONFIGURED:
-    case MAPI_E_FAILONEPROVIDER:
-    case MAPI_E_UNKNOWN_CPID:
-    case MAPI_E_UNKNOWN_LCID:
-    case MAPI_E_PASSWORD_CHANGE_REQUIRED:
-    case MAPI_E_PASSWORD_EXPIRED:
-    case MAPI_E_INVALID_WORKSTATION_ACCOUNT:
-    case MAPI_E_INVALID_ACCESS_TIME:
-    case MAPI_E_ACCOUNT_DISABLED:
-    case MAPI_E_END_OF_SESSION:
-    case MAPI_E_UNKNOWN_ENTRYID:
-    case MAPI_E_MISSING_REQUIRED_COLUMN:
-    case MAPI_W_NO_SERVICE:
-    case MAPI_E_BAD_VALUE:
-    case MAPI_E_INVALID_TYPE:
-    case MAPI_E_TYPE_NO_SUPPORT:
-    case MAPI_E_UNEXPECTED_TYPE:
-    case MAPI_E_TOO_BIG:
-    case MAPI_E_DECLINE_COPY:
-    case MAPI_E_UNEXPECTED_ID:
-    case MAPI_W_ERRORS_RETURNED:
-    case MAPI_E_UNABLE_TO_COMPLETE:
-    case MAPI_E_TIMEOUT:
-    case MAPI_E_TABLE_EMPTY:
-    case MAPI_E_TABLE_TOO_BIG:
-    case MAPI_E_INVALID_BOOKMARK:
-    case MAPI_W_POSITION_CHANGED:
-    case MAPI_W_APPROX_COUNT:
-    case MAPI_E_WAIT:
-    case MAPI_E_CANCEL:
-    case MAPI_E_NOT_ME:
-    case MAPI_W_CANCEL_MESSAGE:
-    case MAPI_E_CORRUPT_STORE:
-    case MAPI_E_NOT_IN_QUEUE:
-    case MAPI_E_NO_SUPPRESS:
-    case MAPI_E_COLLISION:
-    case MAPI_E_NOT_INITIALIZED:
-    case MAPI_E_NON_STANDARD:
-    case MAPI_E_NO_RECIPIENTS:
-    case MAPI_E_SUBMITTED:
-    case MAPI_E_HAS_FOLDERS:
-    case MAPI_E_HAS_MESAGES:
-    case MAPI_E_FOLDER_CYCLE:
-    case MAPI_W_PARTIAL_COMPLETION:
-    case MAPI_E_AMBIGUOUS_RECIP:
-    case MAPI_E_NO_ACCESS:
-    case MAPI_E_INVALID_PARAMETER:
-    case MAPI_E_RESERVED:
-    default:
-	return PS_UNDEFINED;
-    }
+	switch (mapi_error) {
+		case MAPI_E_SUCCESS: return PS_SUCCESS;
+		case MAPI_E_CALL_FAILED:
+		case MAPI_E_NO_SUPPORT:
+		case MAPI_E_BAD_CHARWIDTH:
+		case MAPI_E_STRING_TOO_LONG:
+		case MAPI_E_UNKNOWN_FLAGS:
+		case MAPI_E_INVALID_ENTRYID:
+		case MAPI_E_INVALID_OBJECT:
+		case MAPI_E_OBJECT_CHANGED:
+		case MAPI_E_OBJECT_DELETED:
+		case MAPI_E_BUSY:
+		case MAPI_E_NOT_ENOUGH_DISK:
+		case MAPI_E_NOT_ENOUGH_RESOURCES:
+		case MAPI_E_NOT_FOUND:
+		case MAPI_E_VERSION:
+		case MAPI_E_LOGON_FAILED:
+		case MAPI_E_SESSION_LIMIT:
+		case MAPI_E_USER_CANCEL:
+		case MAPI_E_UNABLE_TO_ABORT:
+		case MAPI_E_NETWORK_ERROR:
+		case MAPI_E_DISK_ERROR:
+		case MAPI_E_TOO_COMPLEX:
+		case MAPI_E_BAD_COLUMN:
+		case MAPI_E_EXTENDED_ERROR:
+		case MAPI_E_COMPUTED:
+		case MAPI_E_CORRUPT_DATA:
+		case MAPI_E_UNCONFIGURED:
+		case MAPI_E_FAILONEPROVIDER:
+		case MAPI_E_UNKNOWN_CPID:
+		case MAPI_E_UNKNOWN_LCID:
+		case MAPI_E_PASSWORD_CHANGE_REQUIRED:
+		case MAPI_E_PASSWORD_EXPIRED:
+		case MAPI_E_INVALID_WORKSTATION_ACCOUNT:
+		case MAPI_E_INVALID_ACCESS_TIME:
+		case MAPI_E_ACCOUNT_DISABLED:
+		case MAPI_E_END_OF_SESSION:
+		case MAPI_E_UNKNOWN_ENTRYID:
+		case MAPI_E_MISSING_REQUIRED_COLUMN:
+		case MAPI_W_NO_SERVICE:
+		case MAPI_E_BAD_VALUE:
+		case MAPI_E_INVALID_TYPE:
+		case MAPI_E_TYPE_NO_SUPPORT:
+		case MAPI_E_UNEXPECTED_TYPE:
+		case MAPI_E_TOO_BIG:
+		case MAPI_E_DECLINE_COPY:
+		case MAPI_E_UNEXPECTED_ID:
+		case MAPI_W_ERRORS_RETURNED:
+		case MAPI_E_UNABLE_TO_COMPLETE:
+		case MAPI_E_TIMEOUT:
+		case MAPI_E_TABLE_EMPTY:
+		case MAPI_E_TABLE_TOO_BIG:
+		case MAPI_E_INVALID_BOOKMARK:
+		case MAPI_W_POSITION_CHANGED:
+		case MAPI_W_APPROX_COUNT:
+		case MAPI_E_WAIT:
+		case MAPI_E_CANCEL:
+		case MAPI_E_NOT_ME:
+		case MAPI_W_CANCEL_MESSAGE:
+		case MAPI_E_CORRUPT_STORE:
+		case MAPI_E_NOT_IN_QUEUE:
+		case MAPI_E_NO_SUPPRESS:
+		case MAPI_E_COLLISION:
+		case MAPI_E_NOT_INITIALIZED:
+		case MAPI_E_NON_STANDARD:
+		case MAPI_E_NO_RECIPIENTS:
+		case MAPI_E_SUBMITTED:
+		case MAPI_E_HAS_FOLDERS:
+		case MAPI_E_HAS_MESAGES:
+		case MAPI_E_FOLDER_CYCLE:
+		case MAPI_W_PARTIAL_COMPLETION:
+		case MAPI_E_AMBIGUOUS_RECIP:
+		case MAPI_E_NO_ACCESS:
+		case MAPI_E_INVALID_PARAMETER:
+		case MAPI_E_RESERVED:
+
+		default: return PS_UNDEFINED;
+	}
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  expunge_deleted
- *  Description:  perform hard delete
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  expunge_deleted
+ *	Description:  perform hard delete
  * =====================================================================================
  */
 static int expunge_deleted()
 {
-    enum MAPISTATUS retval;
-    mapi_id_t      *deleted_ids;
+	enum MAPISTATUS retval;
+	mapi_id_t	   *deleted_ids;
 
-    if (mapi_deleted_ids.count == 0)
-	return (PS_SUCCESS);
-    /*-----------------------------------------------------------------------------
-     *  perform hard delete
-     *-----------------------------------------------------------------------------*/
-    mapi_id_array_get(mapi_mem_ctx, &mapi_deleted_ids, &deleted_ids);
-    retval = DeleteMessage(&mapi_obj_folder, deleted_ids, mapi_deleted_ids.count);
-    if (retval != MAPI_E_SUCCESS) {
-	report(stderr, "MAPI: DeleteMessages failed\n");
-	talloc_free(deleted_ids);
-	return translate_mapi_error(GetLastError());
-    }
+	if (g_mapi_deleted_ids.count == 0) return PS_SUCCESS;
+	/*-----------------------------------------------------------------------------
+	 *	perform hard delete
+	 *-----------------------------------------------------------------------------*/
+	mapi_id_array_get(g_mapi_mem_ctx, &g_mapi_deleted_ids, &deleted_ids);
+	retval = DeleteMessage(&g_mapi_obj_folder, deleted_ids, g_mapi_deleted_ids.count);
+	if (retval != MAPI_E_SUCCESS) {
+		report(stderr, "MAPI: DeleteMessages failed\n");
+		talloc_free(deleted_ids);
+		return translate_mapi_error(GetLastError());
+	}
 
-    talloc_free(deleted_ids);
-    return (PS_SUCCESS);
+	talloc_free(deleted_ids);
+	return PS_SUCCESS;
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_ok
- *  Description:  no need to parse response in MAPI, return PS_SUCCESS to fake the driver
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_ok
+ *	Description:  no need to parse response in MAPI, return PS_SUCCESS to fake the driver
  * =====================================================================================
  */
 static int mapi_ok(int sock, char *argbuf)
 {
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_ok()\n");
-
-    return (PS_SUCCESS);
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_ok()\n");
+	return PS_SUCCESS;
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  callback
- *  Description:  when not running in daemon mode, give a chance to choose an account
- *                while multiple accounts match the user name.
- *                when running in daemon mode, skip this and mapi_getauth will return
- *                PS_AUTHFAIL.
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  callback
+ *	Description:  when not running in daemon mode, give a chance to choose an account
+ *				  while multiple accounts match the user name.
+ *				  when running in daemon mode, skip this and mapi_getauth will return
+ *				  PS_AUTHFAIL.
  * =====================================================================================
  */
 static uint32_t callback(struct SRowSet *rowset, void *private)
 {
-    /* TODO: check if running in daemon mode*/
-    int             daemon_mode = FALSE;
+	/* TODO: check if running in daemon mode*/
+	int				daemon_mode = FALSE;
 
-    if (!daemon_mode) {
-	uint32_t        i;
-	struct SPropValue *lpProp;
-	FILE           *fd;
-	uint32_t        index;
-	char            entry[10];
-	const char     *label = (const char *) private;
+	if (!daemon_mode) 
+	{
+		uint32_t		i;
+		struct SPropValue *lpProp;
+		FILE		   *fd;
+		uint32_t		index;
+		char			entry[10];
+		const char	   *label = (const char *) private;
 
-	printf("%s:\n", label);
-	for (i = 0; i < rowset->cRows; i++) {
-	    lpProp = get_SPropValue_SRow(&(rowset->aRow[i]), PR_DISPLAY_NAME);
-	    if (lpProp && lpProp->value.lpszA) {
-		printf("\t[%d] %s\n", i, lpProp->value.lpszA);
-	    }
-	}
-	printf("\t[%d] cancel operation\n", i);
-	fd = fdopen(0, "r");
-      getentry:
-	printf("Enter username id [0]: ");
-	fgets(entry, 10, fd);
-	index = atoi(entry);
-	if (index > i) {
-	    printf("Invalid id - Must be contained between 0 and %d\n", i);
-	    goto getentry;
-	}
+		printf("%s:\n", label);
+		for (i = 0; i < rowset->cRows; i++) {
+			lpProp = get_SPropValue_SRow(&(rowset->aRow[i]), PR_DISPLAY_NAME);
+			if (lpProp && lpProp->value.lpszA)
+				printf("\t[%d] %s\n", i, lpProp->value.lpszA);
+		}
+		printf("\t[%d] cancel operation\n", i);
+		fd = fdopen(0, "r");
+		  getentry:
+		printf("Enter username id [0]: ");
+		fgets(entry, 10, fd);
+		index = atoi(entry);
+		if (index > i) {
+			printf("Invalid id - Must be contained between 0 and %d\n", i);
+			goto getentry;
+		}
 
-	fclose(fd);
-	return (index);
-    } else
-	return rowset->cRows;
+		fclose(fd);
+		return index;
+	}
+	else
+		return rowset->cRows;
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_getauth
- *  Description:  1. synchronize mapi_profile with the setting
- *                2. open the mapi_profile and initialize MAPI
- *                if all of the operations are successful, it will be considered
- *                a successful anthentication. 
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_getauth
+ *	Description:  1. synchronize mapi_profile with the setting
+ *				  2. open the mapi_profile and initialize MAPI
+ *				  if all of the operations are successful, it will be considered
+ *				  a successful anthentication. 
  * =====================================================================================
  */
 static int mapi_getauth(int sock, struct query *ctl, char *greeting)
 {
-    enum MAPISTATUS retval;
-    struct mapi_session *session = NULL;
-    struct SRowSet  proftable;
-    int             profcount;
-    char            localhost_name[256];
-    const char     *workstation = NULL;
-    const char     *ldif = NULL;
-    const char     *profname = NULL;
-    const char     *name_in_proftable = NULL;
-    uint32_t        flags;
-    char           *realhost = ctl->server.via ? ctl->server.via : ctl->server.pollname;
+	enum MAPISTATUS retval;
+	struct mapi_session *session = NULL;
+	struct SRowSet	proftable;
+	int				profcount;
+	char			localhost_name[256];
+	const char	   *workstation = NULL;
+	const char	   *ldif = NULL;
+	const char	   *profname = NULL;
+	const char	   *name_in_proftable = NULL;
+	uint32_t		flags;
+	char		   *realhost = ctl->server.via ? ctl->server.via : ctl->server.pollname;
 
-    if (outlevel > O_MONITOR)
-	report(stdout, "MAPI> mapi_getauth()\n");
+	if (outlevel > O_MONITOR) report(stdout, "MAPI> mapi_getauth()\n");
 
-    mapi_mem_ctx = talloc_init("mapi_getauth");
-    /*-----------------------------------------------------------------------------
-     *  initialize several options
-     *-----------------------------------------------------------------------------*/
-    strcpy(password, ctl->password);
-    if (!ctl->mapi_ldif)
-	ldif = talloc_strdup(mapi_mem_ctx, mapi_profile_get_ldif_path());
-    else
-	ldif = ctl->mapi_ldif;
+	g_mapi_mem_ctx = talloc_init("mapi_getauth");
+	/*-----------------------------------------------------------------------------
+	 *	initialize several options
+	 *-----------------------------------------------------------------------------*/
+	strcpy(g_password, ctl->password);
+	if (!ctl->mapi_ldif)
+		ldif = talloc_strdup(g_mapi_mem_ctx, mapi_profile_get_ldif_path());
+	else
+		ldif = ctl->mapi_ldif;
 
-    if (!ctl->mapi_profname)
-	profname = ctl->remotename;	/* use the remotename as the profile name */
-    else
-	profname = ctl->mapi_profname;
+	if (!ctl->mapi_profname)
+		profname = ctl->remotename;	/* use the remotename as the profile name */
+	else
+		profname = ctl->mapi_profname;
 
-    if (!ctl->mapi_profdb)
-	sprintf(mapi_profdb, DEFAULT_MAPI_PROFILES, getenv("HOME"));
-    else
-	strcpy(mapi_profdb, ctl->mapi_profdb);
+	if (!ctl->mapi_profdb)
+		sprintf(g_mapi_profdb, DEFAULT_MAPI_PROFILES, getenv("HOME"));
+	else
+		strcpy(g_mapi_profdb, ctl->mapi_profdb);
 
-    if (!ctl->mapi_workstation) {
-	gethostname(localhost_name, sizeof(localhost_name) - 1);
-	localhost_name[sizeof(localhost_name) - 1] = 0;
-	workstation = localhost_name;
-    } else
-	workstation = ctl->mapi_workstation;
+	if (!ctl->mapi_workstation) {
+		gethostname(localhost_name, sizeof(localhost_name) - 1);
+		localhost_name[sizeof(localhost_name) - 1] = 0;
+		workstation = localhost_name;
+	} else
+		workstation = ctl->mapi_workstation;
 
-    /*-----------------------------------------------------------------------------
-     *  mapi_domain is a required option! how to check if it is specified?
-     *  if not specified, default values of workstation, ldif and mapi_lcid (set in 
-     *  fetchmail.c) are used
-     *-----------------------------------------------------------------------------*/
-    if (!ctl->mapi_domain || !workstation || !ldif || !ctl->mapi_lcid) {
-	talloc_free(mapi_mem_ctx);
-	return PS_AUTHFAIL;
-    }
+	/*-----------------------------------------------------------------------------
+	 *	mapi_domain is a required option! how to check if it is specified?
+	 *	if not specified, default values of workstation, ldif and mapi_lcid (set in 
+	 *	fetchmail.c) are used
+	 *-----------------------------------------------------------------------------*/
+	if (!ctl->mapi_domain || !workstation || !ldif || !ctl->mapi_lcid) {
+		talloc_free(g_mapi_mem_ctx);
+		return PS_AUTHFAIL;
+	}
 
-    if (access(mapi_profdb, F_OK) != 0) {
-    /*-----------------------------------------------------------------------------
-     *  create mapi mapi_profile database
-     *-----------------------------------------------------------------------------*/
-	retval = CreateProfileStore(mapi_profdb, ldif);
-	if (retval != MAPI_E_SUCCESS) {
-	    talloc_free(mapi_mem_ctx);
-	    return translate_mapi_error(GetLastError());
+	if (access(g_mapi_profdb, F_OK) != 0) {
+		/*-----------------------------------------------------------------------------
+		 *	create mapi mapi_profile database
+		 *-----------------------------------------------------------------------------*/
+		retval = CreateProfileStore(g_mapi_profdb, ldif);
+		if (retval != MAPI_E_SUCCESS) {
+			talloc_free(g_mapi_mem_ctx);
+			return translate_mapi_error(GetLastError());
+		}
+		if (outlevel == O_DEBUG) report(stdout, GT_("MAPI> MAPI mapi_profile database %s created\n"), g_mapi_profdb);
 	}
-	if (outlevel == O_DEBUG)
-	    report(stdout, GT_("MAPI> MAPI mapi_profile database %s created\n"), mapi_profdb);
-    }
 
-    retval = MAPIInitialize(mapi_profdb);
-    if (retval != MAPI_E_SUCCESS)
-	goto clean;
-    if (outlevel == O_DEBUG)
-	report(stdout, GT_("MAPI> MAPI initialized\n"));
+	retval = MAPIInitialize(g_mapi_profdb);
+	if (retval != MAPI_E_SUCCESS) goto clean;
+	if (outlevel == O_DEBUG) report(stdout, GT_("MAPI> MAPI initialized\n"));
 
-    memset(&proftable, 0, sizeof(struct SRowSet));
-    retval = GetProfileTable(&proftable);
-    if (retval != MAPI_E_SUCCESS)
-	goto clean;
-    if (outlevel == O_DEBUG)
-	report(stdout, GT_("MAPI> MAPI GetProfiletable\n"));
+	memset(&proftable, 0, sizeof(struct SRowSet));
+	retval = GetProfileTable(&proftable);
+	if (retval != MAPI_E_SUCCESS) goto clean;
+	if (outlevel == O_DEBUG) report(stdout, GT_("MAPI> MAPI GetProfiletable\n"));
 
+	for (profcount = 0; profcount != proftable.cRows; profcount++) {
+		name_in_proftable = proftable.aRow[profcount].lpProps[0].value.lpszA;
+		if (strcmp(name_in_proftable, profname) == 0) break;
+	}
 
-    for (profcount = 0; profcount != proftable.cRows; profcount++) {
-	name_in_proftable = proftable.aRow[profcount].lpProps[0].value.lpszA;
-	if (strcmp(name_in_proftable, profname) == 0)
-	    break;
-    }
+	if (profcount == proftable.cRows)
+	{
+		flags = 0;		/* do not save g_password in the mapi_profile */
+		retval = CreateProfile(profname, ctl->remotename, g_password, flags);
+		if (retval != MAPI_E_SUCCESS) goto clean;
 
-    if (profcount == proftable.cRows) {
-	flags = 0;		/* do not save password in the mapi_profile */
-	retval = CreateProfile(profname, ctl->remotename, password, flags);
-	if (retval != MAPI_E_SUCCESS)
-	    goto clean;
+		mapi_profile_add_string_attr(profname, "binding", realhost);
+		mapi_profile_add_string_attr(profname, "workstation", workstation);
+		mapi_profile_add_string_attr(profname, "domain", ctl->mapi_domain);
+		mapi_profile_add_string_attr(profname, "codepage", "0x4e4");
+		mapi_profile_add_string_attr(profname, "language", ctl->mapi_lcid);
+		mapi_profile_add_string_attr(profname, "method", "0x409");
+		if (outlevel == O_DEBUG) report(stdout, GT_("MAPI> MAPI mapi_profile %s created\n"), profname);
+	}
+	else
+	{
+		mapi_profile_modify_string_attr(profname, "binding", realhost);
+		mapi_profile_modify_string_attr(profname, "workstation", workstation);
+		mapi_profile_modify_string_attr(profname, "domain", ctl->mapi_domain);
+		mapi_profile_modify_string_attr(profname, "codepage", "0x4e4");
+		mapi_profile_modify_string_attr(profname, "language", ctl->mapi_lcid);
+		mapi_profile_modify_string_attr(profname, "method", "0x409");
 
-	mapi_profile_add_string_attr(profname, "binding", realhost);
-	mapi_profile_add_string_attr(profname, "workstation", workstation);
-	mapi_profile_add_string_attr(profname, "domain", ctl->mapi_domain);
-	mapi_profile_add_string_attr(profname, "codepage", "0x4e4");
-	mapi_profile_add_string_attr(profname, "language", ctl->mapi_lcid);
-	mapi_profile_add_string_attr(profname, "method", "0x409");
-	if (outlevel == O_DEBUG)
-	    report(stdout, GT_("MAPI> MAPI mapi_profile %s created\n"), profname);
-    } else {
-	mapi_profile_modify_string_attr(profname, "binding", realhost);
-	mapi_profile_modify_string_attr(profname, "workstation", workstation);
-	mapi_profile_modify_string_attr(profname, "domain", ctl->mapi_domain);
-	mapi_profile_modify_string_attr(profname, "codepage", "0x4e4");
-	mapi_profile_modify_string_attr(profname, "language", ctl->mapi_lcid);
-	mapi_profile_modify_string_attr(profname, "method", "0x409");
+		if (outlevel == O_DEBUG) report(stdout, GT_("MAPI> MAPI mapi_profile %s updated\n"), profname);
+	}
 
-	if (outlevel == O_DEBUG)
-	    report(stdout, GT_("MAPI> MAPI mapi_profile %s updated\n"), profname);
-    }
+	retval = MapiLogonProvider(&session, profname, g_password, PROVIDER_ID_NSPI);
+	if (retval != MAPI_E_SUCCESS) goto clean;
+	if (outlevel == O_DEBUG) report(stdout, GT_("MAPI> MapiLogonProvider\n"));
 
+	retval = ProcessNetworkProfile(session, ctl->remotename, (mapi_profile_callback_t) callback, "Select a user id");
+	if (retval != MAPI_E_SUCCESS) goto clean;
+	if (outlevel == O_DEBUG) report(stdout, GT_("MAPI> processed a full and automated MAPI mapi_profile creation\n"));
 
-    retval = MapiLogonProvider(&session, profname, password, PROVIDER_ID_NSPI);
-    if (retval != MAPI_E_SUCCESS)
-	goto clean;
-    if (outlevel == O_DEBUG)
-	report(stdout, GT_("MAPI> MapiLogonProvider\n"));
+	retval = SetDefaultProfile(profname);
+	if (retval != MAPI_E_SUCCESS) goto clean;
+	if (outlevel == O_DEBUG) report(stdout, GT_("MAPI> set default mapi_profile to %s\n"), profname);
 
+	MAPIUninitialize();
+	talloc_free(g_mapi_mem_ctx);
+	return PS_SUCCESS;
 
-    retval = ProcessNetworkProfile(session, ctl->remotename, (mapi_profile_callback_t) callback, "Select a user id");
-    if (retval != MAPI_E_SUCCESS)
-	goto clean;
-    if (outlevel == O_DEBUG)
-	report(stdout, GT_("MAPI> processed a full and automated MAPI mapi_profile creation\n"));
-
-
-    retval = SetDefaultProfile(profname);
-    if (retval != MAPI_E_SUCCESS)
-	goto clean;
-    if (outlevel == O_DEBUG)
-	report(stdout, GT_("MAPI> set default mapi_profile to %s\n"), profname);
-
-    MAPIUninitialize();
-    talloc_free(mapi_mem_ctx);
-    return PS_SUCCESS;
-
-  clean:MAPIUninitialize();
-    talloc_free(mapi_mem_ctx);
-    return translate_mapi_error(GetLastError());
+clean:
+	MAPIUninitialize();
+	talloc_free(g_mapi_mem_ctx);
+	return translate_mapi_error(GetLastError());
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_getrange
- *  Description:  get range of messages to be fetched
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_getrange
+ *	Description:  get range of messages to be fetched
  * =====================================================================================
  */
 static int mapi_getrange(int sock, struct query *ctl, const char *folder, int *countp, int *newp, int *bytes)
 {
-    enum MAPISTATUS retval;
-    int             flag = PS_SUCCESS;
-    struct SPropTagArray *SPropTagArray = NULL;
-    struct SPropValue *lpProps;
-    struct SRow     aRow;
-    const char     *msgid;
-    int             props_count;
-    mapi_object_t   obj_message;
-    mapi_id_t      *fid;
-    mapi_id_t      *mid;
-    int             i;
+	enum MAPISTATUS retval;
+	int				flag = PS_SUCCESS;
+	struct SPropTagArray *SPropTagArray = NULL;
+	struct SPropValue *lpProps;
+	struct SRow		aRow;
+	const char	   *msgid;
+	int				props_count;
+	mapi_object_t	obj_message;
+	mapi_id_t	   *fid;
+	mapi_id_t	   *mid;
+	int				i;
 
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_getrange()\n");
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_getrange()\n");
 
-    *countp = 0;
-    *newp = 0;
-    *bytes = 0;
+	*countp = 0;
+	*newp = 0;
+	*bytes = 0;
 
 
-    /*-----------------------------------------------------------------------------
-     * initialize mapi here
-     *-----------------------------------------------------------------------------*/
-    flag = mapi_init(folder);
-    if (flag) {
-	report(stderr, GT_("MAPI: MAPI is not initialized\n"));
-	return (PS_UNDEFINED);
-    }
+	/*-----------------------------------------------------------------------------
+	 * initialize mapi here
+	 *-----------------------------------------------------------------------------*/
+	flag = mapi_init(folder);
+	if (flag) {
+		report(stderr, GT_("MAPI: MAPI is not initialized\n"));
+		return PS_UNDEFINED;
+	}
 
-    *countp = mapi_rowset.cRows;
+	*countp = g_mapi_rowset.cRows;
 
-    for (i = 0; i < mapi_rowset.cRows; i++) {
-	fid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[i]), PR_FID);
-	mid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[i]), PR_MID);
-	mapi_object_init(&obj_message);
+	for (i = 0; i < g_mapi_rowset.cRows; i++) {
+		fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[i]), PR_FID);
+		mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[i]), PR_MID);
+		mapi_object_init(&obj_message);
 
-	retval = OpenMessage(&mapi_obj_store, *fid, *mid, &obj_message, 0x0);
+		retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
 
-	if (retval == MAPI_E_SUCCESS) {
-	    SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x3, PR_INTERNET_MESSAGE_ID, PR_MESSAGE_FLAGS, PR_MESSAGE_SIZE);
-	    retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
-	    MAPIFreeBuffer(SPropTagArray);
-	    if (retval != MAPI_E_SUCCESS) {
-		flag = translate_mapi_error(GetLastError());
-		talloc_free(lpProps);
-		mapi_object_release(&obj_message);
-		mapi_clean();
-		return flag;
-	    }
+		if (retval == MAPI_E_SUCCESS)
+		{
+			SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x3, PR_INTERNET_MESSAGE_ID, PR_MESSAGE_FLAGS, PR_MESSAGE_SIZE);
+			retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
+			MAPIFreeBuffer(SPropTagArray);
+			if (retval != MAPI_E_SUCCESS) {
+				flag = translate_mapi_error(GetLastError());
+				talloc_free(lpProps);
+				mapi_object_release(&obj_message);
+				mapi_clean();
+				return flag;
+			}
 
-	    /*-----------------------------------------------------------------------------
-	     *  build a SRow structure
-	     *-----------------------------------------------------------------------------*/
-	    aRow.ulAdrEntryPad = 0;
-	    aRow.cValues = props_count;
-	    aRow.lpProps = lpProps;
+			/*-----------------------------------------------------------------------------
+			 *	build a SRow structure
+			 *-----------------------------------------------------------------------------*/
+			aRow.ulAdrEntryPad = 0;
+			aRow.cValues = props_count;
+			aRow.lpProps = lpProps;
 
-	    msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
-	    long            message_flags = *(const long *) find_SPropValue_data(&aRow,
-										 PR_MESSAGE_FLAGS);
-	    if (msgid && !(message_flags & MSGFLAG_READ)) {
-		(*newp)++;
-		(*bytes)
-		    += *(const long *)
-		    find_SPropValue_data(&aRow, PR_MESSAGE_SIZE);
-	    }
-	    talloc_free(lpProps);
+			msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
+			long	message_flags = *(const long *) find_SPropValue_data(&aRow, PR_MESSAGE_FLAGS);
+			if (msgid && !(message_flags & MSGFLAG_READ))
+			{
+				(*newp)++;
+				(*bytes) += *(const long *) find_SPropValue_data(&aRow, PR_MESSAGE_SIZE);
+			}
+			talloc_free(lpProps);
+		}
+		mapi_object_release(&obj_message);
 	}
-	mapi_object_release(&obj_message);
-    }
 
-    return PS_SUCCESS;
+	return PS_SUCCESS;
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_getpartialsizes
- *  Description:  capture the sizes of messages #first-#last
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_getpartialsizes
+ *	Description:  capture the sizes of messages #first-#last
  * =====================================================================================
  */
 static int mapi_getpartialsizes(int sock, int first, int last, int *sizes)
 {
-    enum MAPISTATUS retval;
-    int             flag = PS_SUCCESS;
-    struct SPropTagArray *SPropTagArray = NULL;
-    struct SPropValue *lpProps;
-    struct SRow     aRow;
-    int             props_count;
-    mapi_object_t   obj_message;
-    const char     *msgid;
-    mapi_id_t      *fid;
-    mapi_id_t      *mid;
-    int             i;
+	enum MAPISTATUS retval;
+	int				flag = PS_SUCCESS;
+	struct SPropTagArray *SPropTagArray = NULL;
+	struct SPropValue *lpProps;
+	struct SRow		aRow;
+	int				props_count;
+	mapi_object_t	obj_message;
+	const char	   *msgid;
+	mapi_id_t	   *fid;
+	mapi_id_t	   *mid;
+	int				i;
 
-    if (first != -1) {
-	if (outlevel >= O_MONITOR)
-	    report(stdout, "MAPI> mapi_getpartialsizes(first %d, last %d)\n", first, last);
-    } else
-	first = 1;
+	if (first != -1)
+	{
+		if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_getpartialsizes(first %d, last %d)\n", first, last);
+	}
+	else
+		first = 1;
 
-    if (!mapi_initialized) {
-	report(stderr, GT_("MAPI: MAPI is not initialized\n"));
-	return (PS_UNDEFINED);
-    }
+	if (!g_mapi_initialized) {
+		report(stderr, GT_("MAPI: MAPI is not initialized\n"));
+		return PS_UNDEFINED;
+	}
 
-    for (i = first; i <= mapi_rowset.cRows && i <= last; i++) {
-	fid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[i - 1]), PR_FID);
-	mid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[i - 1]), PR_MID);
-	mapi_object_init(&obj_message);
+	for (i = first; i <= g_mapi_rowset.cRows && i <= last; i++)
+	{
+		fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[i - 1]), PR_FID);
+		mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[i - 1]), PR_MID);
+		mapi_object_init(&obj_message);
 
-	retval = OpenMessage(&mapi_obj_store, *fid, *mid, &obj_message, 0x0);
+		retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
 
-	if (retval == MAPI_E_SUCCESS) {
-	    SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x2, PR_INTERNET_MESSAGE_ID, PR_MESSAGE_SIZE);
-	    retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
-	    MAPIFreeBuffer(SPropTagArray);
-	    if (retval != MAPI_E_SUCCESS) {
-		flag = translate_mapi_error(GetLastError());
-		talloc_free(lpProps);
-		mapi_object_release(&obj_message);
-		mapi_clean();
-		return flag;
-	    }
+		if (retval == MAPI_E_SUCCESS)
+		{
+			SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x2, PR_INTERNET_MESSAGE_ID, PR_MESSAGE_SIZE);
+			retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
+			MAPIFreeBuffer(SPropTagArray);
+			if (retval != MAPI_E_SUCCESS)
+			{
+				flag = translate_mapi_error(GetLastError());
+				talloc_free(lpProps);
+				mapi_object_release(&obj_message);
+				mapi_clean();
+				return flag;
+			}
 
-	    /*
-	     * Build a SRow structure 
-	     */
-	    aRow.ulAdrEntryPad = 0;
-	    aRow.cValues = props_count;
-	    aRow.lpProps = lpProps;
+			/*
+			 * Build a SRow structure 
+			 */
+			aRow.ulAdrEntryPad = 0;
+			aRow.cValues = props_count;
+			aRow.lpProps = lpProps;
 
-	    msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
-	    if (msgid) {
-		sizes[i - first] = *(const long *)
-		    find_SPropValue_data(&aRow, PR_MESSAGE_SIZE);
-	    }
-	    talloc_free(lpProps);
+			msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
+			if (msgid)
+				sizes[i - first] = *(const long *) find_SPropValue_data(&aRow, PR_MESSAGE_SIZE);
+			talloc_free(lpProps);
+		}
+		mapi_object_release(&obj_message);
 	}
-	mapi_object_release(&obj_message);
-    }
 
-    return PS_SUCCESS;
+	return PS_SUCCESS;
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_getsizes
- *  Description:  capture the sizes of all messages
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_getsizes
+ *	Description:  capture the sizes of all messages
  * =====================================================================================
  */
 static int mapi_getsizes(int sock, int mail_count, int *sizes)
 {
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_getsizes(mail_count %d)\n", mail_count);
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_getsizes(mail_count %d)\n", mail_count);
 
-    /*-----------------------------------------------------------------------------
-     *  set first to -1 to shut down report message in mapi_getpartialsizes()
-     *-----------------------------------------------------------------------------*/
-    return mapi_getpartialsizes(sock, -1, mail_count, sizes);
+	/*-----------------------------------------------------------------------------
+	 *	set first to -1 to shut down report message in mapi_getpartialsizes()
+	 *-----------------------------------------------------------------------------*/
+	return mapi_getpartialsizes(sock, -1, mail_count, sizes);
 }
 
-
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_is_old
- *  Description:  is the given message old?
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_is_old
+ *	Description:  is the given message old?
  * =====================================================================================
  */
 static int mapi_is_old(int sock, struct query *ctl, int number)
 {
-    enum MAPISTATUS retval;
-    int             flag = FALSE;
-    struct SPropTagArray *SPropTagArray = NULL;
-    struct SPropValue *lpProps;
-    struct SRow     aRow;
-    mapi_object_t   obj_message;
-    const char     *msgid;
-    mapi_id_t      *fid;
-    mapi_id_t      *mid;
-    int             props_count;
+	enum MAPISTATUS retval;
+	int				flag = FALSE;
+	struct SPropTagArray *SPropTagArray = NULL;
+	struct SPropValue *lpProps;
+	struct SRow		aRow;
+	mapi_object_t	obj_message;
+	const char	   *msgid;
+	mapi_id_t	   *fid;
+	mapi_id_t	   *mid;
+	int				props_count;
 
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_is_old(number %d)\n", number);
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_is_old(number %d)\n", number);
 
-    if (!mapi_initialized) {
-	report(stderr, GT_("MAPI: MAPI is not initialized\n"));
-	return (PS_UNDEFINED);
-    }
+	if (!g_mapi_initialized) {
+		report(stderr, GT_("MAPI: MAPI is not initialized\n"));
+		return PS_UNDEFINED;
+	}
 
-    if (mapi_rowset.cRows < number)
-	return FALSE;
+	if (g_mapi_rowset.cRows < number) return FALSE;
 
-    fid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_FID);
-    mid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_MID);
-    mapi_object_init(&obj_message);
+	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	mapi_object_init(&obj_message);
 
-    retval = OpenMessage(&mapi_obj_store, *fid, *mid, &obj_message, 0x0);
-    if (retval == MAPI_E_SUCCESS) {
-	SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x1, PR_INTERNET_MESSAGE_ID);
-	retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
-	MAPIFreeBuffer(SPropTagArray);
-	if (retval == MAPI_E_SUCCESS) {
-	    /*
-	     * Build a SRow structure 
-	     */
-	    aRow.ulAdrEntryPad = 0;
-	    aRow.cValues = props_count;
-	    aRow.lpProps = lpProps;
-
-	    msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
-	    if (msgid) {
-		retval = FindProfileAttr(mapi_profile, "Message-ID", msgid);
+	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
+	if (retval == MAPI_E_SUCCESS)
+	{
+		SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x1, PR_INTERNET_MESSAGE_ID);
+		retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
+		MAPIFreeBuffer(SPropTagArray);
 		if (retval == MAPI_E_SUCCESS) {
-		    if (outlevel == O_DEBUG)
-			report(stdout, "MAPI> message %d with Message-ID=%s is old\n", number, msgid);
-		    flag = TRUE;
+			/* Build a SRow structure */
+			aRow.ulAdrEntryPad = 0;
+			aRow.cValues = props_count;
+			aRow.lpProps = lpProps;
+
+			msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
+			if (msgid) {
+				retval = FindProfileAttr(mapi_profile, "Message-ID", msgid);
+				if (retval == MAPI_E_SUCCESS) {
+					if (outlevel == O_DEBUG) report(stdout, "MAPI> message %d with Message-ID=%s is old\n", number, msgid);
+					flag = TRUE;
+				}
+			}
 		}
-	    }
-	} else
-	    mapi_clean();
-	talloc_free(lpProps);
-    }
+		else
+			mapi_clean();
+		talloc_free(lpProps);
+	}
 
-    mapi_object_release(&obj_message);
-    return flag;
+	mapi_object_release(&obj_message);
+	return flag;
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  smtp_address
- *  Description:  write the smtp address which is crosponding to the given display name,
- *                into mapi_buffer
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  smtp_address
+ *	Description:  write the smtp address which is crosponding to the given display name,
+ *				  into g_mapi_buffer
  * =====================================================================================
  */
 static void smtp_address(int *lenp, const char *name)
 {
-    struct SPropTagArray *SPropTagArray;
-    struct SRowSet *SRowSet;
-    enum MAPISTATUS retval;
-    const char     *display_name = NULL;
-    uint32_t        i;
-    uint32_t        count;
-    uint8_t         ulFlags;
+	struct SPropTagArray *SPropTagArray;
+	struct SRowSet *SRowSet;
+	enum MAPISTATUS retval;
+	const char	   *display_name = NULL;
+	uint32_t		i;
+	uint32_t		count;
+	uint8_t			ulFlags;
 
-    SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x02, PR_DISPLAY_NAME_UNICODE, PR_SMTP_ADDRESS_UNICODE);
-    count = 0x7;
-    ulFlags = TABLE_START;
-    do {
-	count += 0x2;
-	retval = GetGALTable(s_mapi_session, SPropTagArray, &SRowSet, count, ulFlags);
-	if (retval != MAPI_E_SUCCESS) {
-	    MapiWrite(lenp, "\n");
-	    report(stderr, "MAPI: Error when translate display name into smtp address\n");
-	    MAPIFreeBuffer(SRowSet);
-	    MAPIFreeBuffer(SPropTagArray);
-	    return;
-	}
-	if (SRowSet->cRows) {
-	    for (i = 0; i < SRowSet->cRows; i++) {
-		display_name = (const char *) find_SPropValue_data(&SRowSet->aRow[i], PR_DISPLAY_NAME_UNICODE);
-		if (strcmp(display_name, name) == 0) {
-		    MapiWrite(lenp, " <%s>\n",
-			      (const char *) find_SPropValue_data(&SRowSet->aRow[i], PR_SMTP_ADDRESS_UNICODE));
-		    MAPIFreeBuffer(SRowSet);
-		    MAPIFreeBuffer(SPropTagArray);
-		    return;
+	SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x02, PR_DISPLAY_NAME_UNICODE, PR_SMTP_ADDRESS_UNICODE);
+	count = 0x7;
+	ulFlags = TABLE_START;
+	do {
+		count += 0x2;
+		retval = GetGALTable(g_mapi_session, SPropTagArray, &SRowSet, count, ulFlags);
+		if (retval != MAPI_E_SUCCESS)
+		{
+			MapiWrite(lenp, "\n");
+			report(stderr, "MAPI: Error when translate display name into smtp address\n");
+			MAPIFreeBuffer(SRowSet);
+			MAPIFreeBuffer(SPropTagArray);
+			return;
 		}
-	    }
-	}
-	ulFlags = TABLE_CUR;
-	MAPIFreeBuffer(SRowSet);
-    } while (SRowSet->cRows == count);
-    MAPIFreeBuffer(SPropTagArray);
 
-    MapiWrite(lenp, "\n");
-    return;
+		if (SRowSet->cRows)
+		{
+			for (i = 0; i < SRowSet->cRows; i++)
+			{
+				display_name = (const char *) find_SPropValue_data(&SRowSet->aRow[i], PR_DISPLAY_NAME_UNICODE);
+				if (strcmp(display_name, name) == 0)
+				{
+					MapiWrite(lenp, " <%s>\n", (const char *) find_SPropValue_data(&SRowSet->aRow[i], PR_SMTP_ADDRESS_UNICODE));
+					MAPIFreeBuffer(SRowSet);
+					MAPIFreeBuffer(SPropTagArray);
+					return;
+				}
+			}
+		}
+		ulFlags = TABLE_CUR;
+		MAPIFreeBuffer(SRowSet);
+	} while (SRowSet->cRows == count);
+	MAPIFreeBuffer(SPropTagArray);
+
+	MapiWrite(lenp, "\n");
+	return;
 }
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_fetch_headers
- *  Description:  request headers of the nth message, write message headers data into
- *                mapi_buffer
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_fetch_headers
+ *	Description:  request headers of the nth message, write message headers data into
+ *				  g_mapi_buffer
  * =====================================================================================
  */
 static int mapi_fetch_headers(int sock, struct query *ctl, int number, int *lenp)
 {
-    enum MAPISTATUS retval;
-    struct SPropTagArray *SPropTagArray = NULL;
-    struct SPropValue *lpProps;
-    struct SRow     aRow;
-    mapi_object_t   obj_message;
-    const char     *msgid;
-    mapi_id_t      *fid;
-    mapi_id_t      *mid;
-    const uint64_t *delivery_date;
-    const char     *date = NULL;
-    const char     *from = NULL;
-    const char     *to = NULL;
-    const char     *cc = NULL;
-    const char     *bcc = NULL;
-    const char     *subject = NULL;
-    const uint8_t  *has_attach = NULL;
-    uint8_t         format;
-    int             props_count;
+	enum MAPISTATUS retval;
+	struct SPropTagArray *SPropTagArray = NULL;
+	struct SPropValue *lpProps;
+	struct SRow		aRow;
+	mapi_object_t	obj_message;
+	const char	   *msgid;
+	mapi_id_t	   *fid;
+	mapi_id_t	   *mid;
+	const uint64_t *delivery_date;
+	const char	   *date = NULL;
+	const char	   *from = NULL;
+	const char	   *to = NULL;
+	const char	   *cc = NULL;
+	const char	   *bcc = NULL;
+	const char	   *subject = NULL;
+	const uint8_t  *has_attach = NULL;
+	uint8_t			format;
+	int				props_count;
 
-    (void) ctl;
-    *lenp = 0;
+	(void) ctl;
+	*lenp = 0;
 
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_fetch_headers(number %d)\n", number);
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_fetch_headers(number %d)\n", number);
 
-    if (!mapi_initialized) {
-	report(stderr, GT_("MAPI: MAPI is not initialized\n"));
-	return (PS_UNDEFINED);
-    }
+	if (!g_mapi_initialized) {
+		report(stderr, GT_("MAPI: MAPI is not initialized\n"));
+		return (PS_UNDEFINED);
+	}
 
-    if (mapi_rowset.cRows < number)
-	return PS_UNDEFINED;
+	if (g_mapi_rowset.cRows < number) return PS_UNDEFINED;
 
-    fid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_FID);
-    mid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_MID);
-    mapi_object_init(&obj_message);
+	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	mapi_object_init(&obj_message);
 
-    retval = OpenMessage(&mapi_obj_store, *fid, *mid, &obj_message, 0x0);
-    if (retval == MAPI_E_SUCCESS) {
-	SPropTagArray = set_SPropTagArray(mapi_mem_ctx,
-					  0x09,
-					  PR_INTERNET_MESSAGE_ID,
-					  PR_CONVERSATION_TOPIC,
-					  PR_MESSAGE_DELIVERY_TIME,
-					  PR_SENT_REPRESENTING_NAME,
-					  PR_DISPLAY_TO, PR_DISPLAY_CC, PR_DISPLAY_BCC, PR_HASATTACH, PR_MSG_EDITOR_FORMAT);
-	retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
-	MAPIFreeBuffer(SPropTagArray);
-	if (retval != MAPI_E_SUCCESS) {
-	    mapi_object_release(&obj_message);
-	    return translate_mapi_error(GetLastError());
+	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
+	if (retval == MAPI_E_SUCCESS) {
+		SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx,
+						  0x09,
+						  PR_INTERNET_MESSAGE_ID,
+						  PR_CONVERSATION_TOPIC,
+						  PR_MESSAGE_DELIVERY_TIME,
+						  PR_SENT_REPRESENTING_NAME,
+						  PR_DISPLAY_TO, PR_DISPLAY_CC, PR_DISPLAY_BCC, PR_HASATTACH, PR_MSG_EDITOR_FORMAT);
+		retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
+		MAPIFreeBuffer(SPropTagArray);
+		if (retval != MAPI_E_SUCCESS) {
+			mapi_object_release(&obj_message);
+			return translate_mapi_error(GetLastError());
+		}
 	}
-    }
-    /*
-     * Build a SRow structure 
-     */
-    aRow.ulAdrEntryPad = 0;
-    aRow.cValues = props_count;
-    aRow.lpProps = lpProps;
 
-    msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
-    if (msgid) {
-	has_attach = (const uint8_t *) octool_get_propval(&aRow, PR_HASATTACH);
-	from = (const char *) octool_get_propval(&aRow, PR_SENT_REPRESENTING_NAME);
-	to = (const char *) octool_get_propval(&aRow, PR_DISPLAY_TO);
-	cc = (const char *) octool_get_propval(&aRow, PR_DISPLAY_CC);
-	bcc = (const char *) octool_get_propval(&aRow, PR_DISPLAY_BCC);
+	/* Build a SRow structure */
+	aRow.ulAdrEntryPad = 0;
+	aRow.cValues = props_count;
+	aRow.lpProps = lpProps;
 
-	/*-----------------------------------------------------------------------------
-	 * octool_get_propval() will not return NULL even if PR_DISPLAY_TO,
-	 * PR_DISPLAY_CC or PR_DISPLAY_TO is null, so have a test on their lengths.
-	 *-----------------------------------------------------------------------------*/
-	if (strlen(to) * strlen(cc) * strlen(bcc)) {
-	    talloc_free(lpProps);
-	    mapi_object_release(&obj_message);
-	    return (PS_UNDEFINED);
-	}
+	msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
+	if (msgid)
+	{
+		has_attach = (const uint8_t *) octool_get_propval(&aRow, PR_HASATTACH);
+		from = (const char *) octool_get_propval(&aRow, PR_SENT_REPRESENTING_NAME);
+		to = (const char *) octool_get_propval(&aRow, PR_DISPLAY_TO);
+		cc = (const char *) octool_get_propval(&aRow, PR_DISPLAY_CC);
+		bcc = (const char *) octool_get_propval(&aRow, PR_DISPLAY_BCC);
 
-	delivery_date = (const uint64_t *) octool_get_propval(&aRow, PR_MESSAGE_DELIVERY_TIME);
-	if (delivery_date) {
-	    date = nt_time_string(mapi_mem_ctx, *delivery_date);
-	} else {
-	    date = "None";
-	}
-	subject = (const char *) octool_get_propval(&aRow, PR_CONVERSATION_TOPIC);
+		/*-----------------------------------------------------------------------------
+		 * octool_get_propval() will not return NULL even if PR_DISPLAY_TO,
+		 * PR_DISPLAY_CC or PR_DISPLAY_TO is null, so have a test on their lengths.
+		 *-----------------------------------------------------------------------------*/
+		if (strlen(to) * strlen(cc) * strlen(bcc)) {
+			talloc_free(lpProps);
+			mapi_object_release(&obj_message);
+			return (PS_UNDEFINED);
+		}
 
-	/*
-	 * initialize body DATA_BLOB 
-	 */
-	mapi_buffer.data = NULL;
-	mapi_buffer.length = 0;
-	mapi_buffer_count = 0;
+		delivery_date = (const uint64_t *) octool_get_propval(&aRow, PR_MESSAGE_DELIVERY_TIME);
+		if (delivery_date) date = nt_time_string(g_mapi_mem_ctx, *delivery_date);
+		else date = "None";
 
-	MapiWrite(lenp, "Date: %s\n", date);
+		subject = (const char *) octool_get_propval(&aRow, PR_CONVERSATION_TOPIC);
 
-	MapiWrite(lenp, "From: %s", from);
-	smtp_address(lenp, from ? from : "<empty>");
+		/* initialize body DATA_BLOB */
+		g_mapi_buffer.data = NULL;
+		g_mapi_buffer.length = 0;
+		g_mapi_buffer_count = 0;
 
-	if (strlen(to)) {
-	    MapiWrite(lenp, "To: %s", to);
-	    smtp_address(lenp, to);
-	}
+		MapiWrite(lenp, "Date: %s\n", date);
+		MapiWrite(lenp, "From: %s", from);
+		smtp_address(lenp, from ? from : "<empty>");
 
-	if (strlen(cc)) {
-	    MapiWrite(lenp, "Cc: %s", cc);
-	    smtp_address(lenp, cc ? cc : "<empty>");
-	}
+		if (strlen(to)) {
+			MapiWrite(lenp, "To: %s", to);
+			smtp_address(lenp, to);
+		}
 
-	if (strlen(bcc)) {
-	    MapiWrite(lenp, "Bcc: %s", bcc);
-	    smtp_address(lenp, bcc);
-	}
+		if (strlen(cc)) {
+			MapiWrite(lenp, "Cc: %s", cc);
+			smtp_address(lenp, cc ? cc : "<empty>");
+		}
 
-	if (subject)
-	    MapiWrite(lenp, "Subject: %s\n", subject);
+		if (strlen(bcc)) {
+			MapiWrite(lenp, "Bcc: %s", bcc);
+			smtp_address(lenp, bcc);
+		}
 
-	MapiWrite(lenp, "Message-ID: %s\n", msgid);
-	MapiWrite(lenp, "MIME-Version: 1.0\n");
+		if (subject) MapiWrite(lenp, "Subject: %s\n", subject);
 
-	if (has_attach && *has_attach) {
-	    /*-----------------------------------------------------------------------------
-	     * simple structure 
-	     *-----------------------------------------------------------------------------*/
-	    MapiWrite(lenp, "Content-Type: multipart/mixed; boundary=\"%s\"\n", MAPI_BOUNDARY);
-	} else {
-	    /*-----------------------------------------------------------------------------
-	     * complex structure 
-	     *-----------------------------------------------------------------------------*/
-	    retval = GetBestBody(&obj_message, &format);
-	    switch (format) {
-	    case olEditorText:
-		MapiWrite(lenp, "Content-Type: text/plain; charset=us-ascii\n");
-		MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
-		break;
-	    case olEditorHTML:
-		MapiWrite(lenp, "Content-Type: text/html\n");
-		MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
-		break;
-	    case olEditorRTF:
-		MapiWrite(lenp, "Content-Type: text/rtf\n");
-		MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
-		break;
-	    }
+		MapiWrite(lenp, "Message-ID: %s\n", msgid);
+		MapiWrite(lenp, "MIME-Version: 1.0\n");
+
+		if (has_attach && *has_attach)
+		{
+			/*-----------------------------------------------------------------------------
+			 * simple structure 
+			 *-----------------------------------------------------------------------------*/
+			MapiWrite(lenp, "Content-Type: multipart/mixed; boundary=\"%s\"\n", MAPI_BOUNDARY);
+		}
+		else
+		{
+			/*-----------------------------------------------------------------------------
+			 * complex structure 
+			 *-----------------------------------------------------------------------------*/
+			retval = GetBestBody(&obj_message, &format);
+			switch (format)
+			{
+				case olEditorText:
+					MapiWrite(lenp, "Content-Type: text/plain; charset=us-ascii\n");
+					MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
+					break;
+				case olEditorHTML:
+					MapiWrite(lenp, "Content-Type: text/html\n");
+					MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
+					break;
+				case olEditorRTF:
+					MapiWrite(lenp, "Content-Type: text/rtf\n");
+					MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
+					break;
+			}
+		}
+
+		MapiWrite(lenp, "\n");
+
 	}
-	MapiWrite(lenp, "\n");
-    } else {
+	else
+	{
+		talloc_free(lpProps);
+		mapi_object_release(&obj_message);
+		return PS_UNDEFINED;
+	}
 	talloc_free(lpProps);
 	mapi_object_release(&obj_message);
-	return (PS_UNDEFINED);
-    }
-    talloc_free(lpProps);
-    mapi_object_release(&obj_message);
 
-    return (PS_SUCCESS);
+	return PS_SUCCESS;
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_fetch_body
- *  Description:  request body of nth message, write message body data into mapi_buffer
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_fetch_body
+ *	Description:  request body of nth message, write message body data into g_mapi_buffer
  * =====================================================================================
  */
 static int mapi_fetch_body(int sock, struct query *ctl, int number, int *lenp)
 {
-    enum MAPISTATUS retval;
-    struct SPropTagArray *SPropTagArray = NULL;
-    struct SPropValue *lpProps = NULL;
-    struct SPropValue *attach_lpProps = NULL;
-    struct SRow     aRow;
-    struct SRow     aRow2;
-    struct SRowSet  rowset_attach;
-    mapi_object_t   obj_message;
-    mapi_object_t   obj_tb_attach;
-    mapi_object_t   obj_attach;
-    const char     *msgid;
-    mapi_id_t      *fid;
-    mapi_id_t      *mid;
-    const uint8_t  *has_attach = NULL;
-    const uint32_t *attach_num = NULL;
-    DATA_BLOB       body;
-    const char     *attach_filename;
-    const uint32_t *attach_size;
-    char           *attachment_data;
-    char           *magic;
-    int             props_count;
-    int             attach_count;
-    uint8_t         format;
+	enum MAPISTATUS retval;
+	struct SPropTagArray *SPropTagArray = NULL;
+	struct SPropValue *lpProps = NULL;
+	struct SPropValue *attach_lpProps = NULL;
+	struct SRow		aRow;
+	struct SRow		aRow2;
+	struct SRowSet	rowset_attach;
+	mapi_object_t	obj_message;
+	mapi_object_t	obj_tb_attach;
+	mapi_object_t	obj_attach;
+	const char	   *msgid;
+	mapi_id_t	   *fid;
+	mapi_id_t	   *mid;
+	const uint8_t  *has_attach = NULL;
+	const uint32_t *attach_num = NULL;
+	DATA_BLOB		body;
+	const char	   *attach_filename;
+	const uint32_t *attach_size;
+	char		   *attachment_data;
+	char		   *magic;
+	int				props_count;
+	int				attach_count;
+	uint8_t			format;
 
-    (void) ctl;
-    *lenp = 0;
+	(void) ctl;
+	*lenp = 0;
 
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_fetch_body(number %d)\n", number);
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_fetch_body(number %d)\n", number);
 
-    if (!mapi_initialized) {
-	report(stderr, GT_("MAPI: MAPI is not initialized\n"));
-	return (PS_UNDEFINED);
-    }
+	if (!g_mapi_initialized) {
+		report(stderr, GT_("MAPI: MAPI is not initialized\n"));
+		return (PS_UNDEFINED);
+	}
 
-    if (mapi_rowset.cRows < number)
-	return (PS_UNDEFINED);
+	if (g_mapi_rowset.cRows < number) return (PS_UNDEFINED);
 
-    fid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_FID);
-    mid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_MID);
-    mapi_object_init(&obj_message);
+	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	mapi_object_init(&obj_message);
 
-    retval = OpenMessage(&mapi_obj_store, *fid, *mid, &obj_message, 0x0);
-    if (retval != MAPI_E_SUCCESS) {
-	mapi_object_release(&obj_message);
-	return translate_mapi_error(GetLastError());
-    }
-    SPropTagArray = set_SPropTagArray(mapi_mem_ctx,
-				      0x07,
-				      PR_INTERNET_MESSAGE_ID,
-				      PR_MSG_EDITOR_FORMAT,
-				      PR_BODY, PR_BODY_UNICODE, PR_HTML, PR_RTF_COMPRESSED, PR_HASATTACH);
-    retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
-    MAPIFreeBuffer(SPropTagArray);
-    if (retval != MAPI_E_SUCCESS) {
-	mapi_object_release(&obj_message);
-	return translate_mapi_error(GetLastError());
-    }
-
-    /*-----------------------------------------------------------------------------
-     *  build a SRow structure
-     *-----------------------------------------------------------------------------*/
-    aRow.ulAdrEntryPad = 0;
-    aRow.cValues = props_count;
-    aRow.lpProps = lpProps;
-
-    msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
-    if (!msgid) {
-	talloc_free(lpProps);
-	mapi_object_release(&obj_message);
-	return (PS_UNDEFINED);
-    }
-
-    has_attach = (const uint8_t *) find_SPropValue_data(&aRow, PR_HASATTACH);
-    retval = octool_get_body(mapi_mem_ctx, &obj_message, &aRow, &body);
-
-    /*-----------------------------------------------------------------------------
-     *  body
-     *-----------------------------------------------------------------------------*/
-    if (body.length) {
-	if (has_attach && *has_attach) {
-	    MapiWrite(lenp, "--%s\n", MAPI_BOUNDARY);
-
-	    /*-----------------------------------------------------------------------------
-	     *  complex structure
-	     *-----------------------------------------------------------------------------*/
-	    retval = GetBestBody(&obj_message, &format);
-	    switch (format) {
-	    case olEditorText:
-		MapiWrite(lenp, "Content-Type: text/plain; charset=us-ascii\n");
-		MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
-		/*
-		 * Just display UTF8 content inline 
-		 */
-		MapiWrite(lenp, "Content-Disposition: inline\n");
-		break;
-	    case olEditorHTML:
-		MapiWrite(lenp, "Content-Type: text/html\n");
-		MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
-		break;
-	    case olEditorRTF:
-		MapiWrite(lenp, "Content-Type: text/rtf\n");
-		MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
-		MapiWrite(lenp, "--%s\n", MAPI_BOUNDARY);
-		break;
-	    }
+	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
+	if (retval != MAPI_E_SUCCESS) {
+		mapi_object_release(&obj_message);
+		return translate_mapi_error(GetLastError());
 	}
+	SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx,
+					  0x07,
+					  PR_INTERNET_MESSAGE_ID,
+					  PR_MSG_EDITOR_FORMAT,
+					  PR_BODY, PR_BODY_UNICODE, PR_HTML, PR_RTF_COMPRESSED, PR_HASATTACH);
+	retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
+	MAPIFreeBuffer(SPropTagArray);
+	if (retval != MAPI_E_SUCCESS) {
+		mapi_object_release(&obj_message);
+		return translate_mapi_error(GetLastError());
+	}
 
 	/*-----------------------------------------------------------------------------
-	 *  encode body.data into quoted printable and append to mapi_buffer
+	 *	build a SRow structure
 	 *-----------------------------------------------------------------------------*/
-	quoted_printable_encode(&body, lenp);
-	talloc_free(body.data);
+	aRow.ulAdrEntryPad = 0;
+	aRow.cValues = props_count;
+	aRow.lpProps = lpProps;
 
+	msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
+	if (!msgid) {
+		talloc_free(lpProps);
+		mapi_object_release(&obj_message);
+		return (PS_UNDEFINED);
+	}
+
+	has_attach = (const uint8_t *) find_SPropValue_data(&aRow, PR_HASATTACH);
+	retval = octool_get_body(g_mapi_mem_ctx, &obj_message, &aRow, &body);
+
 	/*-----------------------------------------------------------------------------
-	 *  fetch attachments
+	 *	body
 	 *-----------------------------------------------------------------------------*/
-	if (has_attach && *has_attach) {
-	    mapi_object_init(&obj_tb_attach);
-	    retval = GetAttachmentTable(&obj_message, &obj_tb_attach);
-	    if (retval == MAPI_E_SUCCESS) {
-		SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x1, PR_ATTACH_NUM);
-		retval = SetColumns(&obj_tb_attach, SPropTagArray);
-		MAPIFreeBuffer(SPropTagArray);
-		if (retval != MAPI_E_SUCCESS) {
-		    mapi_object_release(&obj_message);
-		    return translate_mapi_error(GetLastError());
-		}
+	if (body.length)
+	{
+		if (has_attach && *has_attach)
+		{
+			MapiWrite(lenp, "--%s\n", MAPI_BOUNDARY);
 
-		retval = QueryRows(&obj_tb_attach, 0xa, TBL_ADVANCE, &rowset_attach);
-		if (retval != MAPI_E_SUCCESS) {
-		    mapi_object_release(&obj_message);
-		    return translate_mapi_error(GetLastError());
+			/*-----------------------------------------------------------------------------
+			 *	complex structure
+			 *-----------------------------------------------------------------------------*/
+			retval = GetBestBody(&obj_message, &format);
+			switch (format) {
+				case olEditorText:
+					MapiWrite(lenp, "Content-Type: text/plain; charset=us-ascii\n");
+					MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
+					/* Just display UTF8 content inline */
+					MapiWrite(lenp, "Content-Disposition: inline\n");
+					break;
+				case olEditorHTML:
+					MapiWrite(lenp, "Content-Type: text/html\n");
+					MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
+					break;
+				case olEditorRTF:
+					MapiWrite(lenp, "Content-Type: text/rtf\n");
+					MapiWrite(lenp, "Content-Transfer-Encoding: quoted-printable\n");
+					MapiWrite(lenp, "--%s\n", MAPI_BOUNDARY);
+					break;
+			}
 		}
 
-		for (attach_count = 0; attach_count < rowset_attach.cRows; attach_count++) {
-		    attach_num = (const uint32_t *) find_SPropValue_data(&(rowset_attach.aRow[attach_count]), PR_ATTACH_NUM);
-		    retval = OpenAttach(&obj_message, *attach_num, &obj_attach);
-		    if (retval == MAPI_E_SUCCESS) {
-			SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x3,
-							  PR_ATTACH_FILENAME, PR_ATTACH_LONG_FILENAME, PR_ATTACH_SIZE);
-			retval = GetProps(&obj_attach, SPropTagArray, &attach_lpProps, &props_count);
-			MAPIFreeBuffer(SPropTagArray);
+		/*-----------------------------------------------------------------------------
+		 *	encode body.data into quoted printable and append to g_mapi_buffer
+		 *-----------------------------------------------------------------------------*/
+		quoted_printable_encode(&body, lenp);
+		talloc_free(body.data);
+
+		/*-----------------------------------------------------------------------------
+		 *	fetch attachments
+		 *-----------------------------------------------------------------------------*/
+		if (has_attach && *has_attach) {
+			mapi_object_init(&obj_tb_attach);
+			retval = GetAttachmentTable(&obj_message, &obj_tb_attach);
 			if (retval == MAPI_E_SUCCESS) {
-			    aRow2.ulAdrEntryPad = 0;
-			    aRow2.cValues = props_count;
-			    aRow2.lpProps = attach_lpProps;
+				SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x1, PR_ATTACH_NUM);
+				retval = SetColumns(&obj_tb_attach, SPropTagArray);
+				MAPIFreeBuffer(SPropTagArray);
+				if (retval != MAPI_E_SUCCESS) {
+					mapi_object_release(&obj_message);
+					return translate_mapi_error(GetLastError());
+				}
 
-			    attach_filename = get_filename(octool_get_propval(&aRow2, PR_ATTACH_LONG_FILENAME));
-			    if (!attach_filename || (attach_filename && !strcmp(attach_filename, ""))) {
-				attach_filename = get_filename(octool_get_propval(&aRow2, PR_ATTACH_FILENAME));
-			    }
-			    attach_size = (const uint32_t *) octool_get_propval(&aRow2, PR_ATTACH_SIZE);
-			    attachment_data = get_base64_attachment(mapi_mem_ctx, obj_attach, *attach_size, &magic);
-			    if (attachment_data) {
-				MapiWrite(lenp, "\n\n--%s\n", MAPI_BOUNDARY);
-				MapiWrite(lenp, "Content-Disposition: attachment; filename=\"%s\"\n", attach_filename);
-				MapiWrite(lenp, "Content-Type: \"%s\"\n", magic);
-				MapiWrite(lenp, "Content-Transfer-Encoding: base64\n\n");
-				data_blob_append(mapi_mem_ctx, &mapi_buffer, attachment_data, strlen(attachment_data));
-				*lenp += strlen(attachment_data);
-				talloc_free(attachment_data);
-			    }
-			}
-			talloc_free(attach_lpProps);
-		    }
-		}
-		MapiWrite(lenp, "\n--%s--\n", MAPI_BOUNDARY);
-	    }			/* if GetAttachmentTable returns success */
-	}			/* if (has_attach && *has_attach) */
-    }
-    /*-----------------------------------------------------------------------------
-     *  send the message delimiter
-     *-----------------------------------------------------------------------------*/
-    MapiWrite(lenp, "\n.\n\0");
+				retval = QueryRows(&obj_tb_attach, 0xa, TBL_ADVANCE, &rowset_attach);
+				if (retval != MAPI_E_SUCCESS) {
+					mapi_object_release(&obj_message);
+					return translate_mapi_error(GetLastError());
+				}
 
-    talloc_free(lpProps);
-    mapi_object_release(&obj_message);
+				for (attach_count = 0; attach_count < rowset_attach.cRows; attach_count++)
+				{
+					attach_num = (const uint32_t *) find_SPropValue_data(&(rowset_attach.aRow[attach_count]), PR_ATTACH_NUM);
+					retval = OpenAttach(&obj_message, *attach_num, &obj_attach);
+					if (retval == MAPI_E_SUCCESS)
+					{
+						SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x3,
+										  PR_ATTACH_FILENAME, PR_ATTACH_LONG_FILENAME, PR_ATTACH_SIZE);
+						retval = GetProps(&obj_attach, SPropTagArray, &attach_lpProps, &props_count);
+						MAPIFreeBuffer(SPropTagArray);
+						if (retval == MAPI_E_SUCCESS) {
+							aRow2.ulAdrEntryPad = 0;
+							aRow2.cValues = props_count;
+							aRow2.lpProps = attach_lpProps;
 
-    return (PS_SUCCESS);
+							attach_filename = get_filename(octool_get_propval(&aRow2, PR_ATTACH_LONG_FILENAME));
+							if (!attach_filename || (attach_filename && !strcmp(attach_filename, "")))
+								attach_filename = get_filename(octool_get_propval(&aRow2, PR_ATTACH_FILENAME));
+							attach_size = (const uint32_t *) octool_get_propval(&aRow2, PR_ATTACH_SIZE);
+							attachment_data = get_base64_attachment(g_mapi_mem_ctx, obj_attach, *attach_size, &magic);
+							if (attachment_data)
+							{
+								MapiWrite(lenp, "\n\n--%s\n", MAPI_BOUNDARY);
+								MapiWrite(lenp, "Content-Disposition: attachment; filename=\"%s\"\n", attach_filename);
+								MapiWrite(lenp, "Content-Type: \"%s\"\n", magic);
+								MapiWrite(lenp, "Content-Transfer-Encoding: base64\n\n");
+								data_blob_append(g_mapi_mem_ctx, &g_mapi_buffer, attachment_data, strlen(attachment_data));
+								*lenp += strlen(attachment_data);
+								talloc_free(attachment_data);
+							}
+						}
+						talloc_free(attach_lpProps);
+					}
+				}
+				MapiWrite(lenp, "\n--%s--\n", MAPI_BOUNDARY);
+			}			/* if GetAttachmentTable returns success */
+		}			/* if (has_attach && *has_attach) */
+	}
+	/*-----------------------------------------------------------------------------
+	 *	send the message delimiter
+	 *-----------------------------------------------------------------------------*/
+	MapiWrite(lenp, "\n.\n\0");
+
+	talloc_free(lpProps);
+	mapi_object_release(&obj_message);
+
+	return (PS_SUCCESS);
 }
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_tail
- *  Description:  will be invoked after mapi_fetch_body and mapi_fetch_headers to clear
- *                mapi_buffer.
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_tail
+ *	Description:  will be invoked after mapi_fetch_body and mapi_fetch_headers to clear
+ *				  g_mapi_buffer.
  * =====================================================================================
  */
 static int mapi_trail(int sock, struct query *ctl, const char *tag)
 {
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_trail(tag %s)\n", tag);
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_trail(tag %s)\n", tag);
 
+	/*-----------------------------------------------------------------------------
+	 *	clear mapi buffer
+	 *-----------------------------------------------------------------------------*/
+	talloc_free(g_mapi_buffer.data);
+	g_mapi_buffer.data = NULL;
+	g_mapi_buffer.length = 0;
+	g_mapi_buffer_count = 0;
 
-    /*-----------------------------------------------------------------------------
-     *  clear mapi buffer
-     *-----------------------------------------------------------------------------*/
-    talloc_free(mapi_buffer.data);
-    mapi_buffer.data = NULL;
-    mapi_buffer.length = 0;
-    mapi_buffer_count = 0;
-
-    return PS_SUCCESS;
+	return PS_SUCCESS;
 }
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_fetch_delete
- *  Description:  set delete flag for given message
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_fetch_delete
+ *	Description:  set delete flag for given message
  * =====================================================================================
  */
 static int mapi_delete(int sock, struct query *ctl, int number)
 {
-    mapi_container_list_t *element;
-    enum MAPISTATUS retval;
-    const char     *profname = NULL;
-    int             flag = PS_UNDEFINED;
-    struct SPropTagArray *SPropTagArray = NULL;
-    struct SPropValue *lpProps;
-    struct SRow     aRow;
-    mapi_object_t   obj_message;
-    const char     *msgid;
-    mapi_id_t      *fid;
-    mapi_id_t      *mid;
-    int             props_count;
+	mapi_container_list_t *element;
+	enum MAPISTATUS retval;
+	const char	   *profname = NULL;
+	int				flag = PS_UNDEFINED;
+	struct SPropTagArray *SPropTagArray = NULL;
+	struct SPropValue *lpProps;
+	struct SRow		aRow;
+	mapi_object_t	obj_message;
+	const char	   *msgid;
+	mapi_id_t	   *fid;
+	mapi_id_t	   *mid;
+	int				props_count;
 
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_delete(number %d)\n", number);
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_delete(number %d)\n", number);
 
-    if (!mapi_initialized)
-	return (PS_UNDEFINED);
+	if (!g_mapi_initialized) return PS_UNDEFINED;
+	if (g_mapi_rowset.cRows == 0) return PS_NOMAIL;
 
-    if (mapi_rowset.cRows == 0)
-	return (PS_NOMAIL);
+	element = talloc_zero((TALLOC_CTX *) g_mapi_deleted_ids.lpContainerList, mapi_container_list_t);
+	element->id = g_mapi_rowset.aRow[number - 1].lpProps[1].value.d;
+	DLIST_ADD(g_mapi_deleted_ids.lpContainerList, element);
+	g_mapi_deleted_ids.count++;
 
-    element = talloc_zero((TALLOC_CTX *) mapi_deleted_ids.lpContainerList, mapi_container_list_t);
-    element->id = mapi_rowset.aRow[number - 1].lpProps[1].value.d;
-    DLIST_ADD(mapi_deleted_ids.lpContainerList, element);
-    mapi_deleted_ids.count++;
+	/*-----------------------------------------------------------------------------
+	 *	remove id in the profile
+	 *-----------------------------------------------------------------------------*/
+	if (!ctl->mapi_profname)
+		profname = ctl->remotename;	/* use the remotename as the profile name */
+	else
+		profname = ctl->mapi_profname;
 
-    /*-----------------------------------------------------------------------------
-     *  remove id in the profile
-     *-----------------------------------------------------------------------------*/
-    if (!ctl->mapi_profname)
-	profname = ctl->remotename;	/* use the remotename as the profile name */
-    else
-	profname = ctl->mapi_profname;
+	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	mapi_object_init(&obj_message);
 
-    fid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_FID);
-    mid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_MID);
-    mapi_object_init(&obj_message);
+	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
+	if (retval == MAPI_E_SUCCESS)
+	{
+		SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x1, PR_INTERNET_MESSAGE_ID);
+		retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
+		MAPIFreeBuffer(SPropTagArray);
+		if (retval == MAPI_E_SUCCESS)
+		{
+			/* Build a SRow structure */
+			aRow.ulAdrEntryPad = 0;
+			aRow.cValues = props_count;
+			aRow.lpProps = lpProps;
 
-    retval = OpenMessage(&mapi_obj_store, *fid, *mid, &obj_message, 0x0);
-    if (retval == MAPI_E_SUCCESS) {
-	SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x1, PR_INTERNET_MESSAGE_ID);
-	retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
-	MAPIFreeBuffer(SPropTagArray);
-	if (retval == MAPI_E_SUCCESS) {
-	    /*
-	     * Build a SRow structure 
-	     */
-	    aRow.ulAdrEntryPad = 0;
-	    aRow.cValues = props_count;
-	    aRow.lpProps = lpProps;
-
-	    msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
-	    if (msgid) {
-		retval = mapi_profile_delete_string_attr(profname, "Message-ID", msgid);
-		if (retval == MAPI_E_SUCCESS) {
-		    if (outlevel == O_DEBUG)
-			report(stdout, "MAPI> message %d with Message-ID=%s will be deleted\n", number, msgid);
-		    flag = PS_SUCCESS;
+			msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
+			if (msgid) {
+				retval = mapi_profile_delete_string_attr(profname, "Message-ID", msgid);
+				if (retval == MAPI_E_SUCCESS) {
+					if (outlevel == O_DEBUG) report(stdout, "MAPI> message %d with Message-ID=%s will be deleted\n", number, msgid);
+					flag = PS_SUCCESS;
+				}
+			}
 		}
-	    }
-	} else
-	    mapi_clean();
-	talloc_free(lpProps);
-    }
+		else mapi_clean();
+		talloc_free(lpProps);
+	}
 
-    mapi_object_release(&obj_message);
-    return flag;
+	mapi_object_release(&obj_message);
+	return flag;
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_mark_seen
- *  Description:  make the given message as seen in both client and server sides
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_mark_seen
+ *	Description:  make the given message as seen in both client and server sides
  * =====================================================================================
  */
 static int mapi_mark_seen(int sock, struct query *ctl, int number)
 {
-    enum MAPISTATUS retval;
-    int             flag = FALSE;
-    struct SPropTagArray *SPropTagArray = NULL;
-    struct SPropValue *lpProps;
-    struct SRow     aRow;
-    mapi_object_t   obj_message;
-    const char     *msgid = NULL;
-    const char     *profname = NULL;
-    mapi_id_t      *fid;
-    mapi_id_t      *mid;
-    int             props_count;
-    long            message_flags;
+	enum MAPISTATUS retval;
+	int				flag = FALSE;
+	struct SPropTagArray *SPropTagArray = NULL;
+	struct SPropValue *lpProps;
+	struct SRow		aRow;
+	mapi_object_t	obj_message;
+	const char	   *msgid = NULL;
+	const char	   *profname = NULL;
+	mapi_id_t	   *fid;
+	mapi_id_t	   *mid;
+	int				props_count;
+	long			message_flags;
 
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_mark_seen(number %d)\n", number);
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_mark_seen(number %d)\n", number);
 
-    if (!mapi_initialized) {
-	report(stderr, GT_("MAPI: MAPI is not initialized\n"));
-	return (PS_UNDEFINED);
-    }
+	if (!g_mapi_initialized) {
+		report(stderr, GT_("MAPI: MAPI is not initialized\n"));
+		return PS_UNDEFINED;
+	}
 
-    if (mapi_rowset.cRows < number)
-	return FALSE;
+	if (g_mapi_rowset.cRows < number) return FALSE;
 
-    fid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_FID);
-    mid = (mapi_id_t *) find_SPropValue_data(&(mapi_rowset.aRow[number - 1]), PR_MID);
-    mapi_object_init(&obj_message);
+	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	mapi_object_init(&obj_message);
 
-    retval = OpenMessage(&mapi_obj_store, *fid, *mid, &obj_message, 0x0);
-    if (retval == MAPI_E_SUCCESS) {
-	SPropTagArray = set_SPropTagArray(mapi_mem_ctx, 0x2, PR_INTERNET_MESSAGE_ID, PR_MESSAGE_FLAGS);
-	retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
-	MAPIFreeBuffer(SPropTagArray);
+	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
 	if (retval == MAPI_E_SUCCESS) {
-	    /*
-	     * Build a SRow structure 
-	     */
-	    aRow.ulAdrEntryPad = 0;
-	    aRow.cValues = props_count;
-	    aRow.lpProps = lpProps;
+		SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x2, PR_INTERNET_MESSAGE_ID, PR_MESSAGE_FLAGS);
+		retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
+		MAPIFreeBuffer(SPropTagArray);
+		if (retval == MAPI_E_SUCCESS)
+		{
+			/* Build a SRow structure */
+			aRow.ulAdrEntryPad = 0;
+			aRow.cValues = props_count;
+			aRow.lpProps = lpProps;
 
-	    msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
-	    message_flags = *(const long *) find_SPropValue_data(&aRow, PR_MESSAGE_FLAGS);
-	    if (msgid) {
+			msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
+			message_flags = *(const long *) find_SPropValue_data(&aRow, PR_MESSAGE_FLAGS);
+			if (msgid)
+			{
+				retval = FindProfileAttr(mapi_profile, "Message-ID", msgid);
+				if (retval == MAPI_E_SUCCESS)
+				{
+					if (outlevel == O_DEBUG) report(stdout, "MAPI> message %d with Message-ID=%s is already marked as seen\n", number, msgid);
+					flag = TRUE;
+					talloc_free(lpProps);
+					mapi_object_release(&obj_message);
+					return flag;
+				}
 
-		retval = FindProfileAttr(mapi_profile, "Message-ID", msgid);
-		if (retval == MAPI_E_SUCCESS) {
-		    if (outlevel == O_DEBUG)
-			report(stdout, "MAPI> message %d with Message-ID=%s is already marked as seen\n", number, msgid);
-		    flag = TRUE;
-		    talloc_free(lpProps);
-		    mapi_object_release(&obj_message);
-		    return flag;
-		}
+				/*-----------------------------------------------------------------------------
+				 * mark seen in the client side
+				 *-----------------------------------------------------------------------------*/
+				if (!ctl->mapi_profname) profname = ctl->remotename;	/* use the remotename as the profile name */
+				else profname = ctl->mapi_profname;
+				mapi_profile_add_string_attr(profname, "Message-ID", msgid);
+				if (retval == MAPI_E_SUCCESS) {
+					if (outlevel == O_DEBUG) report(stdout, "MAPI> marked message %d with Message-ID=%s seen\n", number, msgid);
+					flag = TRUE;
+				}
 
-		/*-----------------------------------------------------------------------------
-		 * mark seen in the client side
-		 *-----------------------------------------------------------------------------*/
-		if (!ctl->mapi_profname)
-		    profname = ctl->remotename;	/* use the remotename as the profile name */
-		else
-		    profname = ctl->mapi_profname;
-		mapi_profile_add_string_attr(profname, "Message-ID", msgid);
-		if (retval == MAPI_E_SUCCESS) {
-		    if (outlevel == O_DEBUG)
-			report(stdout, "MAPI> marked message %d with Message-ID=%s seen\n", number, msgid);
-		    flag = TRUE;
+				/*-----------------------------------------------------------------------------
+				 *	mark seen in the server side
+				 *-----------------------------------------------------------------------------*/
+				if (!(message_flags & MSGFLAG_READ))
+				{
+					retval = SetMessageReadFlag(&g_mapi_obj_folder, &obj_message, MSGFLAG_READ);
+					if (retval != MAPI_E_SUCCESS) {
+						talloc_free(lpProps);
+						mapi_object_release(&obj_message);
+						return flag;
+					}
+				}
+			}
 		}
+		else mapi_clean();
+		talloc_free(lpProps);
+	}
+	mapi_object_release(&obj_message);
 
-		/*-----------------------------------------------------------------------------
-		 *  mark seen in the server side
-		 *-----------------------------------------------------------------------------*/
-		if (!(message_flags & MSGFLAG_READ)) {
-		    retval = SetMessageReadFlag(&mapi_obj_folder, &obj_message, MSGFLAG_READ);
-		    if (retval != MAPI_E_SUCCESS) {
-			talloc_free(lpProps);
-			mapi_object_release(&obj_message);
-			return flag;
-		    }
-		}
-	    }
-	} else
-	    mapi_clean();
-	talloc_free(lpProps);
-    }
-    mapi_object_release(&obj_message);
-
-    return flag;
+	return flag;
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_end_mailbox_poll
- *  Description:  perform hard delete here
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_end_mailbox_poll
+ *	Description:  perform hard delete here
  * =====================================================================================
  */
 static int mapi_end_mailbox_poll(int sock, struct query *ctl)
 {
-    int             flag = PS_SUCCESS;
-    (void) ctl;
+	int				flag = PS_SUCCESS;
+	(void) ctl;
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_end_mailbox_poll()\n");
 
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_end_mailbox_poll()\n");
-
-    flag = expunge_deleted();
-    mapi_id_array_release(&mapi_deleted_ids);
-    mapi_clean();
-    return flag;
+	flag = expunge_deleted();
+	mapi_id_array_release(&g_mapi_deleted_ids);
+	mapi_clean();
+	return flag;
 }
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  mapi_logout
- *  Description:  
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  mapi_logout
+ *	Description:  
  * =====================================================================================
  */
 static int mapi_logout(int sock, struct query *ctl)
 {
-    (void) ctl;
+	(void) ctl;
+	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_logout()\n");
 
-    if (outlevel >= O_MONITOR)
-	report(stdout, "MAPI> mapi_logout()\n");
-
-    if (mapi_initialized)
-	mapi_clean();
-
-    return (PS_SUCCESS);
+	if (g_mapi_initialized) mapi_clean();
+	return PS_SUCCESS;
 }
 
 static const struct method mapi = {
-    "MAPI",			/* Messaging Application Programming Interface */
-    NULL,			/* unencrypted port, not used by MAPI */
-    NULL,			/* SSL port, not used by MAPI */
-    FALSE,			/* this is not a tagged protocol */
-    TRUE,			/* since it's hard to calculate message size in MAPI, use a message delimiter */
-    mapi_ok,			/* parse command response */
-    mapi_getauth,		/* get authorization */
-    mapi_getrange,		/* query range of messages */
-    mapi_getsizes,		/* we can get a list of sizes */
-    mapi_getpartialsizes,	/* we can get the size of 1 mail */
-    mapi_is_old,		/* how do we tell a message is old? */
-    mapi_fetch_headers,		/* request given message headers */
-    mapi_fetch_body,		/* request given message body */
-    mapi_trail,			/* eat message trailer */
-    mapi_delete,		/* delete the message */
-    mapi_mark_seen,		/* how to mark a message as seen */
-    mapi_end_mailbox_poll,	/* end_of_mailbox processing */
-    mapi_logout,		/* log out, we're done */
-    TRUE,			/* yes, we can re-poll */
+	"MAPI",			/* Messaging Application Programming Interface */
+	NULL,			/* unencrypted port, not used by MAPI */
+	NULL,			/* SSL port, not used by MAPI */
+	FALSE,			/* this is not a tagged protocol */
+	TRUE,			/* since it's hard to calculate message size in MAPI, use a message delimiter */
+	mapi_ok,			/* parse command response */
+	mapi_getauth,		/* get authorization */
+	mapi_getrange,		/* query range of messages */
+	mapi_getsizes,		/* we can get a list of sizes */
+	mapi_getpartialsizes,	/* we can get the size of 1 mail */
+	mapi_is_old,		/* how do we tell a message is old? */
+	mapi_fetch_headers,		/* request given message headers */
+	mapi_fetch_body,		/* request given message body */
+	mapi_trail,			/* eat message trailer */
+	mapi_delete,		/* delete the message */
+	mapi_mark_seen,		/* how to mark a message as seen */
+	mapi_end_mailbox_poll,	/* end_of_mailbox processing */
+	mapi_logout,		/* log out, we're done */
+	TRUE,			/* yes, we can re-poll */
 };
 
 
 /*
- * ===  FUNCTION  ======================================================================
- *         Name:  doMAPI
- *  Description:  retrieve messages using MAPI
+ * ===	FUNCTION  ======================================================================
+ *		   Name:  doMAPI
+ *	Description:  retrieve messages using MAPI
  * =====================================================================================
  */
 int doMAPI(struct query *ctl)
 {
-    return (do_protocol(ctl, &mapi));
+	return do_protocol(ctl, &mapi);
 }
 #endif				/* case MAPI_ENABLE */
 /*



From svn at mknod.org  Wed Aug 12 20:09:32 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed, 12 Aug 2009 13:09:32 -0500
Subject: [fetchmail-svn] r5412 - branches/BRANCH_MAPI
Message-ID: <20090812180932.C9A1021F2D0@mknod.org>

Author: mojmir
Date: 2009-08-12 13:09:32 -0500 (Wed, 12 Aug 2009)
New Revision: 5412

Modified:
   branches/BRANCH_MAPI/mapi.c
Log:
* some of these nasty warnings



Modified: branches/BRANCH_MAPI/mapi.c
===================================================================
--- branches/BRANCH_MAPI/mapi.c	2009-08-12 16:52:56 UTC (rev 5411)
+++ branches/BRANCH_MAPI/mapi.c	2009-08-12 18:09:32 UTC (rev 5412)
@@ -23,15 +23,17 @@
 #include  "config.h"
 
 #ifdef MAPI_ENABLE
+
+#define USE_UINT_ENUMS 1
 #include <libmapi/libmapi.h>
 #include <ctype.h>
 
 #if defined(HAVE_UNISTD_H)
-#include <unistd.h>
+# include <unistd.h>
 #endif
 
 #if defined(STDC_HEADERS)
-#include <stdlib.h>
+# include <stdlib.h>
 #endif
 
 #include <errno.h>
@@ -113,6 +115,7 @@
 int MapiRead (int sock, char *buf, int len)
 {
 	int count = 0;
+	(void)sock;
 
 	while (g_mapi_buffer_count < g_mapi_buffer.length) {
 		*(buf + count) = *(g_mapi_buffer.data + g_mapi_buffer_count);
@@ -139,6 +142,7 @@
  */
 int MapiPeek (int sock)
 {
+	(void)sock;
 	if (g_mapi_buffer_count < g_mapi_buffer.length)
 		return *(g_mapi_buffer.data + g_mapi_buffer_count);
 	else
@@ -165,7 +169,6 @@
  */
 static char * get_base64_attachment (TALLOC_CTX * mem_ctx, mapi_object_t obj_attach, const uint32_t size, char ** magic)
 {
-	enum MAPISTATUS retval;
 	mapi_object_t	obj_stream;
 	DATA_BLOB		data;
 	size_t		data_pos = 0;
@@ -200,7 +203,7 @@
 	*magic = talloc_strdup(mem_ctx, magic_buffer(cookie, data.data, data.length));
 	magic_close(cookie);
 
-	return ldb_base64_encode(mem_ctx, data.data, data.length);
+	return ldb_base64_encode(mem_ctx, (char const *)data.data, data.length);
 }
 
 
@@ -219,7 +222,7 @@
 	 *	' ( ) + , - . / : = ?
 	 *-----------------------------------------------------------------------------*/
 	return isalnum(ch) || ch == '\'' || ch == '(' || ch == ')' || ch == '+' || ch == ','
-	|| ch == '-' || ch == '.' || ch == '/' || ch == ':' || ch == '=' || ch == '?';
+		|| ch == '-' || ch == '.' || ch == '/' || ch == ':' || ch == '=' || ch == '?';
 }
 
 
@@ -232,7 +235,7 @@
 static void quoted_printable_encode(const DATA_BLOB * body, int *lenp)
 {
 	int				line_count = 0;
-	int				body_count = 0;
+	size_t			body_count = 0;
 	char			hex[16] = "0123456789ABCDEF";
 	char			ch;
 	char			line[78];
@@ -290,17 +293,17 @@
  *				  Note: it only searches in the top level, i.e. it's not recursive 
  * =====================================================================================
  */
-static int mapi_open_folder(mapi_object_t * obj_container, mapi_object_t * obj_child, const char *folder)
+static enum MAPISTATUS mapi_open_folder(mapi_object_t * obj_container, mapi_object_t * obj_child, const char *folder)
 {
 	enum MAPISTATUS retval;
-	struct SPropTagArray *SPropTagArray;
-	struct SPropValue		*lpProps;
-	struct SRowSet	rowset;
-	mapi_object_t	obj_htable;
-	const char	   *name;
-	const uint64_t *fid;
-	uint32_t		index;
-	int				count;
+	struct SPropTagArray * SPropTagArray;
+	struct SPropValue * lpProps;
+	struct SRowSet rowset;
+	mapi_object_t obj_htable;
+	char const * name = NULL;
+	uint64_t const * fid = NULL;
+	uint32_t index = 0;
+	uint32_t count = 0;
 
 	mapi_object_init(&obj_htable);
 	retval = GetHierarchyTable(obj_container, &obj_htable, 0, &count);
@@ -314,7 +317,8 @@
 	retval = QueryRows(&obj_htable, count, TBL_ADVANCE, &rowset);
 	if (retval != MAPI_E_SUCCESS) return GetLastError();
 
-	if (!rowset.cRows) return MAPI_E_NOT_FOUND;
+	if (!rowset.cRows)
+		return MAPI_E_NOT_FOUND;
 
 	for (index = 0; index < rowset.cRows; index++)
 	{
@@ -597,6 +601,8 @@
  */
 static int mapi_ok(int sock, char *argbuf)
 {
+	(void)sock;
+	(void)argbuf;
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_ok()\n");
 	return PS_SUCCESS;
 }
@@ -663,7 +669,7 @@
 	enum MAPISTATUS retval;
 	struct mapi_session *session = NULL;
 	struct SRowSet	proftable;
-	int				profcount;
+	size_t profcount;
 	char			localhost_name[256];
 	const char	   *workstation = NULL;
 	const char	   *ldif = NULL;
@@ -671,6 +677,8 @@
 	const char	   *name_in_proftable = NULL;
 	uint32_t		flags;
 	char		   *realhost = ctl->server.via ? ctl->server.via : ctl->server.pollname;
+	(void)sock;
+	(void)greeting;
 
 	if (outlevel > O_MONITOR) report(stdout, "MAPI> mapi_getauth()\n");
 
@@ -800,12 +808,13 @@
 	struct SPropValue *lpProps;
 	struct SRow		aRow;
 	const char	   *msgid;
-	int				props_count;
+	size_t props_count;
 	mapi_object_t	obj_message;
 	mapi_id_t	   *fid;
 	mapi_id_t	   *mid;
-	int				i;
+	size_t i;
 
+	(void)sock;
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_getrange()\n");
 
 	*countp = 0;
@@ -885,6 +894,7 @@
 	mapi_id_t	   *fid;
 	mapi_id_t	   *mid;
 	int				i;
+	(void)sock;
 
 	if (first != -1)
 	{
@@ -972,6 +982,7 @@
 	mapi_id_t	   *fid;
 	mapi_id_t	   *mid;
 	int				props_count;
+	(void)sock;
 
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_is_old(number %d)\n", number);
 
@@ -1099,6 +1110,7 @@
 	int				props_count;
 
 	(void) ctl;
+	(void)sock;
 	*lenp = 0;
 
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_fetch_headers(number %d)\n", number);
@@ -1269,6 +1281,7 @@
 	uint8_t			format;
 
 	(void) ctl;
+	(void)sock;
 	*lenp = 0;
 
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_fetch_body(number %d)\n", number);
@@ -1435,6 +1448,8 @@
  */
 static int mapi_trail(int sock, struct query *ctl, const char *tag)
 {
+	(void)ctl;
+	(void)sock;
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_trail(tag %s)\n", tag);
 
 	/*-----------------------------------------------------------------------------
@@ -1468,6 +1483,8 @@
 	mapi_id_t	   *mid;
 	int				props_count;
 
+	(void)sock;
+
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_delete(number %d)\n", number);
 
 	if (!g_mapi_initialized) return PS_UNDEFINED;
@@ -1541,6 +1558,7 @@
 	mapi_id_t	   *mid;
 	int				props_count;
 	long			message_flags;
+	(void)sock;
 
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_mark_seen(number %d)\n", number);
 
@@ -1624,7 +1642,8 @@
 static int mapi_end_mailbox_poll(int sock, struct query *ctl)
 {
 	int				flag = PS_SUCCESS;
-	(void) ctl;
+	(void)ctl;
+	(void)sock;
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_end_mailbox_poll()\n");
 
 	flag = expunge_deleted();
@@ -1642,7 +1661,8 @@
  */
 static int mapi_logout(int sock, struct query *ctl)
 {
-	(void) ctl;
+	(void)ctl;
+	(void)sock;
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_logout()\n");
 
 	if (g_mapi_initialized) mapi_clean();



From svn at mknod.org  Thu Aug 13 09:05:57 2009
From: svn at mknod.org (svn at mknod.org)
Date: Thu, 13 Aug 2009 02:05:57 -0500
Subject: [fetchmail-svn] r5413 - branches/BRANCH_MAPI
Message-ID: <20090813070558.0BFD121F3F7@mknod.org>

Author: mojmir
Date: 2009-08-13 02:05:57 -0500 (Thu, 13 Aug 2009)
New Revision: 5413

Modified:
   branches/BRANCH_MAPI/mapi.c
Log:
* rest of warnings



Modified: branches/BRANCH_MAPI/mapi.c
===================================================================
--- branches/BRANCH_MAPI/mapi.c	2009-08-12 18:09:32 UTC (rev 5412)
+++ branches/BRANCH_MAPI/mapi.c	2009-08-13 07:05:57 UTC (rev 5413)
@@ -302,7 +302,7 @@
 	mapi_object_t obj_htable;
 	char const * name = NULL;
 	uint64_t const * fid = NULL;
-	uint32_t index = 0;
+	uint32_t idx = 0;
 	uint32_t count = 0;
 
 	mapi_object_init(&obj_htable);
@@ -320,10 +320,10 @@
 	if (!rowset.cRows)
 		return MAPI_E_NOT_FOUND;
 
-	for (index = 0; index < rowset.cRows; index++)
+	for (idx = 0; idx < rowset.cRows; idx++)
 	{
-		fid = (const uint64_t *) find_SPropValue_data(&rowset.aRow[index], PR_FID);
-		name = (const char *) find_SPropValue_data(&rowset.aRow[index], PR_DISPLAY_NAME);
+		fid = (const uint64_t *) find_SPropValue_data(&rowset.aRow[idx], PR_FID);
+		name = (const char *) find_SPropValue_data(&rowset.aRow[idx], PR_DISPLAY_NAME);
 
 		if (fid && !strcmp(name, folder))
 		{
@@ -627,7 +627,7 @@
 		uint32_t		i;
 		struct SPropValue *lpProp;
 		FILE		   *fd;
-		uint32_t		index;
+		uint32_t		idx;
 		char			entry[10];
 		const char	   *label = (const char *) private;
 
@@ -642,14 +642,14 @@
 		  getentry:
 		printf("Enter username id [0]: ");
 		fgets(entry, 10, fd);
-		index = atoi(entry);
-		if (index > i) {
+		idx = atoi(entry);
+		if (idx > i) {
 			printf("Invalid id - Must be contained between 0 and %d\n", i);
 			goto getentry;
 		}
 
 		fclose(fd);
-		return index;
+		return idx;
 	}
 	else
 		return rowset->cRows;
@@ -803,18 +803,19 @@
 static int mapi_getrange(int sock, struct query *ctl, const char *folder, int *countp, int *newp, int *bytes)
 {
 	enum MAPISTATUS retval;
-	int				flag = PS_SUCCESS;
+	int				status = PS_SUCCESS;
 	struct SPropTagArray *SPropTagArray = NULL;
 	struct SPropValue *lpProps;
 	struct SRow		aRow;
 	const char	   *msgid;
 	size_t props_count;
 	mapi_object_t	obj_message;
-	mapi_id_t	   *fid;
-	mapi_id_t	   *mid;
+	mapi_id_t const	* fid = 0;
+	mapi_id_t const	* mid = 0;
 	size_t i;
 
 	(void)sock;
+	(void)ctl;
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_getrange()\n");
 
 	*countp = 0;
@@ -825,8 +826,8 @@
 	/*-----------------------------------------------------------------------------
 	 * initialize mapi here
 	 *-----------------------------------------------------------------------------*/
-	flag = mapi_init(folder);
-	if (flag) {
+	status = mapi_init(folder);
+	if (status) {
 		report(stderr, GT_("MAPI: MAPI is not initialized\n"));
 		return PS_UNDEFINED;
 	}
@@ -834,23 +835,25 @@
 	*countp = g_mapi_rowset.cRows;
 
 	for (i = 0; i < g_mapi_rowset.cRows; i++) {
-		fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[i]), PR_FID);
-		mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[i]), PR_MID);
+		fid = find_SPropValue_data(&(g_mapi_rowset.aRow[i]), PR_FID);
+		mid = find_SPropValue_data(&(g_mapi_rowset.aRow[i]), PR_MID);
 		mapi_object_init(&obj_message);
 
 		retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
 
 		if (retval == MAPI_E_SUCCESS)
 		{
+			long message_flags = 0;
+
 			SPropTagArray = set_SPropTagArray(g_mapi_mem_ctx, 0x3, PR_INTERNET_MESSAGE_ID, PR_MESSAGE_FLAGS, PR_MESSAGE_SIZE);
 			retval = GetProps(&obj_message, SPropTagArray, &lpProps, &props_count);
 			MAPIFreeBuffer(SPropTagArray);
 			if (retval != MAPI_E_SUCCESS) {
-				flag = translate_mapi_error(GetLastError());
+				status = translate_mapi_error(GetLastError());
 				talloc_free(lpProps);
 				mapi_object_release(&obj_message);
 				mapi_clean();
-				return flag;
+				return status;
 			}
 
 			/*-----------------------------------------------------------------------------
@@ -861,7 +864,7 @@
 			aRow.lpProps = lpProps;
 
 			msgid = (const char *) find_SPropValue_data(&aRow, PR_INTERNET_MESSAGE_ID);
-			long	message_flags = *(const long *) find_SPropValue_data(&aRow, PR_MESSAGE_FLAGS);
+			message_flags = *(const long *) find_SPropValue_data(&aRow, PR_MESSAGE_FLAGS);
 			if (msgid && !(message_flags & MSGFLAG_READ))
 			{
 				(*newp)++;
@@ -884,16 +887,16 @@
 static int mapi_getpartialsizes(int sock, int first, int last, int *sizes)
 {
 	enum MAPISTATUS retval;
-	int				flag = PS_SUCCESS;
+	int				status = PS_SUCCESS;
 	struct SPropTagArray *SPropTagArray = NULL;
-	struct SPropValue *lpProps;
+	struct SPropValue *lpProps = NULL;
 	struct SRow		aRow;
-	int				props_count;
+	uint32_t props_count = 0;
 	mapi_object_t	obj_message;
-	const char	   *msgid;
-	mapi_id_t	   *fid;
-	mapi_id_t	   *mid;
-	int				i;
+	const char	   * msgid = NULL;
+	mapi_id_t const	* fid = 0;
+	mapi_id_t const	* mid = 0;
+	int				i = 0;
 	(void)sock;
 
 	if (first != -1)
@@ -908,10 +911,10 @@
 		return PS_UNDEFINED;
 	}
 
-	for (i = first; i <= g_mapi_rowset.cRows && i <= last; i++)
+	for (i = first; i <= (int)g_mapi_rowset.cRows && i <= last; i++)
 	{
-		fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[i - 1]), PR_FID);
-		mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[i - 1]), PR_MID);
+		fid = find_SPropValue_data(&(g_mapi_rowset.aRow[i - 1]), PR_FID);
+		mid = find_SPropValue_data(&(g_mapi_rowset.aRow[i - 1]), PR_MID);
 		mapi_object_init(&obj_message);
 
 		retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
@@ -923,11 +926,11 @@
 			MAPIFreeBuffer(SPropTagArray);
 			if (retval != MAPI_E_SUCCESS)
 			{
-				flag = translate_mapi_error(GetLastError());
+				status = translate_mapi_error(GetLastError());
 				talloc_free(lpProps);
 				mapi_object_release(&obj_message);
 				mapi_clean();
-				return flag;
+				return status;
 			}
 
 			/*
@@ -954,7 +957,7 @@
  *	Description:  capture the sizes of all messages
  * =====================================================================================
  */
-static int mapi_getsizes(int sock, int mail_count, int *sizes)
+static int mapi_getsizes(int sock, int mail_count, int * sizes)
 {
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_getsizes(mail_count %d)\n", mail_count);
 
@@ -973,16 +976,17 @@
 static int mapi_is_old(int sock, struct query *ctl, int number)
 {
 	enum MAPISTATUS retval;
-	int				flag = FALSE;
+	int				status = FALSE;
 	struct SPropTagArray *SPropTagArray = NULL;
 	struct SPropValue *lpProps;
 	struct SRow		aRow;
 	mapi_object_t	obj_message;
 	const char	   *msgid;
-	mapi_id_t	   *fid;
-	mapi_id_t	   *mid;
-	int				props_count;
+	mapi_id_t const	* fid = 0;
+	mapi_id_t const * mid = 0;
+	uint32_t props_count;
 	(void)sock;
+	(void)ctl;
 
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_is_old(number %d)\n", number);
 
@@ -991,10 +995,10 @@
 		return PS_UNDEFINED;
 	}
 
-	if (g_mapi_rowset.cRows < number) return FALSE;
+	if ((int)g_mapi_rowset.cRows < number) return FALSE;
 
-	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
-	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	fid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
 	mapi_object_init(&obj_message);
 
 	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
@@ -1014,7 +1018,7 @@
 				retval = FindProfileAttr(mapi_profile, "Message-ID", msgid);
 				if (retval == MAPI_E_SUCCESS) {
 					if (outlevel == O_DEBUG) report(stdout, "MAPI> message %d with Message-ID=%s is old\n", number, msgid);
-					flag = TRUE;
+					status = TRUE;
 				}
 			}
 		}
@@ -1024,7 +1028,7 @@
 	}
 
 	mapi_object_release(&obj_message);
-	return flag;
+	return status;
 }
 
 /*
@@ -1092,22 +1096,22 @@
 {
 	enum MAPISTATUS retval;
 	struct SPropTagArray *SPropTagArray = NULL;
-	struct SPropValue *lpProps;
+	struct SPropValue *lpProps = NULL;
 	struct SRow		aRow;
 	mapi_object_t	obj_message;
-	const char	   *msgid;
-	mapi_id_t	   *fid;
-	mapi_id_t	   *mid;
-	const uint64_t *delivery_date;
-	const char	   *date = NULL;
-	const char	   *from = NULL;
-	const char	   *to = NULL;
-	const char	   *cc = NULL;
-	const char	   *bcc = NULL;
-	const char	   *subject = NULL;
-	const uint8_t  *has_attach = NULL;
-	uint8_t			format;
-	int				props_count;
+	const char	   * msgid = NULL;
+	mapi_id_t const	   * fid = NULL;
+	mapi_id_t const	   * mid = NULL;
+	const uint64_t * delivery_date;
+	const char	   * date = NULL;
+	const char	   * from = NULL;
+	const char	   * to = NULL;
+	const char	   * cc = NULL;
+	const char	   * bcc = NULL;
+	const char	   * subject = NULL;
+	const uint8_t  * has_attach = NULL;
+	uint8_t	format = 0;
+	uint32_t props_count = 0;
 
 	(void) ctl;
 	(void)sock;
@@ -1120,10 +1124,10 @@
 		return (PS_UNDEFINED);
 	}
 
-	if (g_mapi_rowset.cRows < number) return PS_UNDEFINED;
+	if ((int)g_mapi_rowset.cRows < number) return PS_UNDEFINED;
 
-	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
-	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	fid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
 	mapi_object_init(&obj_message);
 
 	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
@@ -1267,8 +1271,8 @@
 	mapi_object_t	obj_tb_attach;
 	mapi_object_t	obj_attach;
 	const char	   *msgid;
-	mapi_id_t	   *fid;
-	mapi_id_t	   *mid;
+	mapi_id_t const	   *fid = NULL;
+	mapi_id_t const	   *mid = NULL;
 	const uint8_t  *has_attach = NULL;
 	const uint32_t *attach_num = NULL;
 	DATA_BLOB		body;
@@ -1276,9 +1280,9 @@
 	const uint32_t *attach_size;
 	char		   *attachment_data;
 	char		   *magic;
-	int				props_count;
-	int				attach_count;
-	uint8_t			format;
+	uint32_t props_count = 0;
+	uint32_t attach_count = 0;
+	uint8_t format = 0;
 
 	(void) ctl;
 	(void)sock;
@@ -1291,10 +1295,10 @@
 		return (PS_UNDEFINED);
 	}
 
-	if (g_mapi_rowset.cRows < number) return (PS_UNDEFINED);
+	if ((int)g_mapi_rowset.cRows < number) return (PS_UNDEFINED);
 
-	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
-	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	fid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
 	mapi_object_init(&obj_message);
 
 	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
@@ -1446,7 +1450,7 @@
  *				  g_mapi_buffer.
  * =====================================================================================
  */
-static int mapi_trail(int sock, struct query *ctl, const char *tag)
+static int mapi_trail(int sock, struct query *ctl, const char * tag)
 {
 	(void)ctl;
 	(void)sock;
@@ -1473,15 +1477,15 @@
 	mapi_container_list_t *element;
 	enum MAPISTATUS retval;
 	const char	   *profname = NULL;
-	int				flag = PS_UNDEFINED;
+	int				status = PS_UNDEFINED;
 	struct SPropTagArray *SPropTagArray = NULL;
 	struct SPropValue *lpProps;
 	struct SRow		aRow;
 	mapi_object_t	obj_message;
 	const char	   *msgid;
-	mapi_id_t	   *fid;
-	mapi_id_t	   *mid;
-	int				props_count;
+	mapi_id_t const	   *fid = 0;
+	mapi_id_t const	   *mid = 0;
+	uint32_t props_count = 0;
 
 	(void)sock;
 
@@ -1503,8 +1507,8 @@
 	else
 		profname = ctl->mapi_profname;
 
-	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
-	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	fid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
 	mapi_object_init(&obj_message);
 
 	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
@@ -1525,7 +1529,7 @@
 				retval = mapi_profile_delete_string_attr(profname, "Message-ID", msgid);
 				if (retval == MAPI_E_SUCCESS) {
 					if (outlevel == O_DEBUG) report(stdout, "MAPI> message %d with Message-ID=%s will be deleted\n", number, msgid);
-					flag = PS_SUCCESS;
+					status = PS_SUCCESS;
 				}
 			}
 		}
@@ -1534,7 +1538,7 @@
 	}
 
 	mapi_object_release(&obj_message);
-	return flag;
+	return status;
 }
 
 
@@ -1547,16 +1551,16 @@
 static int mapi_mark_seen(int sock, struct query *ctl, int number)
 {
 	enum MAPISTATUS retval;
-	int				flag = FALSE;
+	int				status = FALSE; /* TODO: weird mixing of PS_* and TRUE/FALSE */
 	struct SPropTagArray *SPropTagArray = NULL;
 	struct SPropValue *lpProps;
 	struct SRow		aRow;
 	mapi_object_t	obj_message;
 	const char	   *msgid = NULL;
 	const char	   *profname = NULL;
-	mapi_id_t	   *fid;
-	mapi_id_t	   *mid;
-	int				props_count;
+	mapi_id_t const	* fid = 0;
+	mapi_id_t const	* mid = 0;
+	uint32_t props_count = 0;
 	long			message_flags;
 	(void)sock;
 
@@ -1567,10 +1571,10 @@
 		return PS_UNDEFINED;
 	}
 
-	if (g_mapi_rowset.cRows < number) return FALSE;
+	if ((int)g_mapi_rowset.cRows < number) return FALSE;
 
-	fid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
-	mid = (mapi_id_t *) find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
+	fid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_FID);
+	mid = find_SPropValue_data(&(g_mapi_rowset.aRow[number - 1]), PR_MID);
 	mapi_object_init(&obj_message);
 
 	retval = OpenMessage(&g_mapi_obj_store, *fid, *mid, &obj_message, 0x0);
@@ -1593,10 +1597,10 @@
 				if (retval == MAPI_E_SUCCESS)
 				{
 					if (outlevel == O_DEBUG) report(stdout, "MAPI> message %d with Message-ID=%s is already marked as seen\n", number, msgid);
-					flag = TRUE;
+					status = TRUE; 
 					talloc_free(lpProps);
 					mapi_object_release(&obj_message);
-					return flag;
+					return status;
 				}
 
 				/*-----------------------------------------------------------------------------
@@ -1607,7 +1611,7 @@
 				mapi_profile_add_string_attr(profname, "Message-ID", msgid);
 				if (retval == MAPI_E_SUCCESS) {
 					if (outlevel == O_DEBUG) report(stdout, "MAPI> marked message %d with Message-ID=%s seen\n", number, msgid);
-					flag = TRUE;
+					status = TRUE;
 				}
 
 				/*-----------------------------------------------------------------------------
@@ -1619,7 +1623,7 @@
 					if (retval != MAPI_E_SUCCESS) {
 						talloc_free(lpProps);
 						mapi_object_release(&obj_message);
-						return flag;
+						return status;
 					}
 				}
 			}
@@ -1629,7 +1633,7 @@
 	}
 	mapi_object_release(&obj_message);
 
-	return flag;
+	return status;
 }
 
 
@@ -1641,15 +1645,15 @@
  */
 static int mapi_end_mailbox_poll(int sock, struct query *ctl)
 {
-	int				flag = PS_SUCCESS;
+	int				status = PS_SUCCESS;
 	(void)ctl;
 	(void)sock;
 	if (outlevel >= O_MONITOR) report(stdout, "MAPI> mapi_end_mailbox_poll()\n");
 
-	flag = expunge_deleted();
+	status = expunge_deleted();
 	mapi_id_array_release(&g_mapi_deleted_ids);
 	mapi_clean();
-	return flag;
+	return status;
 }
 
 
@@ -1688,7 +1692,7 @@
 	mapi_mark_seen,		/* how to mark a message as seen */
 	mapi_end_mailbox_poll,	/* end_of_mailbox processing */
 	mapi_logout,		/* log out, we're done */
-	TRUE,			/* yes, we can re-poll */
+	TRUE			/* yes, we can re-poll */
 };
 
 



From svn at mknod.org  Thu Aug 13 09:50:32 2009
From: svn at mknod.org (svn at mknod.org)
Date: Thu, 13 Aug 2009 02:50:32 -0500
Subject: [fetchmail-svn] r5414 - branches/BRANCH_MAPI
Message-ID: <20090813075032.898FD21F3F7@mknod.org>

Author: mojmir
Date: 2009-08-13 02:50:32 -0500 (Thu, 13 Aug 2009)
New Revision: 5414

Modified:
   branches/BRANCH_MAPI/openchange-tools.c
   branches/BRANCH_MAPI/openchange-tools.h
Log:
* upgrade openchange tools from libmapi-0.8 to libmapi-0.8.2

note: seems that these two files do not form any library within
libmapi.



Modified: branches/BRANCH_MAPI/openchange-tools.c
===================================================================
--- branches/BRANCH_MAPI/openchange-tools.c	2009-08-13 07:05:57 UTC (rev 5413)
+++ branches/BRANCH_MAPI/openchange-tools.c	2009-08-13 07:50:32 UTC (rev 5414)
@@ -22,7 +22,27 @@
 #include <libmapi/libmapi.h>
 #include "openchange-tools.h"
 
+/*
+static void popt_openchange_version_callback(poptContext con,
+					     enum poptCallbackReason reason,
+					     const struct poptOption *opt,
+					     const char *arg,
+					     const void *data)
+{
+	switch (opt->val) {
+	case 'V':
+		printf("Version %s\n", OPENCHANGE_VERSION_STRING);
+		exit (0);
+	}
+}
 
+struct poptOption popt_openchange_version[] = {
+	{ NULL, 0, POPT_ARG_CALLBACK, (void *)popt_openchange_version_callback	},
+	{ "version", 'V', POPT_ARG_NONE, NULL, 'V', "Print version "		},
+	{ NULL }
+};
+*/
+
 /*
  * Retrieve the property value for a given SRow and property tag.  
  *
@@ -31,22 +51,22 @@
  *
  * Fetch property normally for any others properties
  */
-_PUBLIC_ void *octool_get_propval(struct SRow *aRow, uint32_t proptag)
+_PUBLIC_ const void * octool_get_propval(struct SRow *aRow, uint32_t proptag)
 {
 	const char	*str;
 
 	if (((proptag & 0xFFFF) == PT_STRING8) ||
 	    ((proptag & 0xFFFF) == PT_UNICODE)) {
 		proptag = (proptag & 0xFFFF0000) | PT_STRING8;
-		str = (const char *) find_SPropValue_data(aRow, proptag);
-		if (str) return (void *)str;
+		str = find_SPropValue_data(aRow, proptag);
+		if (str) return str;
 
 		proptag = (proptag & 0xFFFF0000) | PT_UNICODE;
-		str = (const char *) find_SPropValue_data(aRow, proptag);
-		return (void *)str;
+		str = find_SPropValue_data(aRow, proptag);
+		return str;
 	} 
 
-	return (void *)find_SPropValue_data(aRow, proptag);
+	return find_SPropValue_data(aRow, proptag);
 }
 
 
@@ -59,16 +79,17 @@
 {
 	enum MAPISTATUS	retval;
 	uint16_t	read_size;
-	unsigned char	buf[0x1000];
+	uint8_t		buf[0x1000];
 
 	body->length = 0;
-	body->data = talloc_zero(mem_ctx, unsigned char);
+	body->data = talloc_zero(mem_ctx, uint8_t);
 
 	do {
 		retval = ReadStream(obj_stream, buf, 0x1000, &read_size);
 		MAPI_RETVAL_IF(retval, GetLastError(), body->data);
 		if (read_size) {
-			body->data = talloc_realloc(mem_ctx, body->data, unsigned char, body->length + read_size);
+			body->data = talloc_realloc(mem_ctx, body->data, uint8_t,
+						    body->length + read_size);
 			memcpy(&(body->data[body->length]), buf, read_size);
 			body->length += read_size;
 		}
@@ -90,8 +111,8 @@
 	enum MAPISTATUS			retval;
 	const struct SBinary_short	*bin;
 	mapi_object_t			obj_stream;
-	char				*data;
-	uint8_t				format;
+	char const * data;
+	uint8_t	format = 0;
 
 	/* Sanity checks */
 	MAPI_RETVAL_IF(!obj_message, MAPI_E_INVALID_PARAMETER, NULL);
@@ -167,6 +188,7 @@
 	struct SPropValue		*lpProps;
 	struct SRow			aRow;
 	uint32_t			count;
+	ssize_t				len;
 	/* common email fields */
 	const char			*msgid;
 	const char			*from, *to, *cc, *bcc;
@@ -262,8 +284,8 @@
 	printf("Body:\n");
 	fflush(0);
 	if (body.length) {
-		write(1, body.data, body.length);
-		write(1, "\n", 1);
+		len = write(1, body.data, body.length);
+		len = write(1, "\n", 1);
 		fflush(0);
 		talloc_free(body.data);
 	} 
@@ -274,32 +296,40 @@
 /*
  * OpenChange MAPI programs initialization routine
  */
-_PUBLIC_ enum MAPISTATUS octool_init_mapi(TALLOC_CTX *mem_ctx,
-					  const char *opt_profname,
-					  const char *opt_password,
-					  uint32_t provider)
+/*_PUBLIC_ struct mapi_session *octool_init_mapi(const char *opt_profname,
+					       const char *opt_password,
+					       uint32_t provider)
 {
 	enum MAPISTATUS		retval;
+	char * profname = NULL;
 	struct mapi_session	*session = NULL;
+	TALLOC_CTX		*mem_ctx = NULL;
 
-	if (!opt_profname) {
-		retval = GetDefaultProfile(&opt_profname);
+	mem_ctx = talloc_named(NULL, 0, "octool_init_mapi");
+	if (opt_profname) {
+		profname = talloc_strdup(mem_ctx, opt_profname);
+	} else {
+		retval = GetDefaultProfile(&profname);
 		if (retval != MAPI_E_SUCCESS) {
 			mapi_errstr("GetDefaultProfile", GetLastError());
-			return retval;
+			talloc_free(mem_ctx);
+			return NULL;
 		}
 	}
 
 	if (!provider) {
-		retval = MapiLogonEx(&session, opt_profname, opt_password);
+		retval = MapiLogonEx(&session, profname, opt_password);
 	} else {
-		retval = MapiLogonProvider(&session, opt_profname, opt_password, provider);
+		retval = MapiLogonProvider(&session, profname, opt_password, provider);
 	}
+	MAPIFreeBuffer(profname);
 
 	if (retval != MAPI_E_SUCCESS) {
 		mapi_errstr("MapiLogonEx", GetLastError());
-		return retval;
+		talloc_free(mem_ctx);
+		return NULL;
 	}
 
-	return MAPI_E_SUCCESS;
-}
+	talloc_free(mem_ctx);
+	return session;
+}*/

Modified: branches/BRANCH_MAPI/openchange-tools.h
===================================================================
--- branches/BRANCH_MAPI/openchange-tools.h	2009-08-13 07:05:57 UTC (rev 5413)
+++ branches/BRANCH_MAPI/openchange-tools.h	2009-08-13 07:50:32 UTC (rev 5414)
@@ -22,6 +22,8 @@
 #ifndef	__OPENCHANGETOOLS_H__
 #define	__OPENCHANGETOOLS_H__
 
+#include <popt.h>
+
 #define	DEFAULT_PROFDB	"%s/.openchange/profiles.ldb"
 #define	DEFAULT_TDB	"%s/.openchange/index.tdb"
 #define	DEFAULT_MBOX	"%s/.openchange/mbox"
@@ -39,17 +41,20 @@
 #endif
 #endif
 
+/* Common popt structures for tool */
+extern struct poptOption popt_openchange_version[];
+
+#define	POPT_OPENCHANGE_VERSION { NULL, 0, POPT_ARG_INCLUDE_TABLE, popt_openchange_version, 0, "Common openchange options:", NULL },
+
 #ifndef _PUBLIC_
 #define _PUBLIC_
 #endif
 
 __BEGIN_DECLS
 _PUBLIC_ enum MAPISTATUS octool_message(TALLOC_CTX *, mapi_object_t *);
-_PUBLIC_ void *octool_get_propval(struct SRow *, uint32_t);
-_PUBLIC_ enum MAPISTATUS octool_get_body(TALLOC_CTX *, mapi_object_t *,
-					 struct SRow *, DATA_BLOB *);
-_PUBLIC_ enum MAPISTATUS octool_init_mapi(TALLOC_CTX *, const char *, const char *,
-					  uint32_t);
+_PUBLIC_ const void * octool_get_propval(struct SRow *, uint32_t);
+_PUBLIC_ enum MAPISTATUS octool_get_body(TALLOC_CTX *, mapi_object_t *, struct SRow *, DATA_BLOB *);
+/*_PUBLIC_ struct mapi_session * octool_init_mapi(const char *, const char *, uint32_t);*/
 __END_DECLS
 
 #endif /*!__OPENCHANGETOOLS_H__ */



From svn at mknod.org  Mon Aug 17 19:16:36 2009
From: svn at mknod.org (svn at mknod.org)
Date: Mon, 17 Aug 2009 12:16:36 -0500
Subject: [fetchmail-svn] r5415 - branches/BRANCH_6-3
Message-ID: <20090817171636.6BA0C21F45A@mknod.org>

Author: m-a
Date: 2009-08-17 12:16:35 -0500 (Mon, 17 Aug 2009)
New Revision: 5415

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/socket.c
Log:
Fix free() of unallocated memory on intact/non-verbose SSL-connections.

Problem was improper scoping of xfree(tt). Patch courtesy of Thomas Heinz.
Fixes Gentoo bug #280760.

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-13 07:50:32 UTC (rev 5414)
+++ branches/BRANCH_6-3/NEWS	2009-08-17 17:16:35 UTC (rev 5415)
@@ -51,6 +51,15 @@
 
 fetchmail 6.3.12 (released XXXX-XX-XX - not yet):
 
+# REGRESSION FIXES
+* The CVS-2009-2666 fix in fetchmail release 6.3.11 caused a free() of
+  unallocated memory on SSL connections, which caused crashes or program aborts
+  on some systems (depending on how initialization and free() of unallocated
+  memory is handled in compiler and libc).
+  Patch courtesy of Thomas Heinz, fixes Gentoo Bug #280760.
+  This regression affected only the 6.3.11 release, but not the patch that was
+  part of the security announcement fetchmail-SA-2009-01.
+
 # TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
 * [ca]    Catalan (Ernest Adrogu? Calveras)
 * [cs]    Czech (Petr Pisar)

Modified: branches/BRANCH_6-3/socket.c
===================================================================
--- branches/BRANCH_6-3/socket.c	2009-08-13 07:50:32 UTC (rev 5414)
+++ branches/BRANCH_6-3/socket.c	2009-08-17 17:16:35 UTC (rev 5415)
@@ -628,9 +628,10 @@
 				report(stdout, GT_("Unknown Issuer CommonName\n"));
 		}
 		if ((i = X509_NAME_get_text_by_NID(subj, NID_commonName, buf, sizeof(buf))) != -1) {
-			if (outlevel >= O_VERBOSE)
+			if (outlevel >= O_VERBOSE) {
 				report(stdout, GT_("Server CommonName: %s\n"), (tt = sdump(buf, i)));
-			xfree(tt);
+				xfree(tt);
+			}
 			if ((size_t)i >= sizeof(buf) - 1) {
 				/* Possible truncation. In this case, this is a DNS name, so this
 				 * is really bad. We do not tolerate this even in the non-strict case. */



From svn at mknod.org  Tue Aug 18 10:41:00 2009
From: svn at mknod.org (svn at mknod.org)
Date: Tue, 18 Aug 2009 03:41:00 -0500
Subject: [fetchmail-svn] r5416 - branches/BRANCH_6-3/website/host-scripts
Message-ID: <20090818084100.58DB121F46A@mknod.org>

Author: m-a
Date: 2009-08-18 03:40:59 -0500 (Tue, 18 Aug 2009)
New Revision: 5416

Modified:
   branches/BRANCH_6-3/website/host-scripts/upload-website.sh
Log:
Also upload website to TU Dortmund mirror at http://mandree.home.pages.de/fetchmail/info/

Modified: branches/BRANCH_6-3/website/host-scripts/upload-website.sh
===================================================================
--- branches/BRANCH_6-3/website/host-scripts/upload-website.sh	2009-08-17 17:16:35 UTC (rev 5415)
+++ branches/BRANCH_6-3/website/host-scripts/upload-website.sh	2009-08-18 08:40:59 UTC (rev 5416)
@@ -1,7 +1,7 @@
 #! /bin/sh
 
 # Script to upload fetchmail website from SVN repository
-# (C) 2008 by Matthias Andree. GNU GPL v3.
+# (C) 2008 - 2009 by Matthias Andree. GNU GPL v3.
 
 : ${BERLIOS_LOGIN=m-a}
 
@@ -19,7 +19,9 @@
     exit 1
 fi
 
-echo "==>  Uploading website (rsync)"
+pids=
+
+echo "==>  Uploading website (rsync) to BerliOS"
 # upload
 rsync \
     --chmod=ug=rwX,o=rX,Dg=s --perms \
@@ -27,6 +29,18 @@
     --exclude host-scripts \
     --exclude .svn --exclude '*~' --exclude '#*#' \
     * \
-    "$BERLIOS_LOGIN at shell.berlios.de:/home/groups/fetchmail/htdocs/"
+    "$BERLIOS_LOGIN at shell.berlios.de:/home/groups/fetchmail/htdocs/" &
+pids="$pids $!"
 
-echo "==>  Success."
+echo "==>  Uploading website (rsync) to TU Dortmund"
+rsync \
+    --chmod=ug=rwX,o=rX,Dg=s --perms \
+    --copy-links --times --checksum --verbose \
+    --exclude host-scripts \
+    --exclude .svn --exclude '*~' --exclude '#*#' \
+    * \
+    ma at fat-tony.dt.e-technik.uni-dortmund.de:public_html/fetchmail/info/ &
+pids="$pids $!"
+
+wait $pids
+echo "==>  Done; check rsync output above for success."



From svn at mknod.org  Tue Aug 18 13:27:19 2009
From: svn at mknod.org (svn at mknod.org)
Date: Tue, 18 Aug 2009 06:27:19 -0500
Subject: [fetchmail-svn] r5417 - branches/BRANCH_6-3
Message-ID: <20090818112720.0215821F46D@mknod.org>

Author: m-a
Date: 2009-08-18 06:27:19 -0500 (Tue, 18 Aug 2009)
New Revision: 5417

Modified:
   branches/BRANCH_6-3/fetchmail-FAQ.html
Log:
Remove some of ESR's rants against commercial software; minor formatting fixes.

Modified: branches/BRANCH_6-3/fetchmail-FAQ.html
===================================================================
--- branches/BRANCH_6-3/fetchmail-FAQ.html	2009-08-18 08:40:59 UTC (rev 5416)
+++ branches/BRANCH_6-3/fetchmail-FAQ.html	2009-08-18 11:27:19 UTC (rev 5417)
@@ -535,17 +535,8 @@
 utility - unfortunately it does not detect SSL-wrapped variants).</p>
 
 <p>If you have the option, we recommend using or installing an
-IMAP4rev1 or UIDL- and TOP-capable POP3 server. IMAP enables some
-significant performance optimizations.</p>
+IMAP4rev1 or UIDL-capable POP3 server.</p>
 
-<p>Don't be fooled by NT/Exchange propaganda. M$ Exchange is just
-plain broken (see item <a href="#S2">S2</a>) and NT cannot handle
-the sustained load of a high-volume remote mail server. Even
-Microsoft itself knows better than to try this; their own Hotmail
-service runs over Solaris! For extended discussion, see John
-Kirch's excellent <a href="http://unix-vs-nt.org/kirch/">white
-paper</a> on Unix vs. NT performance.</p>
-
 <p>A decent POP3/IMAP server that has recently become popular is <a
     href="http://dovecot.org/">Dovecot</a>.</p>
 
@@ -1601,28 +1592,32 @@
 attachments on the floor, though.  Microsoft acknowledges this
 as a known bug and apparently has no plans to fix it.</p>
 
-<p>Fetchmail using IMAP supports the proprietary NTLM mode used
-with M$ Exchange servers. To enable this, configure fetchmail with
+<p>Fetchmail using IMAP usually supports the proprietary NTLM mode used
+with Microsoft Exchange servers. "Usually" here means that it fails on some
+servers for reasons that we haven't been able to debug yet, perhaps it's
+related to the NTLM domain.</p>
+
+<p>To enable this NTLM mode, configure fetchmail with
 the --enable-NTLM option and recompile it. Specify a user option
 value that looks like 'user at domain': the part to the left of the @
 will be passed as the username and the part to the right as the
 NTLM domain.</p>
 
-<p>M$ Exchange violates the POP3 and IMAP RFCs. Its LIST command
+<p>Microsoft Exchange violates the POP3 and IMAP RFCs. Its LIST command
 does not reveal the real sizes of mail in the pop mailbox, but the
 sizes of the compressed versions in the exchange mail database
 (thanks to Arjan De Vet and Guido Van Rooij for alerting us to this
 problem).</p>
 
-<p>Fetchmail works with M$ Exchange, despite this brain damage. Two
-features are compromised. One is that the --limit option will not
+<p>Fetchmail works with Microsoft Exchange, despite this brain damage.
+Two features are compromised. One is that the --limit option will not
 work right (it will check against compressed and not actual sizes).
 The other is that a too-small SIZE argument may be passed to your
 ESMTP listener, assuming you're using one (this should not be a
 problem unless the actual size of the message is above the
 listener's configured length limit).</p>
 
-<p>Somewhat belatedly, I've learned that there's supposed to be a
+<p>ESR learned that there's supposed to be a
 registry bit that can fix this breakage:</p>
 
 <pre>
@@ -1686,7 +1681,7 @@
 deleted.</dd>
 </dl>
 
-<p>The Microsoft pod-person who revealed this information to me
+<p>The Microsoft employee who revealed this information to ESR
 admitted that he couldn't find it anywhere in their public
 knowledge base.</p>
 
@@ -1694,7 +1689,7 @@
 as its symptom a response to LOGIN that says "NO Ambiguous Alias".
 Grant Edwards writes:</p>
 
-<p>This means that Exchange Server is too f*&amp;#ing stupid to
+<blockquote><p>This means that Exchange Server is too [...] stupid to
 figure out which mailbox belongs to you. Instead of actually
 keeping track of which inbox belongs to which user, it uses some
 half-witted, guess-o-matic heuristic to try to guess your mailbox
@@ -1702,9 +1697,7 @@
 
 <p>In your case it doesn't work because your username maps to more
 than one mailbox. For some people it doesn't work because their
-username maps to zero mailboxes. This is yet another inept, lame,
-almost criminally negligent design decision from our friends in
-Redmond.</p>
+username maps to zero mailboxes.</p>
 
 <p>You've got several options:</p>
 
@@ -1715,6 +1708,7 @@
 <li>Get your administrator to add an alias that maps your username
 explicitly to your mailbox name.</li>
 </ul>
+</blockquote>
 
 <p>But, the best option involves finding a server that runs better
 software.</p>
@@ -1728,10 +1722,7 @@
 the LIST are rounded to the nearest 1024 bytes. It also has a nasty
 habit of discarding headers it doesn't recognize, such as X- and
 Resent- headers.</p>
-
-<p>As with M$ Exchange, the only real fix for these problems is to
-get a POP (or preferably IMAP) server that isn't brain-dead.
-OpenMail's project manager claims these bugs have been fixed in
+<p>OpenMail's project manager claims these bugs have been fixed in
 6.0.</p>
 
 <p>We've had a more recent report (December 2001) that the TOP
@@ -1740,13 +1731,11 @@
 
 <h2><a id="S4" name="S4">S4. How can I use fetchmail with Novell GroupWise?</a></h2>
 
-<p>The Novell GroupWise IMAP server would be better named
-GroupFoolish; it is (according to the designer of IMAP) unusably
-broken. Among other things, it doesn't include a required content
-length in its BODY[TEXT] response.</p>
+<p>The Novell GroupWise IMAP server is (according to the designer of
+IMAP) unusably broken. Among other things, it doesn't include a required
+content length in its BODY[TEXT] response.</p>
 
-<p>Fetchmail works around this problem, but we strongly recommend
-voting with your dollars for a server that isn't brain-dead.</p>
+<p>Fetchmail works around this problem to some extent, but no guarantees.</p>
 
 <h2><a id="S5" name="S5">S5. How can I use fetchmail with
 InterChange?</a></h2>
@@ -1757,9 +1746,9 @@
 it reports the message length with attachments but doesn't download
 them on TOP or RETR.</p>
 
-<p>On Jan 9 2001, the people at InfiniteMail sent me mail informing
-me that their new 3.61.08 release of InterChange fixes this
-problem. I don't have any reports one way or the other yet.</p>
+<p>On Jan 9 2001, the people at InfiniteMail sent ESR mail informing
+him that their new 3.61.08 release of InterChange fixed this
+problem.</p>
 
 <h2><a id="S6" name="S6">S6. How can I use fetchmail with MailMax?</a></h2>
 
@@ -3148,9 +3137,8 @@
 <h2><a id="X7" name="X7">X7. Some mail attachments are hanging
 fetchmail.</a></h2>
 
-<p>This isn't fetchmail's problem either; fetchmail doesn't know
-anything about mail attachments and doesn't treat them any
-differently from plain message data.</p>
+<p>Fetchmail doesn't know anything about mail attachments and doesn't
+treat them any differently from plain message data.</p>
 
 <p>The most usual cause of this problem seems to be bugs in your
 network transport layer's capability to handle the very large
@@ -3171,51 +3159,49 @@
 <h2><a id="X8" name="X8">X8. A spurious ) is being appended to my
 messages.</a></h2>
 
-<p>Blame it on that rancid pile of dung and offal called Microsoft
-Exchange. Due to the problem described in <a href="#S2">S2</a>, the
-IMAP support in fetchmail cannot follow the IMAP protocol 100%.
+<p>Due to the problem described in <a href="#S2">S2</a>, the
+IMAP support in fetchmail cannot follow the IMAP protocol 100&nbsp;%.
 Most of the time it doesn't matter, but if you combine it with an
 SMTP server that behaves unusually, you'll get a spurious ) at
-message end.</p>
+the message end.</p>
 
 <p>One piece of software that can trigger this is the Interchange
 mail server, as used by, e.g., mailandnews.com. Here's what
 happens:</p>
 
-<p>1. Someone sends mail to your account. The last line of the
+<ol><li>Someone sends mail to your account. The last line of the
 message contains text. So at the SMTP level, the message ends with,
-e.g. "blahblah\r\n.\r\n"</p>
+e.g. "blahblah\r\n.\r\n"</li>
 
-<p>2. The SMTP handler sees the final "\r\n.\r\n" and recognizes
+<li>The SMTP handler sees the final "\r\n.\r\n" and recognizes
 the end of the message. However, instead of doing the normal thing,
 which is tossing out the ".\r\n" and leaving the first '\r\n' as
 part of the email body, Interchange throws out the whole
 "\r\n.\r\n", and leaves the email body without any line terminator
 at the end of it. RFC821 does not forbid this, though it probably
-should.</p>
+should.</li>
 
-<p>3. Fetchmail, or some other IMAP client, asks for the message.
+<li>Fetchmail, or some other IMAP client, asks for the message.
 IMAP returns it, but it's enclosed inside parentheses, according to
 the protocol. The message size in bytes is also present. Because
 the message doesn't end with a line terminator, the IMAP client
-sees:</p>
+sees:
 
 <pre>
-
  ....blahblah)...
 </pre>
 
-<p>where the ')' is from IMAP.</p>
+<p>where the ')' is from IMAP.</p></li>
 
-<p>4. Fetchmail only deals with complete lines, and can't trust the
-stated message size because Microsoft Exchange fscks it up.</p>
+<li>Fetchmail only deals with complete lines, and can't trust the
+stated message size because Microsoft Exchange goofs it up.</li>
 
-<p>5. As a result, fetchmail takes the final 'blahblah)' and puts
+<li>As a result, fetchmail takes the final 'blahblah)' and puts
 it at the end of the message it forwards on. If you have verbosity
-on, you'll get a message about actual != expected.</p>
+on, you'll get a message about actual != expected.</li>
+</ol>
 
-<p>There is no fix for this. The nuke mentioned in <a
-href="#S2">S2</a> looks more tempting all the time.</p>
+<p>There is no fix for this.</p>
 
 <h2><a id="X9" name="X9">X9. Missing "Content-Transfer-Encoding" header
 	with Domino IMAP</a></h2>



From svn at mknod.org  Tue Aug 18 13:35:54 2009
From: svn at mknod.org (svn at mknod.org)
Date: Tue, 18 Aug 2009 06:35:54 -0500
Subject: [fetchmail-svn] r5418 - branches/BRANCH_6-3
Message-ID: <20090818113554.C4C1221F46D@mknod.org>

Author: m-a
Date: 2009-08-18 06:35:54 -0500 (Tue, 18 Aug 2009)
New Revision: 5418

Modified:
   branches/BRANCH_6-3/fetchmail-FAQ.html
Log:
Add X10 on truncated message bodies.

Modified: branches/BRANCH_6-3/fetchmail-FAQ.html
===================================================================
--- branches/BRANCH_6-3/fetchmail-FAQ.html	2009-08-18 11:27:19 UTC (rev 5417)
+++ branches/BRANCH_6-3/fetchmail-FAQ.html	2009-08-18 11:35:54 UTC (rev 5418)
@@ -246,6 +246,9 @@
 messages.</a><br/>
 <a href="#X9">X9. Missing "Content-Transfer-Encoding" header
 with Domino IMAP</a><br/>
+<a href="#X10">X10. Fetchmail delivers partial messages</a><br/>
+
+
 <h2 id="C_O">Other problems</h2>
 
 <a href="#O1">O1. The --logfile option doesn't work if the logfile
@@ -3217,6 +3220,24 @@
     Kim's list post</a>
 </p>
 
+<h2><a id="X10" name="X10">X10. Fetchmail delivers partial
+	messages</a></h2>
+
+<p>Fetchmail is sometimes reported to deliver partial messages. This
+is usually related to network outages that occur while fetchmail is
+downloading a message body. In such cases, fetchmail has downloaded a
+complete header, so your header will be intact. The message body will be
+truncated, and fetchmail will later attempt to redownload the
+message (providing the server is standards conformant).</p>
+
+<p>The reason for the truncation is that fetchmail streams the body
+directly from the POP3/IMAP server into the SMTP/LMTP server or MDA, so
+fetchmail has already written a part of the message before it notices it
+will be incomplete, and fetchmail cannot abort a transaction it has
+started, and it's unclear if it ever will be able to, because this is
+not standardized and the outcome will depend on the receiving software
+(be it SMTP/LMTP or MDA).</p>
+
 <hr/>
 <h1>Other problems</h1>
 <h2><a id="O1" name="O1">O1. The --logfile option doesn't work if



From svn at mknod.org  Tue Aug 18 13:38:51 2009
From: svn at mknod.org (svn at mknod.org)
Date: Tue, 18 Aug 2009 06:38:51 -0500
Subject: [fetchmail-svn] r5419 - branches/BRANCH_6-3
Message-ID: <20090818113851.563E721F46D@mknod.org>

Author: m-a
Date: 2009-08-18 06:38:51 -0500 (Tue, 18 Aug 2009)
New Revision: 5419

Modified:
   branches/BRANCH_6-3/fetchmail-FAQ.html
Log:
Add rationale for direct body streaming to X10.

Modified: branches/BRANCH_6-3/fetchmail-FAQ.html
===================================================================
--- branches/BRANCH_6-3/fetchmail-FAQ.html	2009-08-18 11:35:54 UTC (rev 5418)
+++ branches/BRANCH_6-3/fetchmail-FAQ.html	2009-08-18 11:38:51 UTC (rev 5419)
@@ -3231,12 +3231,12 @@
 message (providing the server is standards conformant).</p>
 
 <p>The reason for the truncation is that fetchmail streams the body
-directly from the POP3/IMAP server into the SMTP/LMTP server or MDA, so
-fetchmail has already written a part of the message before it notices it
-will be incomplete, and fetchmail cannot abort a transaction it has
-started, and it's unclear if it ever will be able to, because this is
-not standardized and the outcome will depend on the receiving software
-(be it SMTP/LMTP or MDA).</p>
+directly from the POP3/IMAP server into the SMTP/LMTP server or MDA (in
+order to save memory), so fetchmail has already written a part of the
+message before it notices it will be incomplete, and fetchmail cannot
+abort a transaction it has started, and it's unclear if it ever will be
+able to, because this is not standardized and the outcome will depend on
+the receiving software (be it SMTP/LMTP or MDA).</p>
 
 <hr/>
 <h1>Other problems</h1>



From svn at mknod.org  Tue Aug 18 14:14:37 2009
From: svn at mknod.org (svn at mknod.org)
Date: Tue, 18 Aug 2009 07:14:37 -0500
Subject: [fetchmail-svn] r5420 - branches/BRANCH_6-3
Message-ID: <20090818121437.9DB3921F46D@mknod.org>

Author: m-a
Date: 2009-08-18 07:14:37 -0500 (Tue, 18 Aug 2009)
New Revision: 5420

Added:
   branches/BRANCH_6-3/t.validate-xhtml
Modified:
   branches/BRANCH_6-3/Makefile.am
Log:
Validate *.html documents as XHTML in 'make check'.

Modified: branches/BRANCH_6-3/Makefile.am
===================================================================
--- branches/BRANCH_6-3/Makefile.am	2009-08-18 11:38:51 UTC (rev 5419)
+++ branches/BRANCH_6-3/Makefile.am	2009-08-18 12:14:37 UTC (rev 5420)
@@ -46,8 +46,8 @@
 
 check_PROGRAMS=
 
-TESTS=			t.smoke
-TESTS_ENVIRONMENT=	srcdir="@srcdir@" LC_ALL=C TZ=UTC
+TESTS=			t.smoke t.validate-xhtml
+TESTS_ENVIRONMENT=	srcdir="$(srcdir)" LC_ALL=C TZ=UTC SHELL="$(SHELL)"
 
 if NEED_TRIO
 noinst_LIBRARIES+=	libtrio.a
@@ -175,7 +175,7 @@
 		m4/xsize.m4 \
 		m4-local/ac-archive-license.txt \
 		m4-local/ac_ma_search_package.m4 \
-		t.smoke t.rc \
+		$(TESTS) t.rc \
 		dist-tools/html2txt \
 		dist-tools/manServer.pl \
 		Doxyfile

Added: branches/BRANCH_6-3/t.validate-xhtml
===================================================================
--- branches/BRANCH_6-3/t.validate-xhtml	                        (rev 0)
+++ branches/BRANCH_6-3/t.validate-xhtml	2009-08-18 12:14:37 UTC (rev 5420)
@@ -0,0 +1,15 @@
+#! /bin/sh
+
+# This test script validates all *.html files as XHTML.
+
+set -e
+e=0
+fail=
+IFS=$(printf '\n\t')
+for i in "${srcdir}"/*.html ; do
+    xmllint --postvalid --noout "$i" || { e=1 ; fail="$i${fail:+" "}$fail" ; }
+done
+if [ $e != 0 ] ; then
+    echo >&2 ">>>>> Invalid XHTML in files: ${fail}."
+fi
+exit $e


Property changes on: branches/BRANCH_6-3/t.validate-xhtml
___________________________________________________________________
Added: svn:executable
   + *



From svn at mknod.org  Tue Aug 18 14:25:44 2009
From: svn at mknod.org (svn at mknod.org)
Date: Tue, 18 Aug 2009 07:25:44 -0500
Subject: [fetchmail-svn] r5421 - branches/BRANCH_6-3
Message-ID: <20090818122544.DDF6D21F46E@mknod.org>

Author: m-a
Date: 2009-08-18 07:25:44 -0500 (Tue, 18 Aug 2009)
New Revision: 5421

Modified:
   branches/BRANCH_6-3/t.validate-xhtml
Log:
Ignore fetchmail-man.html; it's not XHTML.

Modified: branches/BRANCH_6-3/t.validate-xhtml
===================================================================
--- branches/BRANCH_6-3/t.validate-xhtml	2009-08-18 12:14:37 UTC (rev 5420)
+++ branches/BRANCH_6-3/t.validate-xhtml	2009-08-18 12:25:44 UTC (rev 5421)
@@ -2,11 +2,12 @@
 
 # This test script validates all *.html files as XHTML.
 
-set -e
+set -eu
 e=0
 fail=
 IFS=$(printf '\n\t')
 for i in "${srcdir}"/*.html ; do
+    case "$i" in */fetchmail-man.html) continue ;; esac
     xmllint --postvalid --noout "$i" || { e=1 ; fail="$i${fail:+" "}$fail" ; }
 done
 if [ $e != 0 ] ; then



From svn at mknod.org  Wed Aug 19 18:35:52 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed, 19 Aug 2009 11:35:52 -0500
Subject: [fetchmail-svn] r5422 - branches/BRANCH_6-3
Message-ID: <20090819163552.2BF4021F48D@mknod.org>

Author: m-a
Date: 2009-08-19 11:35:51 -0500 (Wed, 19 Aug 2009)
New Revision: 5422

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/driver.c
Log:
Fix error reporting for GSSAPI on Heimdal krb5 (extra * in format string).

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-18 12:25:44 UTC (rev 5421)
+++ branches/BRANCH_6-3/NEWS	2009-08-19 16:35:51 UTC (rev 5422)
@@ -60,6 +60,9 @@
   This regression affected only the 6.3.11 release, but not the patch that was
   part of the security announcement fetchmail-SA-2009-01.
 
+# BUG FIXES
+* Fix error reporting for GSSAPI on Heimdal (h5l) Kerberos.
+
 # TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
 * [ca]    Catalan (Ernest Adrogu? Calveras)
 * [cs]    Czech (Petr Pisar)

Modified: branches/BRANCH_6-3/driver.c
===================================================================
--- branches/BRANCH_6-3/driver.c	2009-08-18 12:25:44 UTC (rev 5421)
+++ branches/BRANCH_6-3/driver.c	2009-08-19 16:35:51 UTC (rev 5422)
@@ -246,7 +246,7 @@
     if (retval) {
 #ifdef HEIMDAL
       if (err_ret && err_ret->e_text) {
-          report(stderr, GT_("krb5_sendauth: %s [server says '%*s'] \n"),
+          report(stderr, GT_("krb5_sendauth: %s [server says '%s'] \n"),
                  error_message(retval),
                  err_ret->e_text);
 #else



From svn at mknod.org  Wed Aug 19 18:36:01 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed, 19 Aug 2009 11:36:01 -0500
Subject: [fetchmail-svn] r5423 - branches/BRANCH_6-3
Message-ID: <20090819163601.BC00F21F48D@mknod.org>

Author: m-a
Date: 2009-08-19 11:36:00 -0500 (Wed, 19 Aug 2009)
New Revision: 5423

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/configure.ac
Log:
Look for MD5_Init in libcrypto (not libssl).

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-19 16:35:51 UTC (rev 5422)
+++ branches/BRANCH_6-3/NEWS	2009-08-19 16:36:00 UTC (rev 5423)
@@ -62,6 +62,9 @@
 
 # BUG FIXES
 * Fix error reporting for GSSAPI on Heimdal (h5l) Kerberos.
+* Look for MD5_Init in libcrypto rather than libssl, fixes Gentoo Kerberos
+  builds; fixes upstream parts of Gentoo Bugs #231400 and #185652, and fixes
+  BerliOS Bug #16134.
 
 # TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
 * [ca]    Catalan (Ernest Adrogu? Calveras)

Modified: branches/BRANCH_6-3/configure.ac
===================================================================
--- branches/BRANCH_6-3/configure.ac	2009-08-19 16:35:51 UTC (rev 5422)
+++ branches/BRANCH_6-3/configure.ac	2009-08-19 16:36:00 UTC (rev 5423)
@@ -573,7 +573,7 @@
            AC_CHECK_LIB(db2, db_open, ac_krblibs="$ac_krblibs -ldb2", [],
                 ${LDFLAGS})
            AC_CHECK_LIB(des, des_string_to_key, libk5crypto=-ldes,
-              AC_CHECK_LIB(ssl, MD5_Init, [],
+              AC_CHECK_LIB(crypto, MD5_Init, [],
                 AC_MSG_ERROR([DES libraries not found. Try adding --with-ssl to enable OpenSSL support]),
                 ${LDFLAGS} ${ac_krblibs}),
            ${LDFLAGS} ${ac_krblibs})



From svn at mknod.org  Thu Aug 20 02:21:29 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed, 19 Aug 2009 19:21:29 -0500
Subject: [fetchmail-svn] r5424 - branches/BRANCH_6-3
Message-ID: <20090820002129.36A5A21F499@mknod.org>

Author: m-a
Date: 2009-08-19 19:21:28 -0500 (Wed, 19 Aug 2009)
New Revision: 5424

Modified:
   branches/BRANCH_6-3/TODO.txt
Log:
Mark removal of blank-before-LF in logs as TODO.

Modified: branches/BRANCH_6-3/TODO.txt
===================================================================
--- branches/BRANCH_6-3/TODO.txt	2009-08-19 16:36:00 UTC (rev 5423)
+++ branches/BRANCH_6-3/TODO.txt	2009-08-20 00:21:28 UTC (rev 5424)
@@ -7,6 +7,8 @@
 - Debian Bug #531589: fetchmail ignores SIGUSR1 in idle mode.
 
 soon - SHOULD:
+- replace " \n" by "\n" (and similar) - but make sure translators have
+  time to catch up.
 - make sure the man page completely lists all options (f. i. sslcertpath) in
   the tables.
 - allow \Deleted without \Seen, rf. 



From svn at mknod.org  Thu Aug 20 02:21:37 2009
From: svn at mknod.org (svn at mknod.org)
Date: Wed, 19 Aug 2009 19:21:37 -0500
Subject: [fetchmail-svn] r5425 - branches/BRANCH_6-3
Message-ID: <20090820002137.EAC5021F499@mknod.org>

Author: m-a
Date: 2009-08-19 19:21:37 -0500 (Wed, 19 Aug 2009)
New Revision: 5425

Modified:
   branches/BRANCH_6-3/NEWS
   branches/BRANCH_6-3/TODO.txt
   branches/BRANCH_6-3/smtp.c
Log:
Fix SMTP_ok to cache multiline reponses...

but there are more functions that need fixing (look for smtp_response).

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-20 00:21:28 UTC (rev 5424)
+++ branches/BRANCH_6-3/NEWS	2009-08-20 00:21:37 UTC (rev 5425)
@@ -65,6 +65,9 @@
 * Look for MD5_Init in libcrypto rather than libssl, fixes Gentoo Kerberos
   builds; fixes upstream parts of Gentoo Bugs #231400 and #185652, and fixes
   BerliOS Bug #16134.
+* Report multiline SMTP errors properly, reported by Earl Chew; fixes Debian Bug
+  #569899, reported by Akihiro Terasaki.
+* Replace control characters in SMTP replies by '?'.
 
 # TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
 * [ca]    Catalan (Ernest Adrogu? Calveras)

Modified: branches/BRANCH_6-3/TODO.txt
===================================================================
--- branches/BRANCH_6-3/TODO.txt	2009-08-20 00:21:28 UTC (rev 5424)
+++ branches/BRANCH_6-3/TODO.txt	2009-08-20 00:21:37 UTC (rev 5425)
@@ -5,6 +5,9 @@
 - put bare IP addresses in brackets for SMTP (check if there are RFC
   1123/5321/5322 differences)
 - Debian Bug #531589: fetchmail ignores SIGUSR1 in idle mode.
+- Fix further occurrences of SMTP reply code handling:
+   - for proper smtp_reponse caching of multiline codes (there are some)
+   - for stomping over control characters.
 
 soon - SHOULD:
 - replace " \n" by "\n" (and similar) - but make sure translators have
@@ -28,10 +31,6 @@
 - find a solution for the "invalid header" discards message problem
   (escape headers and stuff reminder into body)
 - add Message-ID: header and other SHOULD headers to warning mails?
-- report multiline SMTP errors properly (sample in private mail from 
-  Earl Chew, 2007-07-30T02:28), Debian Bug #529899
-  => requires reworking SMTP_ok to actually not only read the last line 
-     of multiline replies, but buffer.
 
 soon - MAY:
 - http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=471176
@@ -44,7 +43,6 @@
 - revise ticker, and add something like .........20%.... ... 100%
   (suggested by Yue Wu)
 
-
 questionable:
 - Convert POP3 UIDs to X-UIDL?
 - fetch IMAP message in one go (fetchmail-devel by Adam Simpkins

Modified: branches/BRANCH_6-3/smtp.c
===================================================================
--- branches/BRANCH_6-3/smtp.c	2009-08-20 00:21:28 UTC (rev 5424)
+++ branches/BRANCH_6-3/smtp.c	2009-08-20 00:21:37 UTC (rev 5425)
@@ -4,13 +4,14 @@
  * Concept due to Harry Hochheiser.  Implementation by ESR.  Cleanup and
  * strict RFC821 compliance by Cameron MacPherson.
  *
- * Copyright 1997 Eric S. Raymond
+ * Copyright 1997 Eric S. Raymond, 2009 Matthias Andree
  * For license terms, see the file COPYING in this directory.
  */
 
 #include "config.h"
 #include "fetchmail.h"
 
+#include <ctype.h>
 #include <stdio.h>
 #include <unistd.h>
 #include <string.h>
@@ -80,10 +81,9 @@
 			report(stdout, GT_("ESMTP CRAM-MD5 Authentication...\n"));
 		SockPrintf(sock, "AUTH CRAM-MD5\r\n");
 		SockRead(sock, smtp_response, sizeof(smtp_response) - 1);
-		strncpy(tmp, smtp_response, sizeof(tmp));
-		tmp[sizeof(tmp)-1] = '\0';
+		strlcpy(tmp, smtp_response, sizeof(tmp));
 
-		if (strncmp(tmp, "334 ", 4)) { /* Server rejects AUTH */
+		if (strncmp(tmp, "334", 3)) { /* Server rejects AUTH */
 			SMTP_auth_error(sock, GT_("Server rejected the AUTH command.\n"));
 			return;
 		}
@@ -131,10 +131,9 @@
 			report(stdout, GT_("ESMTP LOGIN Authentication...\n"));
 		SockPrintf(sock, "AUTH LOGIN\r\n");
 		SockRead(sock, smtp_response, sizeof(smtp_response) - 1);
-		strncpy(tmp, smtp_response, sizeof(tmp));
-		tmp[sizeof(tmp)-1] = '\0';
+		strlcpy(tmp, smtp_response, sizeof(tmp));
 
-		if (strncmp(tmp, "334 ", 4)) { /* Server rejects AUTH */
+		if (strncmp(tmp, "334", 3)) { /* Server rejects AUTH */
 			SMTP_auth_error(sock, GT_("Server rejected the AUTH command.\n"));
 			return;
 		}
@@ -148,8 +147,7 @@
 		to64frombits(b64buf, username, strlen(username));
 		SockPrintf(sock, "%s\r\n", b64buf);
 		SockRead(sock, smtp_response, sizeof(smtp_response) - 1);
-		strncpy(tmp, smtp_response, sizeof(tmp));
-		tmp[sizeof(tmp)-1] = '\0';
+		strlcpy(tmp, smtp_response, sizeof(tmp));
 		p = strchr(tmp, ' ');
 		if (!p) {
 			SMTP_auth_error(sock, GT_("Bad base64 reply from server.\n"));
@@ -308,32 +306,44 @@
 time_t last_smtp_ok = 0;
 
 int SMTP_ok(int sock, char smtp_mode, int mintimeout)
-/* returns status of SMTP connection */
+/**< returns status of SMTP connection and saves the message in
+ * smtp_response, without trailing [CR]LF, but with normalized CRLF
+ * between multiple lines of multi-line replies */
 {
     SIGHANDLERTYPE alrmsave;
+    char reply[MSGBUFSIZE], *i;
 
     /* set an alarm for smtp ok */
     alrmsave = set_signal_handler(SIGALRM, null_signal_handler);
     set_timeout(mytimeout >= mintimeout ? mytimeout : mintimeout);
 
-    while ((SockRead(sock, smtp_response, sizeof(smtp_response)-1)) != -1)
+    smtp_response[0] = '\0';
+
+    while ((SockRead(sock, reply, sizeof(reply)-1)) != -1)
     {
-	int n;
+	size_t n;
 
 	/* restore alarm */
 	set_timeout(0);
 	set_signal_handler(SIGALRM, alrmsave);
 
-	n = strlen(smtp_response);
-	if (n > 0 && smtp_response[n-1] == '\n')
+	n = strlen(reply);
+	if (n > 0 && reply[n-1] == '\n')
 	    n--;
-	if (n > 0 && smtp_response[n-1] == '\r')
+	if (n > 0 && reply[n-1] == '\r')
 	    n--;
-	smtp_response[n] = '\0';
+	reply[n] = '\0';
+
+	/* stomp over control characters */
+	for (i = reply; *i; i++)
+	    if (iscntrl((unsigned char)*i))
+		*i = '?';
+
 	if (outlevel >= O_MONITOR)
-	    report(stdout, "%cMTP< %s\n", smtp_mode, smtp_response);
-	if (n < 4 ||
-	    (smtp_response[3] != ' ' && smtp_response[3] != '-'))
+	    report(stdout, "%cMTP< %s\n", smtp_mode, reply);
+	/* note that \0 is part of the strchr search string and the
+	 * blank after the reply code is optional (RFC 5321 4.2.1) */
+	if (n < 3 || !strchr(" -", reply[3]))
 	{
 	    if (outlevel >= O_MONITOR)
 		report(stderr, GT_("smtp listener protocol error\n"));
@@ -342,16 +352,21 @@
 
 	last_smtp_ok = time((time_t *) NULL);
 
-	if ((smtp_response[0] == '1' || smtp_response[0] == '2' || smtp_response[0] == '3') &&
-	    smtp_response[3] == ' ')
+	if (strchr("123", reply[0])
+		&& isdigit((unsigned char)reply[1])
+		&& isdigit((unsigned char)reply[2])
+		&& strchr(" ", reply[3])) /* matches space and \0 */ {
+	    strlcat(smtp_response, reply, sizeof(smtp_response));
 	    return SM_OK;
-	else if (smtp_response[3] != '-')
+	} else if (reply[3] != '-')
 	    return SM_ERROR;
 
+	strlcat(smtp_response, reply,  sizeof(smtp_response));
+	strlcat(smtp_response, "\r\n", sizeof(smtp_response));
+
 	/* set an alarm for smtp ok */
 	set_signal_handler(SIGALRM, null_signal_handler);
 	set_timeout(mytimeout);
-
     }
 
     /* restore alarm */



From svn at mknod.org  Mon Aug 24 21:03:46 2009
From: svn at mknod.org (svn at mknod.org)
Date: Mon, 24 Aug 2009 14:03:46 -0500
Subject: [fetchmail-svn] r5426 - branches/BRANCH_6-3
Message-ID: <20090824190347.626CF21F4FF@mknod.org>

Author: m-a
Date: 2009-08-24 14:03:43 -0500 (Mon, 24 Aug 2009)
New Revision: 5426

Modified:
   branches/BRANCH_6-3/README.SSL
Log:
Correct grammar, get rid of apostrophes.

Modified: branches/BRANCH_6-3/README.SSL
===================================================================
--- branches/BRANCH_6-3/README.SSL	2009-08-20 00:21:37 UTC (rev 5425)
+++ branches/BRANCH_6-3/README.SSL	2009-08-24 19:03:43 UTC (rev 5426)
@@ -43,7 +43,7 @@
 practically impossible.
 
 This works as following: the server has a key pair (a secret and a public key), 
-and it sends the client it's public key. Messages encrypted with the public key 
+and it sends the client its public key. Messages encrypted with the public key 
 can be decrypted using the private one and vice versa.
 
 A symmetric session key (symmetric means that the same key is used for 
@@ -56,8 +56,8 @@
 
 However, so called man-in-the-middle attacks are still possible: in such 
 a setting, an attacker pretends to be the server, and thus can e.g. get your 
-authentication information if you don't use a challenge based authentication 
-mechanism (because he is thought to be the real server, fetchmail will try to 
+authentication information if you do not use a challenge based authentication 
+mechanism (because it is thought to be the real server, fetchmail will try to 
 authenticate against it by telling it your password).
 
 So, not only you need to prove your identity to the server, the server likewise 
@@ -77,8 +77,8 @@
 certificates, and point fetchmail to it. Fetchmail will then accept 
 certificates signed by the owner of that certificate with the private key 
 belonging to the public key in the certificate.
-You can specify this path using the "sslcertpath" option if it's different from 
-the one OpenSSL uses by default.
+You can specify this path using the "sslcertpath" option if it is 
+different from the one OpenSSL uses by default.
 
 The idea is that the CA only gives certificates to entities whose identity it 
 has checked and verified (and in this case, that the server name you specify 
@@ -97,7 +97,7 @@
 The certificate directory must be hashed in a way OpenSSL expects it: each time 
 you modify a file in that directory or add a file to it, you need to use the 
 "c_rehash" perl script that comes with OpenSSL (in the tools/ subdirectory, in 
-case that it isn't installed). Additionally, you might need to convert the 
+case that it is not installed). Additionally, you might need to convert the 
 certificates to different formats (the PEM format is expected and usually is 
 available, DER is another one; you can convert between both using the 
 openssl(1) utility's x509 sub-mode).
@@ -109,7 +109,7 @@
 the original key in reasonable time. So, if the fingerprint matches, you can be 
 reasonable sure that you talk to the original server, because only that knows 
 the secret key, and it is very hard to generate a matching secret key from the 
-public key. If it doesn't, it might be an attack, but keep in mind that the 
+public key. If it does not, it might be an attack, but keep in mind that the 
 server key may also have changed legitimately before panicking ;)
 
 Fetchmail will present the fingerprint to you in verbose mode. You can have 



From svn at mknod.org  Thu Aug 27 19:40:12 2009
From: svn at mknod.org (svn at mknod.org)
Date: Thu, 27 Aug 2009 12:40:12 -0500
Subject: [fetchmail-svn] r5428 - branches/BRANCH_6-3
Message-ID: <20090827174013.2D5E821F524@mknod.org>

Author: m-a
Date: 2009-08-27 12:40:10 -0500 (Thu, 27 Aug 2009)
New Revision: 5428

Modified:
   branches/BRANCH_6-3/NEWS
Log:
Document 6.3.11 free() bug workaround.

Modified: branches/BRANCH_6-3/NEWS
===================================================================
--- branches/BRANCH_6-3/NEWS	2009-08-24 19:16:15 UTC (rev 5427)
+++ branches/BRANCH_6-3/NEWS	2009-08-27 17:40:10 UTC (rev 5428)
@@ -56,6 +56,7 @@
   unallocated memory on SSL connections, which caused crashes or program aborts
   on some systems (depending on how initialization and free() of unallocated
   memory is handled in compiler and libc).
+  Workaround for older versions: run in verbose mode.
   Patch courtesy of Thomas Heinz, fixes Gentoo Bug #280760.
   This regression affected only the 6.3.11 release, but not the patch that was
   part of the security announcement fetchmail-SA-2009-01.
@@ -100,6 +101,8 @@
 * Convert all non-printable characters in certificate Subject/Issuer
   Common Name or Subject Alternative Name fields to ANSI-C hex escapes (\xnn,
   where nn are hex digits).
+  Note that this change introduces a regression, fixed in 6.3.12.
+  See the 6.3.12 documentation above for details and a workaround.
 
 # TRANSLATION UPDATES AND ADDITIONS (ordered by language name):
 * [zh_CN] Chinese/Simplified (Ji ZhengYu)



From svn at mknod.org  Thu Aug 27 19:40:23 2009
From: svn at mknod.org (svn at mknod.org)
Date: Thu, 27 Aug 2009 12:40:23 -0500
Subject: [fetchmail-svn] r5429 - branches/BRANCH_6-3
Message-ID: <20090827174023.7F8F821F524@mknod.org>

Author: m-a
Date: 2009-08-27 12:40:23 -0500 (Thu, 27 Aug 2009)
New Revision: 5429

Modified:
   branches/BRANCH_6-3/TODO.txt
Log:
Update: verbose documentation, HOWTO.

Modified: branches/BRANCH_6-3/TODO.txt
===================================================================
--- branches/BRANCH_6-3/TODO.txt	2009-08-27 17:40:10 UTC (rev 5428)
+++ branches/BRANCH_6-3/TODO.txt	2009-08-27 17:40:23 UTC (rev 5429)
@@ -150,7 +150,11 @@
   This probably entails some form of extended user mapping inside 
   fetchmail, for map_name() in transact.c, and possibly 
   find_server_names() ibidem.
+- more verbose diagnostics, what, why, how, ... (what does fetchmail do, what
+  does it expect, what does it get instead, what does that mean, how can the
+  user fix it; references to the manual)
 
 DOCUMENTATION:
 - Add info whether Keywords are global, server or user keywords
 - consolidate multidrop documentation
+- HOWTO (on configuration, and on SSL in particular)



